var app=function(){"use strict";function e(){}const t=e=>e;function s(e,t){for(const s in t)e[s]=t[s];return e}function n(e){return e()}function r(){return Object.create(null)}function a(e){e.forEach(n)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,...s){if(null==t)return e;const n=t.subscribe(...s);return n.unsubscribe?()=>n.unsubscribe():n}function u(e,t,s){e.$$.on_destroy.push(c(t,s))}function l(e,t,s,n){if(e){const r=d(e,t,s,n);return e[0](r)}}function d(e,t,n,r){return e[1]&&r?s(n.ctx.slice(),e[1](r(t))):n.ctx}function h(e,t,s,n,r,a,i){const o=function(e,t,s,n){if(e[2]&&n){const r=e[2](n(s));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],s=Math.max(t.dirty.length,r.length);for(let n=0;n<s;n+=1)e[n]=t.dirty[n]|r[n];return e}return t.dirty|r}return t.dirty}(t,n,r,a);if(o){const r=d(t,s,n,i);e.p(r,o)}}function f(e,t){const s={};t=new Set(t);for(const n in e)t.has(n)||"$"===n[0]||(s[n]=e[n]);return s}function p(e,t,s=t){return e.set(s),t}const m="undefined"!=typeof window;let w=m?()=>window.performance.now():()=>Date.now(),g=m?e=>requestAnimationFrame(e):e;const y=new Set;function b(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&g(b)}function v(e,t){e.appendChild(t)}function M(e,t,s){e.insertBefore(t,s||null)}function S(e){e.parentNode.removeChild(e)}function I(e){return document.createElement(e)}function E(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function A(e){return document.createTextNode(e)}function B(){return A(" ")}function k(){return A("")}function P(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function x(e){return function(t){return t.preventDefault(),e.call(this,t)}}function U(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function N(e,t){const s=Object.getOwnPropertyDescriptors(e.__proto__);for(const n in t)null==t[n]?e.removeAttribute(n):"style"===n?e.style.cssText=t[n]:"__value"===n?e.value=e[n]=t[n]:s[n]&&s[n].set?e[n]=t[n]:U(e,n,t[n])}function T(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function D(e,t){e.value=null==t?"":t}function K(e,t,s,n){e.style.setProperty(t,s,n?"important":"")}function O(e,t){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}const R=new Set;let C,F=0;function L(e,t){const s=(e.style.animation||"").split(", "),n=s.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=s.length-n.length;r&&(e.style.animation=n.join(", "),F-=r,F||g((()=>{F||(R.forEach((e=>{const t=e.__svelte_stylesheet;let s=t.cssRules.length;for(;s--;)t.deleteRule(s);e.__svelte_rules={}})),R.clear())})))}function q(e){C=e}function j(){if(!C)throw new Error("Function called outside component initialization");return C}function V(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach((e=>e(t)))}const _=[],H=[],$=[],G=[],J=Promise.resolve();let z=!1;function W(){z||(z=!0,J.then(te))}function Q(){return W(),J}function Z(e){$.push(e)}function Y(e){G.push(e)}let X=!1;const ee=new Set;function te(){if(!X){X=!0;do{for(let e=0;e<_.length;e+=1){const t=_[e];q(t),se(t.$$)}for(q(null),_.length=0;H.length;)H.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];ee.has(t)||(ee.add(t),t())}$.length=0}while(_.length);for(;G.length;)G.pop()();z=!1,X=!1,ee.clear()}}function se(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Z)}}let ne;function re(e,t,s){e.dispatchEvent(O(`${t?"intro":"outro"}${s}`))}const ae=new Set;let ie;function oe(){ie={r:0,c:[],p:ie}}function ce(){ie.r||a(ie.c),ie=ie.p}function ue(e,t){e&&e.i&&(ae.delete(e),e.i(t))}function le(e,t,s,n){if(e&&e.o){if(ae.has(e))return;ae.add(e),ie.c.push((()=>{ae.delete(e),n&&(s&&e.d(1),n())})),e.o(t)}}const de={duration:0};function he(s,n,r){let a,o,c=n(s,r),u=!1,l=0;function d(){a&&L(s,a)}function h(){const{delay:n=0,duration:r=300,easing:i=t,tick:h=e,css:f}=c||de;f&&(a=function(e,t,s,n,r,a,i,o=0){const c=16.666/n;let u="{\n";for(let e=0;e<=1;e+=c){const n=t+(s-t)*a(e);u+=100*e+`%{${i(n,1-n)}}\n`}const l=u+`100% {${i(s,1-s)}}\n}`,d=`__svelte_${function(e){let t=5381,s=e.length;for(;s--;)t=(t<<5)-t^e.charCodeAt(s);return t>>>0}(l)}_${o}`,h=e.ownerDocument;R.add(h);const f=h.__svelte_stylesheet||(h.__svelte_stylesheet=h.head.appendChild(I("style")).sheet),p=h.__svelte_rules||(h.__svelte_rules={});p[d]||(p[d]=!0,f.insertRule(`@keyframes ${d} ${l}`,f.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${d} ${n}ms linear ${r}ms 1 both`,F+=1,d}(s,0,1,r,n,i,f,l++)),h(0,1);const p=w()+n,m=p+r;o&&o.abort(),u=!0,Z((()=>re(s,!0,"start"))),o=function(e){let t;return 0===y.size&&g(b),{promise:new Promise((s=>{y.add(t={c:e,f:s})})),abort(){y.delete(t)}}}((e=>{if(u){if(e>=m)return h(1,0),re(s,!0,"end"),d(),u=!1;if(e>=p){const t=i((e-p)/r);h(t,1-t)}}return u}))}let f=!1;return{start(){f||(L(s),i(c)?(c=c(),(ne||(ne=Promise.resolve(),ne.then((()=>{ne=null}))),ne).then(h)):h())},invalidate(){f=!1},end(){u&&(d(),u=!1)}}}function fe(e,t){const s={},n={},r={$$scope:1};let a=e.length;for(;a--;){const i=e[a],o=t[a];if(o){for(const e in i)e in o||(n[e]=1);for(const e in o)r[e]||(s[e]=o[e],r[e]=1);e[a]=o}else for(const e in i)r[e]=1}for(const e in n)e in s||(s[e]=void 0);return s}function pe(e){return"object"==typeof e&&null!==e?e:{}}function me(e,t,s){const n=e.$$.props[t];void 0!==n&&(e.$$.bound[n]=s,s(e.$$.ctx[n]))}function we(e){e&&e.c()}function ge(e,t,s,r){const{fragment:o,on_mount:c,on_destroy:u,after_update:l}=e.$$;o&&o.m(t,s),r||Z((()=>{const t=c.map(n).filter(i);u?u.push(...t):a(t),e.$$.on_mount=[]})),l.forEach(Z)}function ye(e,t){const s=e.$$;null!==s.fragment&&(a(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function be(t,s,n,i,o,c,u=[-1]){const l=C;q(t);const d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:o,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:r(),dirty:u,skip_bound:!1};let h=!1;if(d.ctx=n?n(t,s.props||{},((e,s,...n)=>{const r=n.length?n[0]:s;return d.ctx&&o(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),h&&function(e,t){-1===e.$$.dirty[0]&&(_.push(e),W(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),s})):[],d.update(),h=!0,a(d.before_update),d.fragment=!!i&&i(d.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);d.fragment&&d.fragment.l(e),e.forEach(S)}else d.fragment&&d.fragment.c();s.intro&&ue(t.$$.fragment),ge(t,s.target,s.anchor,s.customElement),te()}q(l)}class ve{$destroy(){ye(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Me extends ve{constructor(e){super(),be(this,e,null,null,o,{})}}function Se(e){if(!e)throw Error("Parameter args is required");if(!e.component==!e.asyncComponent)throw Error("One and only one of component and asyncComponent is required");if(e.component&&(e.asyncComponent=()=>Promise.resolve(e.component)),"function"!=typeof e.asyncComponent)throw Error("Parameter asyncComponent must be a function");if(e.conditions){Array.isArray(e.conditions)||(e.conditions=[e.conditions]);for(let t=0;t<e.conditions.length;t++)if(!e.conditions[t]||"function"!=typeof e.conditions[t])throw Error("Invalid parameter conditions["+t+"]")}e.loadingComponent&&(e.asyncComponent.loading=e.loadingComponent,e.asyncComponent.loadingParams=e.loadingParams||void 0);return{component:e.asyncComponent,userData:e.userData,conditions:e.conditions&&e.conditions.length?e.conditions:void 0,props:e.props&&Object.keys(e.props).length?e.props:{},_sveltesparouter:!0}}const Ie=[];function Ee(e,t){return{subscribe:Ae(e,t).subscribe}}function Ae(t,s=e){let n;const r=[];function a(e){if(o(t,e)&&(t=e,n)){const e=!Ie.length;for(let e=0;e<r.length;e+=1){const s=r[e];s[1](),Ie.push(s,t)}if(e){for(let e=0;e<Ie.length;e+=2)Ie[e][0](Ie[e+1]);Ie.length=0}}}return{set:a,update:function(e){a(e(t))},subscribe:function(i,o=e){const c=[i,o];return r.push(c),1===r.length&&(n=s(a)||e),i(t),()=>{const e=r.indexOf(c);-1!==e&&r.splice(e,1),0===r.length&&(n(),n=null)}}}}function Be(t,s,n){const r=!Array.isArray(t),o=r?[t]:t,u=s.length<2;return Ee(n,(t=>{let n=!1;const l=[];let d=0,h=e;const f=()=>{if(d)return;h();const n=s(r?l[0]:l,t);u?t(n):h=i(n)?n:e},p=o.map(((e,t)=>c(e,(e=>{l[t]=e,d&=~(1<<t),n&&f()}),(()=>{d|=1<<t}))));return n=!0,f(),function(){a(p),h()}}))}function ke(e){let t,n,r;const a=[e[2]];var i=e[0];function o(e){let t={};for(let e=0;e<a.length;e+=1)t=s(t,a[e]);return{props:t}}return i&&(t=new i(o()),t.$on("routeEvent",e[7])),{c(){t&&we(t.$$.fragment),n=k()},m(e,s){t&&ge(t,e,s),M(e,n,s),r=!0},p(e,s){const r=4&s?fe(a,[pe(e[2])]):{};if(i!==(i=e[0])){if(t){oe();const e=t;le(e.$$.fragment,1,0,(()=>{ye(e,1)})),ce()}i?(t=new i(o()),t.$on("routeEvent",e[7]),we(t.$$.fragment),ue(t.$$.fragment,1),ge(t,n.parentNode,n)):t=null}else i&&t.$set(r)},i(e){r||(t&&ue(t.$$.fragment,e),r=!0)},o(e){t&&le(t.$$.fragment,e),r=!1},d(e){e&&S(n),t&&ye(t,e)}}}function Pe(e){let t,n,r;const a=[{params:e[1]},e[2]];var i=e[0];function o(e){let t={};for(let e=0;e<a.length;e+=1)t=s(t,a[e]);return{props:t}}return i&&(t=new i(o()),t.$on("routeEvent",e[6])),{c(){t&&we(t.$$.fragment),n=k()},m(e,s){t&&ge(t,e,s),M(e,n,s),r=!0},p(e,s){const r=6&s?fe(a,[2&s&&{params:e[1]},4&s&&pe(e[2])]):{};if(i!==(i=e[0])){if(t){oe();const e=t;le(e.$$.fragment,1,0,(()=>{ye(e,1)})),ce()}i?(t=new i(o()),t.$on("routeEvent",e[6]),we(t.$$.fragment),ue(t.$$.fragment,1),ge(t,n.parentNode,n)):t=null}else i&&t.$set(r)},i(e){r||(t&&ue(t.$$.fragment,e),r=!0)},o(e){t&&le(t.$$.fragment,e),r=!1},d(e){e&&S(n),t&&ye(t,e)}}}function xe(e){let t,s,n,r;const a=[Pe,ke],i=[];function o(e,t){return e[1]?0:1}return t=o(e),s=i[t]=a[t](e),{c(){s.c(),n=k()},m(e,s){i[t].m(e,s),M(e,n,s),r=!0},p(e,[r]){let c=t;t=o(e),t===c?i[t].p(e,r):(oe(),le(i[c],1,1,(()=>{i[c]=null})),ce(),s=i[t],s?s.p(e,r):(s=i[t]=a[t](e),s.c()),ue(s,1),s.m(n.parentNode,n))},i(e){r||(ue(s),r=!0)},o(e){le(s),r=!1},d(e){i[t].d(e),e&&S(n)}}}function Ue(){const e=window.location.href.indexOf("#/");let t=e>-1?window.location.href.substr(e+1):"/";const s=t.indexOf("?");let n="";return s>-1&&(n=t.substr(s+1),t=t.substr(0,s)),{location:t,querystring:n}}const Ne=Ee(null,(function(e){e(Ue());const t=()=>{e(Ue())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}));async function Te(e){if(!e||e.length<1||"/"!=e.charAt(0)&&0!==e.indexOf("#/"))throw Error("Invalid parameter location");await Q();const t=("#"==e.charAt(0)?"":"#")+e;try{window.history.replaceState(void 0,void 0,t)}catch(e){console.warn("Caught exception while replacing the current page. If you're running this in the Svelte REPL, please note that the `replace` method might not work in this environment.")}window.dispatchEvent(new Event("hashchange"))}function De(e,t){if(!e||!e.tagName||"a"!=e.tagName.toLowerCase())throw Error('Action "link" can only be used with <a> tags');return Ke(e,t||e.getAttribute("href")),{update(t){Ke(e,t)}}}function Ke(e,t){if(!t||t.length<1||"/"!=t.charAt(0))throw Error('Invalid value for "href" attribute: '+t);e.setAttribute("href","#"+t),e.addEventListener("click",Oe)}function Oe(e){e.preventDefault();const t=e.currentTarget.getAttribute("href");history.replaceState({scrollX:window.scrollX,scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function Re(e,t,s){let{routes:n={}}=t,{prefix:r=""}=t,{restoreScrollState:a=!1}=t;class i{constructor(e,t){if(!t||"function"!=typeof t&&("object"!=typeof t||!0!==t._sveltesparouter))throw Error("Invalid component object");if(!e||"string"==typeof e&&(e.length<1||"/"!=e.charAt(0)&&"*"!=e.charAt(0))||"object"==typeof e&&!(e instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:s,keys:n}=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var s,n,r,a,i=[],o="",c=e.split("/");for(c[0]||c.shift();r=c.shift();)"*"===(s=r[0])?(i.push("wild"),o+="/(.*)"):":"===s?(n=r.indexOf("?",1),a=r.indexOf(".",1),i.push(r.substring(1,~n?n:~a?a:r.length)),o+=~n&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(o+=(~n?"?":"")+"\\"+r.substring(a))):o+="/"+r;return{keys:i,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}(e);this.path=e,"object"==typeof t&&!0===t._sveltesparouter?(this.component=t.component,this.conditions=t.conditions||[],this.userData=t.userData,this.props=t.props||{}):(this.component=()=>Promise.resolve(t),this.conditions=[],this.props={}),this._pattern=s,this._keys=n}match(e){if(r)if("string"==typeof r){if(!e.startsWith(r))return null;e=e.substr(r.length)||"/"}else if(r instanceof RegExp){const t=e.match(r);if(!t||!t[0])return null;e=e.substr(t[0].length)||"/"}const t=this._pattern.exec(e);if(null===t)return null;if(!1===this._keys)return t;const s={};let n=0;for(;n<this._keys.length;){try{s[this._keys[n]]=decodeURIComponent(t[n+1]||"")||null}catch(e){s[this._keys[n]]=null}n++}return s}async checkConditions(e){for(let t=0;t<this.conditions.length;t++)if(!await this.conditions[t](e))return!1;return!0}}const o=[];n instanceof Map?n.forEach(((e,t)=>{o.push(new i(t,e))})):Object.keys(n).forEach((e=>{o.push(new i(e,n[e]))}));let c=null,u=null,l={};const d=function(){const e=j();return(t,s)=>{const n=e.$$.callbacks[t];if(n){const r=O(t,s);n.slice().forEach((t=>{t.call(e,r)}))}}}();async function h(e,t){await Q(),d(e,t)}let f=null;var p;a&&(window.addEventListener("popstate",(e=>{f=e.state&&e.state.scrollY?e.state:null})),p=()=>{f?window.scrollTo(f.scrollX,f.scrollY):window.scrollTo(0,0)},j().$$.after_update.push(p));let m=null,w=null;return Ne.subscribe((async e=>{m=e;let t=0;for(;t<o.length;){const n=o[t].match(e.location);if(!n){t++;continue}const r={route:o[t].path,location:e.location,querystring:e.querystring,userData:o[t].userData};if(!await o[t].checkConditions(r))return s(0,c=null),w=null,void h("conditionsFailed",r);h("routeLoading",Object.assign({},r));const a=o[t].component;if(w!=a){a.loading?(s(0,c=a.loading),w=a,s(1,u=a.loadingParams),s(2,l={}),h("routeLoaded",Object.assign({},r,{component:c,name:c.name}))):(s(0,c=null),w=null);const t=await a();if(e!=m)return;s(0,c=t&&t.default||t),w=a}return n&&"object"==typeof n&&Object.keys(n).length?s(1,u=n):s(1,u=null),s(2,l=o[t].props),void h("routeLoaded",Object.assign({},r,{component:c,name:c.name}))}s(0,c=null),w=null})),e.$$set=e=>{"routes"in e&&s(3,n=e.routes),"prefix"in e&&s(4,r=e.prefix),"restoreScrollState"in e&&s(5,a=e.restoreScrollState)},e.$$.update=()=>{32&e.$$.dirty&&(history.scrollRestoration=a?"manual":"auto")},[c,u,l,n,r,a,function(t){V(e,t)},function(t){V(e,t)}]}Be(Ne,(e=>e.location)),Be(Ne,(e=>e.querystring));class Ce extends ve{constructor(e){super(),be(this,e,Re,xe,o,{routes:3,prefix:4,restoreScrollState:5})}}function Fe(e){let t,s,n,r;const a=e[1].default,i=l(a,e,e[0],null);return{c(){t=I("button"),i&&i.c(),U(t,"class","text-white bg-blue-500 border-0 py-2 px-8 focus:outline-none hover:bg-blue-600 rounded text-lg")},m(a,o){M(a,t,o),i&&i.m(t,null),s=!0,n||(r=P(t,"click",e[2]),n=!0)},p(e,[t]){i&&i.p&&1&t&&h(i,a,e,e[0],t,null,null)},i(e){s||(ue(i,e),s=!0)},o(e){le(i,e),s=!1},d(e){e&&S(t),i&&i.d(e),n=!1,r()}}}function Le(e,t,s){let{$$slots:n={},$$scope:r}=t;return e.$$set=e=>{"$$scope"in e&&s(0,r=e.$$scope)},[r,n,function(t){V(e,t)}]}class qe extends ve{constructor(e){super(),be(this,e,Le,Fe,o,{})}}function je(t){let n,r,a,i,o,c,u,l=[{id:t[1]},{name:t[1]},t[2],{class:"w-full bg-white rounded border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"}],d={};for(let e=0;e<l.length;e+=1)d=s(d,l[e]);return{c(){n=I("div"),r=I("label"),a=A(t[1]),i=B(),o=I("input"),U(r,"for",t[1]),U(r,"class","leading-7 text-sm text-gray-600"),N(o,d),U(n,"class","relative mb-4")},m(e,s){M(e,n,s),v(n,r),v(r,a),v(n,i),v(n,o),D(o,t[0]),c||(u=P(o,"input",t[3]),c=!0)},p(e,[t]){2&t&&T(a,e[1]),2&t&&U(r,"for",e[1]),N(o,d=fe(l,[2&t&&{id:e[1]},2&t&&{name:e[1]},4&t&&e[2],{class:"w-full bg-white rounded border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"}])),1&t&&o.value!==e[0]&&D(o,e[0])},i:e,o:e,d(e){e&&S(n),c=!1,u()}}}function Ve(e,t,n){const r=["label","value"];let a=f(t,r),{label:i=""}=t,{value:o=null}=t;return e.$$set=e=>{t=s(s({},t),function(e){const t={};for(const s in e)"$"!==s[0]&&(t[s]=e[s]);return t}(e)),n(2,a=f(t,r)),"label"in e&&n(1,i=e.label),"value"in e&&n(0,o=e.value)},[o,i,a,function(){o=this.value,n(0,o)}]}class _e extends ve{constructor(e){super(),be(this,e,Ve,je,o,{label:1,value:0})}}function He(t){let s,n,r,a;const o=t[2].default,c=l(o,t,t[1],null);return{c(){s=I("a"),c&&c.c(),U(s,"href",t[0]),U(s,"class","text-gray-600 hover:text-gray-800")},m(t,o){var u;M(t,s,o),c&&c.m(s,null),n=!0,r||(u=De.call(null,s,!1),a=u&&i(u.destroy)?u.destroy:e,r=!0)},p(e,[t]){c&&c.p&&2&t&&h(c,o,e,e[1],t,null,null),(!n||1&t)&&U(s,"href",e[0])},i(e){n||(ue(c,e),n=!0)},o(e){le(c,e),n=!1},d(e){e&&S(s),c&&c.d(e),r=!1,a()}}}function $e(e,t,s){let{$$slots:n={},$$scope:r}=t,{href:a="#"}=t;return e.$$set=e=>{"href"in e&&s(0,a=e.href),"$$scope"in e&&s(1,r=e.$$scope)},[a,r,n]}class Ge extends ve{constructor(e){super(),be(this,e,$e,He,o,{href:0})}}function Je(e,{delay:s=0,duration:n=400,easing:r=t}={}){const a=+getComputedStyle(e).opacity;return{delay:s,duration:n,easing:r,css:e=>"opacity: "+e*a}}const ze=Ae(null),We=Ae(null),Qe=Ee({PLACEHOLDER_IMAGE_SRC:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxISEhUSEhMVFhAVGBUYFxUVExUWFRcVFRgWFhgXFxcZHiggGBolHRUVITEhJSkrLi4uFx8zODMtNygtLisBCgoKDg0OGxAQGy0lHx8tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTctNzctLf/AABEIAMIBAwMBIgACEQEDEQH/xAAcAAACAgMBAQAAAAAAAAAAAAAABgUHAQMEAgj/xABJEAACAQICBQgHBgMGBQQDAAABAgADEQQhBQYSMVEHEyJBYXGBkRQyUpKhsdEjQlNygsEzYrI0c6KzwvBDo8PT4RVjg+IWJHT/xAAaAQADAQEBAQAAAAAAAAAAAAAAAgMBBAUG/8QAKREAAgIBBAICAQQDAQAAAAAAAAECEQMEEiExE0EiUQUUMmFxUoGRI//aAAwDAQACEQMRAD8ASPRKfsJ7omfRafsJ7om2EQ47Zp9Ep/hp7oh6JT9hPdE3wmBbNaYamP8Ahp7i/SdqYOiRfm09xfpOcCdeG3TJG2zz6BS/DT3F+kBgaX4ae4v0nRMxLZts5/QKX4Se4v0h6BS/Cp+4v0nRMzLZlsVtIYNUqMAq2OY6I3H/AGZzpTUEHZXLioI8ZOado3VXHVke47vj85Czpg7RRPgYMLQouoYU07RsLkeG6bfQaX4ae4v0kJo/Fmm38h3j94xhr90jNOLFdo5/QaX4Se4v0murgaWX2aZn2F7+E7JqXNieoZeJ3/tFTZibOPE4Onf+GnuL9Jp9Dp/hp7oklWUETklEzLZpXDINyUyODU1PxnujQUsBzVK2ZPQH0nqbcL6/6f3gzVJmz0Cl+EnuL9Jx6TpUkTKmm02Q6C+J3SUi7pLEbbn2RkP3MWFtmxtnDzK+yvkJMaEwNMqzFENzYXUHcP8AzIqMmjKdqS8SL+ecrkdIZt0evQaX4VP3F+kPQKX4VP3F+k6LQkLZO2aBgaX4VP3F+kPQKX4VP3F+k6ITLYWznOApfhp7i/SY9Apfhp7i/SdJmDNthbOf0Gl+GnuL9IegUvwk9xfpOgCZtMthbOX0Gl+GnuL9JmdNoQthuZFQEzaabnauMwMj88pUw3XnoTS1UH1czw+vCbqS2sOFoAelW+6dlNbCYpoBumyJJgEITZh6e0yre1yBfvigeJ0UMFUcXVSRxnbpfRi0lDKTa9iDx7JIaBxic3sEgML5E2vne8lLJ8bibQaq6vLXFRqy3o5oUzBY5E57wBlJrHai6PqC3Mc2fapsykeBJB8RJzAUgtNQOsXPe2c6J3YlUV/JzTySUuGU/rJyfYjDg1KP29EcBaqo7V+8O0eUV6GkKirsgiw4i5HZPoi8TNdNSExINbDgJid5G5Kvfwbt6+vjHcUyuPPfEip3xlQ73bwNvlOvR+hMXiFL0aNWog3soNvC+8915Kam6sticbzFZWVaV2qqRZrKQNjsuSBfheXtRpKihEUKiiwUCwAHUBFpI7sePcrZ81V8NVQ2dKingysp+Inhmdd+0L7r3F+68+kcZUYdJaiC29algp/VvU9ufdILWNKGNweIRtnbpIzghgwR1DFWV1yI6J7bbwIcD+Ao5cW4679830dIkEEjy4HfO7U/QAxtbZdxTooNqo5IFhuCi+VyfkY/aT5PMFWAGEqNTqAb7PUpNb2mOQPcfCDSJRxOSsQMZpJObOwekcrdY7ZCRyxXJlpBb2WlUA9mpYnwYDOJ9akyMVYFWUkMrZEEZEGZGKQrg4owq3NuOXnlHvQGj1rVkpM2ypvmN+QJAF+s2ibo6neqgI7c+AzjKDbMZRMj5ROXRKayaLXDVubViVKhhe20L3Fjbu+Mi5KYHQeJr9JUax+++Q8zv8LxjwOpCDOtULH2UFh7xzPkImxyfCJOSXYkQvLVwmhsPT9Skl+JG0fNrzreihGyVUqd4Ki3lGWFk/Min5id2maC069VE9RXYDsAO6cREk+CxgTMLQgBmYhCYBEFGO8jwGc9qlhbqnue6aXMuBKataDbF1dkZU1zduA4DtPVLU0fo+lQQJSRVA7BtHtJ3kyF1DwPN4Xa+9VYt+kdFfkT4xjlYrg5ssndGmvg6biz00YfzIpkNjdUMM/qhqbfym6+637ESfhNcUxFOSK80jqhiKedO1Vf5cm90/teQVRGU2YFWHUQQR4GXBNOLwlOqLVEVx/ML27jvEk8S9FVm+yqcRjHcAM1wN0k9WNDNiKgLD7FTdj1G2eyON+vsjkNWMJe/M+G29vK8lkQKAqgBRuAFgO4CZDDXZssyrgzCEJc5whCcGmdI8xT29naJOyBew3E3PlNSsaMXJ0jbUw4WqMQiA1NnYe2TPTve1+sg5i/aOuSeHxKOLowPEdYPAjeD2GVzpHT+KqCyVRSP8iKfPbBPxisvpleqRiK7sqdatYm+4ArYgW6oPGz1cCyY1tlyi2tIaQwVBjt83zvWFph6lz1kKCR3mKmumtTVcO2HwlF/tAVd22FAQ7wo2r3O6QyIALAWEmNBaAqYraKMqhLAlr5k3yFu6P4klbOlyIDk0NOliWpYlNhqoXmnPRIqLfJXG4kHjna0t6hTqKbM+2vUStn8bZHyEQ9N6rVaFPbqGmyXAsCb3O7IicL664vCKCVWvRGXTJFReHTHrDvF+2JKHtGRaSLQi1X0Bhmx1Su1JWqbFL1hcB71AW2d21shMzwES6/K1WIsmGpq3UTUZh5WF/ON+pulhiqBq7DrU2yKm3mWeynaBsLi1huFrWiJHPqsn/nwadc9XXxooim6U2puSXYEkKVtZQN+fVcbp06J1ZoUACRzlQb3e2/iF3CTUJrSZ5fklVBCEJogTTjMSKVN6jbkUt5dXnabpyaWwPP0XpbWztWzte1iG3eEDY98lVVqhZix9ZiSe8m5nlQTkBc8BH3Cal0F/iM7nhkg+Gfxk7g8DSoj7KmqdoHS8WOZnOsTfZ0PLFFd4LVvFVd1MqONToDyOZ8pL0dRm+/WUHgqFviSI6wlFiiTeZ+hNOov/v/APL/APtCOUJvjiHlkUkuH7Z2YHBNVuENlG97X6XUo4njwER62lqzixc27AB8pZPJ5h9vDUl9p3ue9zf4RseG38jt21yWTgMPzdKnT9hFXxAF/jeb5ljMTTzpO3YQhCBgQhFfWPTVRahpUzshbXYesSQDkeoZ9UaMbKYsTySpDO5tvyHabTUcXT/ET31+sripULEXJZichmzE8AN5MntHan4mrm4FFOL5tb8gPzIjOKXbO1aKPtjYtVTuZT3MDNlpF6H1Lw5ppUqmo7Mqtba2FG0L5BLHr6yYxYHRFCj/AA6YU8bknzJMm5IWWjXpnBIvWfZ9Hfa39HZ/NcbvC8buaXgPKQGmdXKFapTB2wzFyStRvVVTuDEqOkydUIzSYY9Ntkm30VtNOEHRB626R7znHDSeo9VM6LiqPZayP4H1WPuxSpU2QbDqVdCVKsLEEcR3WPjOiM1Lo9C0e5YGolWkmHsXQOzsSCwBFrAZeHxlfwtCUdyoxqx85QsUOapoCDtOWyIOSi3+qV/iKQdWU7mBHnNkw7WBPUM4RjtVAkcmAwdNFBVACQDfed3Eyy9A4cJQpjrI2j3tn8reUr2gtlUdYAHwjHovWU00COm0FFgQbG3UCDMlHjghqccpwqI3QtFbE62G32dMA8WN/gLSHxelq1T1qjW4DojyERY2ccNHN98FgwnPo+/NU779hL+6J0RGcslTaCEITDAhCEACEIQAIQ8QO8iEDaZ886743CV8TzmDplKRRdobAQGpc3IUbstnylkclOH/AP16bHcoqHxZ2A+ZPhKeEvrk4wpTR9EkWLja/Tc7PzJ8Y6lwzvyy2wGWEIRDzwhCEACQeltW3xNZWplVDC1Rjns7O4hfvE7rdknJsoVNlgZqbXRXDk2Ts2aF0DQwo+zW7nfUbNz4/dHYLCdGOxBHRHWJuw2Mp1CwSojFDsuFYEq3Brbj2GaNJgAAneWRB+tgvwvfwk755PRyqTj8ezxg8SRZTuyA7OEkJEY+vRwiGtiKipTXrPWeAG8nsEqvWLlWxNSqPRAKVBGv0lDPUt7fsqeAz7ZkmjdNiyyXyLrnEc8T+Skf+a4/7Ug9S9dqGkF2RaniQOlSJ/xIfvL8R1ydw2daseApJ5Bn/wCpMKuLTpnZFHXPVxqp9IoLeoAA6De4G5l4sBlbrFuAjfNWIrpTUu7KqDezEKo7yZqbTtGIpgHzG8EWIPAg5g9hmZMa6a9aMJIp0Bia34ik0lH/AMo6TeAIm7VHRuD0iHqU6lZAoQNS20LKxBLZspJXcAewzoWdeyri0raIEmT2rmqxxfTqlkw+RBWwaoRn0bg9Dt6+qOOC1TwlIg83tsOuoS/+E9H4SZdwoJJAUDMnIADt6hFnmvhCOX0QNHUvBL/wmY8WrVT8Nq3wmpNWMG9aovMjYRaYsGdem20xNw1722Jzvyi6P9JTDrV2to7JqqPsVbqBfrucri4k/oo3NZ/aquPCmFpfNDJbmY012RFbUfCEdHnEPFarN/mbUhcfqLVXOjVWoPZcbDW7GFwT4CP881Nx7jNU5Izc0QtrZDcMvAZQhCMeK3bCEIQMCEIQAIQhABA1q0RpCpiqj0B9kdjZz4IoPXxBhH+ECqzNLoq/RPJEEqXr4rnKQ+4lPYZuwsWNh3fCWdTQKAqiygAADcABYCeoQFnklPsIQhAQITIE8uQMyQB2kD5wNpmYSMxmsOEpX5zE0QR1c4rN7q3MTtYeUxACmDUs5uOdcbKjtRd5PfbxmNpF8Wly5Hwhb0hrBVwelMRXwzW+1YMv3KgBsysBvF759RjrpjlRw7YejUpITiBU2motcBSqtbafcV2ipFszbqlPk3zOZOZJ3kmEjZ9D4YtK/RIac03iMZUNXEVC7dQ3Ig4Iu4D48ZHwhFKpJdHuhWZGV0Yq6m6spswI6wRulsaicpVOzpj22KrHa563QfZRVswHqtZB2HslSQmpizgpLktvWHleUXTBUto/i1QQveqDM+JHdK001p3E4ttrEVnqcFJsi/lQdEeUj4QsyOOMejEkNB6YrYSsteg1nXq+6y9asOsGcEJg7V8FyYvlgw4oq1Oi7YkjNGsqI3a/3hwsPKVvrHrdi8dlXqfZ9VJBs0x3j73iTIOE2xI4ox6MS1eSvXhUC4HEtYXPM1Scrsb8254kk2PbbhKrmIJmzgpKmfWM11nVVLMQFAJJJAAHEk7hKZ1Z5VKmHw5o16bV6iACk+0BcezVJzy6iASevjFXWTW3F44/bVLU+qknRpjw+8e03j2ci08m6ZeeHxCVFD0nV6Z3OhDKe4ie2IAuSABvJIA8zPnbBaQrUTejVembg9B2UXHEA2PjHbX7WxMdoqgchXFUiqg6mWm3SA9k7QI8uqPGW50cWX8dt5T4G3THKBo7DXDYhajj7lH7Q+Y6I8TIetyj7ahqFCwYXBqnP3V+souOuBX7Kn/KoOXd/wCZfFFN8ifp4RGnE6541iLVAovuWmm7xBMYdQtZK+Jq1qNYhthVZW2QDmbEG2R3j4xMw2Cvm2Q4dcsPUzQAwyvVYWqV9nL2UUdEd5uSe8SuVJRJ5NqixkhCE5TiCEIQAIQhADxXqhFLncLd5J3CcGFr1qq13uqotN9gBekH2SQSxJBtbgJ142gaiFF33BHbbq+JnauGWnQZBvCNfvIOZ/31RrSj/J2aaEWrPnbEax4yqBzmJrG43c4yj3VIEiNIsWRixLHiSSfjPdPcO4TXjPUbunQ+jrSRz6IOTDtEkJE6Mez24j5SXRCxAGZJAHeZ58lyelgfwPdCgztsopLHh+/ASZp6sOR0qig8ACfjlJzReAWimyM2PrNxP0nZOmGFVyTlmfoTMboOrTF7B1HWu8d4kZLGkHpPQaNUVwdlSenbt3EcM8j33izwf4mrPSuQqzcmGqNuRz3KfpHrCaPpUh0EAPG1z5nOdMtHRfbPJyfm+fhH/pXNSiy+srDvUj5zxLJMg9M6BVwXpALU9kZBvoYs9G0riymD8xGUqyKv5FOEZMLqv11Hz4KP3P0naNXMPwY/rMnHSZGdE/y2ni6VsToRqxOrFM+o7Ke3pD6yF/8AR6oqikRYnPa6tkb2iT0849l8Guw5uIvn6OfA4F6zbKDdvJ3AdsYaOrNMDpMxPZZRJXB4VaShFGQ8yeJ7ZvloYUlybPK30LWkdXNlS1Ik2+6cye4xflixL1gw2xWNtzdIeO/4g+cTNjSVofFNt0yOmqvuPcZtng53Bk8EbkbqJVD+yO0Oq89TZ12qSujVF9pAwLL4i4l56wY7B1qCGkF2+iUsmyVUjMHIWFrZSk69QUksu87vqZY2j6RK01AuSEAHaQAJ1wgkzysqumMWqmiudqc4w+zpkb/vP1Dw3nwjwZz6OwYo01pj7ozPFvvHznRJ5JbmcGSW5hCEJMmEIQgAQhCAGQZuVC3OsdzKFHgGv/VNE24d7G3UYF9Pk2S/s+Zdm2XDLymrEjoN3GdOJFnYcGb5mc2JPRbuPynU+j0SGRrEEbxLnXV/A08HhMThy1SpXO1tu2ahUbaUKtgLNYHryla6u6uNiCWY7NNbX9o3zsOEf8DgadFQlNbKPE+c54Qt2Wi2jphCE6DQmGUEWO4zMIAecKxK57xcHwNr+O/xm2e6GAYUamIBui1QjrbNdpKdmHEXOfDfxngZkKASzZKqglmPYBmZ0Qmmv6Pm9VglDK0l30ZnnaF7XF+F8/KNeh9Sqj2bEnm0/DQg1D2M25fC57RGmtq/hmomgKarTOY2RZgw3Ptby3abyM9VFOlyWx/j5yVy4KtmJ1aVwLYesaNQ3YAFWAyZTexHA5Zr1d2c5Z0RkpK0cWTHKEtsgnLh+leod7buxBu89/jOjEUHelUKKSq7IdtwXbYLv9rpbt8wBJZJXwer+NwNXkf+ghCEkesEhdPaMesylCAVU7+u53Xk1CZJJqmam07QqaE1bq18VTw7DY2jmx9XZXM2PWeqwzzl2aO0PRwylKVNRmSx2RtMx3kn9uqV6VB3zh0RyhV8Lt06qHEKrNslqhFQAMctog7Q75Bw2dHPrN+SKo2cs2rNFETG0lCOXFOoq2CttBiGt7V1z43kpqmgOIo37/EKSPiJX2u+vFXSRRDTFKhTNwgbaJc5bTNYbhcAWyuY4YasUKFTZhbZPXcC/wC0rh5s53GSglLstaEUMNrui2WujbXtUwCPFSRbwnT/APn2j77JrMpHtUqnX2gESbxyRxvFL6GaEhKGt+AfdiqX6iU/qAknh8fRqepVpt+WojfIxaYrxyXo6ITOyeB8pmYZtZ5hCYcgbyB3kCFAk2ZnqmMx3zfTwhO8zop0QvfxmXRfHp5yfPB8zadpbGJxC7tmtWH+Noxcn+n8LhOd9Ip7Re2y4QObC90IO4HIyL11pbOkMUv/ALznwbpD5yHlZT4SO2fVDlofEpUau9NNhGqsyoPuqQLCSUVdVsTs1Ch++Mu9bn5X8o1SkH8Toh+0IQhGGCEJhiALncIAOOpC/ZWIybFW7wmH2j8o2aN0PQw9+ZpKhbeRme65zC8BuEhtVsGaVPCowIcpWrsD1M+wAD2halvCNE45O2yb7CEIRDCGqaPp4n0hKoupqAA9alKaDaU9RBLSBwWop2/tqoNIbhTurOP5j9zuHmI06I/hlvaeq3gajW+Fp2x45JRVJk54oTacl0LWuWGSlo90pqEQNRsqiw/ipK6ls6x4E18NWpL6zIdn869Jf8QEqRGuAeP+7S2F8MvHo9QhCWGCEIQAwzWBJ3DPylfVH2iW4knzN41ayY3Yp7A9Z8u5es/t4xTkcr9Ecr9HHjcOCQw33F/OWMiiwyzH0tEOru8vnH1Y+n9kJvhGupQUm5Gf++qKmnB9u/6f6RG4pntdhHmQf2ilp3+O/wCn+kS8gh2R88VaKsLETZGzUTVFsY/O1QVwiHM7udYfcXs4nw37kbSXJSUlFWyBwOgtJvTVqBxRon1SjVNmwNsrHde8J9C0lCgKoCqoACjIADIADhCc9x+jl/Vr6KZ0/r/isQxWkxoUepUPTI/mqb79gsI58k+HNWgrvmEapck3JbaJG/vvK31n1eq4KrsPmhuadQDJ1/Zh1iWnyK1b4KouXRrN8UQ5yk3tjwdMIxrgsCcdfFG5A3Cdk5auGDEkHvHbOVGZlNx+BS/KpoXmsT6SGuuIJJB+66BQQOwix84kR05WsbUON5gn7KkqlB21FDMx4nq7hEuO0KlJL5Hqm5UhlNiDcHtEddFaQWslxkw9ZeB+kSJ7oV2Q7SMQw6x+/GbCe1lITosGeGrKDslhtb7XF7RVbWKsVtZQfaAz8t0iqjFiSxJJ3k5mVeVeiryJD/UqqouzADtIEZdT9XvSStd/7MCCouDzpHyQHfffu3SmbSQ0RpvE4VtrD1npnrCnonvQ9E+IiSyNqkL5T6StfE/lpD/G5/7c7ZSmheVeujl8TRWrtKilkPNsAhYjI3BPTPCOWj+VTR9T1zUong9MkeabQkKC0x5muvU2VZjuUE+QvIfDa36PqerjKHcaqqfJrGetMaVw7YeqFr0iWQoLVUOb9Edf80DTv0RT2aFJTvFNL9+yL/GdcjK2n8HTybE0FtxrUx+8i8XygaMpjPFI3ZTDVP6QYUAzytNddDej1udQE0au05ABPNsLbbG25CWBv1EnshpXlfw6gjD0KlRuo1CKafu3wEQNP69Y3FnpVObWzLsUQUGyxBILXLG+yOvqjRbi7M3pE+Jrr11QbTsAO0xDpV3XJWZRwDECeXcnMkk8SSfnL+U3yoeMJpClV9RgTw3HyM8aR0nTojM3fqUbz38BEiEzyujPKbsXiWqOXY5n4DqA7JphGbVLUvEY4hgDTw186zDIjhTH3z8JLsi+eWKeNDAUzY7DvYNbIlStwD+oecsJZE8raJQxGEwaMClBL7KpshTUcb8ySxC3JPGSwnTp/YT6QGJ+nD9u/h/SI4GKek6JqYoombOyKPzMFA+YlpC4+yS1I1WbHVTtXXD07c4w3k9SKeJ+A8JdtCiqKqIoVFACqBYADcBOPQWiUwlBKFPcozPWzn1mPef2nfOScrZyZsu516CEIRCJHawaHp4ui1GoN+at1o9smH+914uch5tRxK3zFVMv0Wv8PhPfKBrYuGptQpMDinFjb/hKwzY8GtuHjOTkNfLFL20T8HH7R2nsPQ00ZJclpzSqBCzE+uwOfEhUAHfYec2u4AuTYDeTFXWDTxZdigPvodoj2XUmwPdJxg5dHS5JFZ8r620i3bSpH+sfsIlAxo5RahbFKzEljTW5P5nt+8V507PjTF7PQN5mc+gdI0qGLD16Yq4ckrUQ79g72Xgw3gjh2y5TyZ4DE01rYSvUWm42kIK1Ese8bXheczVMWSoqKEsfE8kdYZriqRH86MnyJmh+SXGdVXDn9VQf6IClfwk7rRqliMBzZrmkRULBebdm9W173UW3iQUwGEIQgYEc9B4dFooVAuwuTYZk7/p4RMnThMfUpeo5A4ZEeRjwkk+SmOSj2TmtVBNhWsA+1btIsb/tFqbsTinqG7sSfl3DqmmZJ2zJyt8BCEIogQhPdKqUZXG9SGHepuPlADqw2h8TUNkw9Zr+zSc/G1ox6M5NtIVSNqmtFeNRxf3VufO0vHCYgVEWopurqrC3Bhee3qBRdiAOJIA+M0yxA0Nyb4bDFXrK+LqcAEWkp/IzDa8Se6Mmm9ZKWCw7Vq1KolNBYDZSxb7qLssd+6SH/qKtlRBqniv8Md9Td5XPZPnTlI1kxGMr2rEBKbVFSkpOwuy2zf8AmY23n4TUNGLfZBY/SVTF4psRVzqVagY9meSjsAAHhHapi2PXYcBK/wBH/wARPzL85YWBoXNzuHznRp/Y+QkEOQBPSsCYtY/EGjixVXNkem4HUSuybfCNBHX1xR0//Hb9PyEtInDsvHQWnqGMQPRcE2u1MkbaHgy/vuknPm6jWZCGRirDcykgjuIzEZtG8oGPpZGotVeFVQT7y2PmTOd4vohPTc3EuuEq5eVWrbPCpfsqsB5bMIvjkT/TzK9qVCxLMSzE3LEkkk9ZJ3yxeRbFinWxO0bLzSMf0uR/qlcCNGoDfbuONP5Mv1lpR3Kj0LotDS2lmrGwypjcOPaZGmYvBt0okkqRBuxB1/P26f3f+oxYjVygr9rSPFGHkw+sVYpaPRC4r127zHnUrXDEaPAVOnRIG1Sa+zf2lzyb5xIxS/aEcT85LyMY23YzPofVrTeExtnp1ecqjM06llemeynuHX0hfvjHPlim5UhlJDDcwJBHcRuk7R5SdJYYKFrc4vCsof8AxZN8Yssdck3j+h45cB/ZeH23/TlVyU05r5iNJc2lenSXm9og0w4J2gAQbscshIuSMaaCEITDAhCEACEIQAIQhAAhCEAL45OadGvo+gzU0LoDTY7I2r0yVFzv3bJ8Yyro7DoQeapA3AB2Fvc5DO0rXkU0mFXE0GNlULWF9wGav8klnYumWCW6nRj3A3+kxl1yjotPk3Wn+0VP7yt/mGfWU+TtbP7TV/va3+Y0aHTNIzAn7RPzL8xLVpUwoAHVKowvrr+ZfmJa9S9st9x5Xz+E6cHsjlMte44Z3/aKenx9u3cvyjaYpafYGsSOC/uJeQkOyOhCEQsEIQgBgRo1A/jv/dn+pYQgjJdD6YHdCEciI/KF/Eo/lqf1JFIwhEZaPRHY/wDiL+n5yQMzCTj2x2YnFpTcveYQhP8AaYuzn0b648ZMwhOYXIEIQmEwhCEACEIQAIQhAAhCEAG7kyY+lVf/AOXEf6JfS7hCExlo9GZ8m61/2ip/eVv8xoQjQ9jEZhPXX8y/MS2RMwnVg9kcpz409A+EUtJ+v4D94QlpdC4zkhCEQqAmYQgB/9k="});function Ze(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ye="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Xe(e,t,s){return e(s={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&s.path)}},s.exports),s.exports}function et(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})})),t}var tt=Xe((function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(256),n=0;n<e.length;n++)s[e.charCodeAt(n)]=n;t.encode=function(t){var s,n=new Uint8Array(t),r=n.length,a="";for(s=0;s<r;s+=3)a+=e[n[s]>>2],a+=e[(3&n[s])<<4|n[s+1]>>4],a+=e[(15&n[s+1])<<2|n[s+2]>>6],a+=e[63&n[s+2]];return r%3==2?a=a.substring(0,a.length-1)+"=":r%3==1&&(a=a.substring(0,a.length-2)+"=="),a},t.decode=function(e){var t,n,r,a,i,o=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l=new ArrayBuffer(o),d=new Uint8Array(l);for(t=0;t<c;t+=4)n=s[e.charCodeAt(t)],r=s[e.charCodeAt(t+1)],a=s[e.charCodeAt(t+2)],i=s[e.charCodeAt(t+3)],d[u++]=n<<2|r>>4,d[u++]=(15&r)<<4|a>>2,d[u++]=(3&a)<<6|63&i;return l}}()})),st=200,nt=400,rt=401,at=402,it=403,ot=404,ct=409,ut=429,lt=500,dt=503,ht=504,ft=1012,pt=3e3,mt=3001;class wt extends Error{constructor(...e){super(...e),this.name="UsernameAlreadyExists",this.message="Username already exists.",this.status=ct}}class gt extends Error{constructor(...e){super(...e),this.name="UsernameMissing",this.message="Username missing.",this.status=nt}}class yt extends Error{constructor(...e){super(...e),this.name="UsernameCannotBeBlank",this.message="Username cannot be blank.",this.status=nt}}class bt extends Error{constructor(e,...t){super(e,...t),this.name="UsernameTooLong",this.message="Username too long. Must be a max of ".concat(e," characters."),this.status=nt}}class vt extends Error{constructor(...e){super(...e),this.name="UsernameMustBeString",this.message="Username must be a string.",this.status=nt}}class Mt extends Error{constructor(...e){super(...e),this.name="PasswordMissing",this.message="Password missing.",this.status=nt}}class St extends Error{constructor(...e){super(...e),this.name="PasswordCannotBeBlank",this.message="Password cannot be blank.",this.status=nt}}class It extends Error{constructor(e,...t){super(e,...t),this.name="PasswordTooShort",this.message="Password too short. Must be a minimum of ".concat(e," characters."),this.status=nt}}class Et extends Error{constructor(e,...t){super(e,...t),this.name="PasswordTooLong",this.message="Password too long. Must be a max of ".concat(e," characters."),this.status=nt}}class At extends Error{constructor(...e){super(...e),this.name="PasswordMustBeString",this.message="Password must be a string.",this.status=nt}}class Bt extends Error{constructor(e,...t){super(e,...t),this.name="PasswordAttemptLimitExceeded",this.message="Password attempt limit exceeded. Must wait ".concat(e," to attempt to use password again."),this.status=rt}}class kt extends Error{constructor(...e){super(...e),this.name="UsernameOrPasswordMismatch",this.message="Username or password mismatch.",this.status=rt}}class Pt extends Error{constructor(...e){super(...e),this.name="SessionLengthMustBeNumber",this.message="Session length must be a number.",this.status=nt}}class xt extends Error{constructor(e,...t){super(e,...t),this.name="SessionLengthTooShort",this.message="Session length cannot be shorter than ".concat(e,"."),this.status=nt}}class Ut extends Error{constructor(e,...t){super(e,...t),this.name="SessionLengthTooLong",this.message="Session length cannot be longer than ".concat(e,"."),this.status=nt}}class Nt extends Error{constructor(...e){super(...e),this.name="AllowServerSideEncryptionMustBeBoolean",this.message="Allow server-side encryption value must be a boolean.",this.status=nt}}class Tt extends Error{constructor(e,...t){super(...t),this.name="UserAlreadySignedIn",this.message="Already signed in.",this.status=nt,this.username=e}}class Dt extends Error{constructor(...e){super(...e),this.name="UserPendingDeletion",this.message="User is pending deletion.",this.status=it}}class Kt extends Error{constructor(...e){super(...e),this.name="AppIdNotValid",this.message="App ID not valid.",this.status=rt}}class Ot extends Error{constructor(e,...t){super(e,...t),this.name="DomainNotWhitelisted",this.message="Domain not whitelisted. Whitelist the domain ".concat(e?"'".concat(e,"' "):"","in your admin panel."),this.status=rt}}class Rt extends Error{constructor(...e){super(...e),this.name="UserNotSignedIn",this.message="Not signed in.",this.status=nt}}class Ct extends Error{constructor(e,...t){super(e,...t),e&&(this.username=e),this.name="UserNotFound",this.message="User not found.",this.status=ot}}class Ft extends Error{constructor(...e){super(...e),this.name="UserEmailNotFound",this.message="User does not have an email saved.",this.status=ot}}class Lt extends Error{constructor(...e){super(...e),this.name="UserMustChangePassword",this.message="Must change password first.",this.status=it}}class qt extends Error{constructor(...e){super(...e),this.name="EmailNotValid",this.message="Email not valid.",this.status=nt}}class jt extends Error{constructor(...e){super(...e),this.name="ProfileMustBeObject",this.message="Profile must be a flat JSON object.",this.status=nt}}class Vt extends Error{constructor(...e){super(...e),this.name="ProfileCannotBeEmpty",this.message="Profile cannot be empty.",this.status=nt}}class _t extends Error{constructor(e,...t){super(e,...t),this.name="ProfileHasTooManyKeys",this.message="Profile has too many keys. Must have a max of ".concat(e," keys."),this.status=nt}}class Ht extends Error{constructor(e,t,...s){super(e,t,...s),this.name="ProfileKeyTooLong",this.message="Profile key too long. Must be a max of ".concat(e," characters."),this.status=nt,this.key=t}}class $t extends Error{constructor(e,t,...s){super(e,t,...s),this.name="ProfileValueMustBeString",this.message="Profile value must be a string.",this.status=nt,this.key=e,this.value=t}}class Gt extends Error{constructor(e,...t){super(e,...t),this.name="ProfileValueCannotBeBlank",this.message="Profile value cannot be blank.",this.status=nt,this.key=e}}class Jt extends Error{constructor(e,t,s,...n){super(e,t,s,...n),this.name="ProfileValueTooLong",this.message="Profile value too long. Must be a max of ".concat(e," characters."),this.status=nt,this.key=t,this.value=s}}class zt extends Error{constructor(e,...t){super(e,...t),this.name="RememberMeValueNotValid",this.message="Remember me value must be one of ".concat(JSON.stringify(Object.keys(e)),"."),this.status=nt}}class Wt extends Error{constructor(...e){super(...e),this.name="ParamsMissing",this.message="Parameters expected are missing.",this.status=nt}}class Qt extends Error{constructor(...e){super(...e),this.name="TrialExceededLimit",this.message="Trial exceeded limit of users.",this.status=at}}class Zt extends Error{constructor(...e){super(...e),this.name="CurrentPasswordMissing",this.message="Current password missing.",this.status=nt}}class Yt extends Error{constructor(...e){super(...e),this.name="CurrentPasswordIncorrect",this.message="Current password is incorrect.",this.status=rt}}class Xt extends Error{constructor(e,...t){super(e,...t),this.name="KeyNotFound",this.message=e,this.status=ot}}class es extends Error{constructor(...e){super(...e),this.name="DeleteEndToEndEncryptedDataMustBeBoolean",this.message="Delete end-to-end encrypted data value must be a boolean.",this.status=nt}}var ts={UsernameAlreadyExists:wt,UsernameMissing:gt,UsernameCannotBeBlank:yt,UsernameTooLong:bt,UsernameMustBeString:vt,PasswordMissing:Mt,PasswordCannotBeBlank:St,PasswordTooShort:It,PasswordTooLong:Et,PasswordMustBeString:At,PasswordAttemptLimitExceeded:Bt,UsernameOrPasswordMismatch:kt,SessionLengthMustBeNumber:Pt,SessionLengthTooShort:xt,SessionLengthTooLong:Ut,AllowServerSideEncryptionMustBeBoolean:Nt,UserAlreadySignedIn:Tt,UserPendingDeletion:Dt,AppIdNotValid:Kt,DomainNotWhitelisted:Ot,UserNotSignedIn:Rt,UserNotFound:Ct,UserEmailNotFound:Ft,UserMustChangePassword:Lt,EmailNotValid:qt,ProfileMustBeObject:jt,ProfileCannotBeEmpty:Vt,ProfileHasTooManyKeys:_t,ProfileKeyTooLong:Ht,ProfileValueMustBeString:$t,ProfileValueCannotBeBlank:Gt,ProfileValueTooLong:Jt,RememberMeValueNotValid:zt,ParamsMissing:Wt,TrialExceededLimit:Qt,CurrentPasswordMissing:Zt,CurrentPasswordIncorrect:Yt,KeyNotFound:Xt,DeleteEndToEndEncryptedDataMustBeBoolean:es};class ss extends Error{constructor(...e){super(...e),this.name="DatabaseNameMissing",this.message="Database name missing.",this.status=nt}}class ns extends Error{constructor(...e){super(...e),this.name="DatabaseNameCannotBeBlank",this.message="Database name cannot be blank.",this.status=nt}}class rs extends Error{constructor(...e){super(...e),this.name="DatabaseNameMustBeString",this.message="Database name must be a string.",this.status=nt}}class as extends Error{constructor(e,...t){super(e,...t),this.name="DatabaseNameTooLong",this.message="Database name cannot be more than ".concat(e," characters."),this.status=nt}}class is extends Error{constructor(e,...t){super(e,...t),this.name="DatabaseNameRestricted",this.message="Database name '".concat(e,"' is restricted. It is used internally by userbase-js."),this.status=it}}class os extends Error{constructor(...e){super(...e),this.name="DatabaseAlreadyOpening",this.message="Already attempting to open database.",this.status=nt}}class cs extends Error{constructor(...e){super(...e),this.name="ChangeHandlerMissing",this.message="Change handler missing.",this.status=nt}}class us extends Error{constructor(...e){super(...e),this.name="ChangeHandlerMustBeFunction",this.message="Change handler must be a function.",this.status=nt}}class ls extends Error{constructor(e,...t){super(e,...t),this.name="EncryptionModeNotValid",this.message="Encryption mode must be one of ".concat(JSON.stringify(Object.keys(e)),"."),this.status=nt}}class ds extends Error{constructor(...e){super(...e),this.name="ServerSideEncryptionNotEnabledInClient",this.message="Server-side encryption must be enabled in the client to use it. To enable it, set allowServerSideEncryption to true in init().",this.status=it}}class hs extends Error{constructor(...e){super(...e),this.name="DatabaseNotOpen",this.message="Database is not open.",this.status=nt}}class fs extends Error{constructor(...e){super(...e),this.name="DatabaseNotFound",this.message="Database not found. Find available databases using getDatabases().",this.status=ot}}class ps extends Error{constructor(...e){super(...e),this.name="DatabaseIsReadOnly",this.message="Database is read only. Must have permission to write to database.",this.status=it}}class ms extends Error{constructor(...e){super(...e),this.name="DatabaseIdMustBeString",this.message="Database id must be a string.",this.status=nt}}class ws extends Error{constructor(...e){super(...e),this.name="DatabaseIdCannotBeBlank",this.message="Database id cannot be blank.",this.status=nt}}class gs extends Error{constructor(...e){super(...e),this.name="DatabaseIdNotAllowed",this.message="Database id not allowed. Cannot provide both databaseName and databaseId, can only provide one.",this.status=nt}}class ys extends Error{constructor(...e){super(...e),this.name="DatabaseIdNotAllowedForOwnDatabase",this.message="Tried to open the user's own database using its databaseId rather than its databaseName. The databaseId should only be used to open databases shared from other users.",this.status=it}}class bs extends Error{constructor(e,...t){super(e,...t),this.name="DatabaseIdInvalidLength",this.message="Database id invalid length. Must be ".concat(e," characters."),this.status=nt}}class vs extends Error{constructor(...e){super(...e),this.name="ShareTokenInvalid",this.message="Share token invalid.",this.status=nt}}class Ms extends Error{constructor(...e){super(...e),this.name="ShareTokenNotFound",this.message="Share token not found. Perhaps the database owner has generated a new share token.",this.status=ot}}class Ss extends Error{constructor(e,...t){super(e,...t),this.name="ShareTokenNotAllowed",this.message="Share token not allowed.",this.status=nt}}class Is extends Error{constructor(...e){super(...e),this.name="ShareTokenNotAllowedForOwnDatabase",this.message="Tried to open the user's own database using its shareToken rather than its databaseName. The shareToken should only be used to open databases shared from other users.",this.status=it}}class Es extends Error{constructor(...e){super(...e),this.name="ReadOnlyMustBeBoolean",this.message="Read only value must be a boolean.",this.status=nt}}class As extends Error{constructor(...e){super(...e),this.name="ReadOnlyParamNotAllowed",this.message="Read only parameter not allowed when revoking access to a database.",this.status=nt}}class Bs extends Error{constructor(e,...t){super(e,...t),this.name="ResharingAllowedParamNotAllowed",this.message="Resharing allowed parameter not allowed ".concat(e,"."),this.status=nt}}class ks extends Error{constructor(...e){super(...e),this.name="ResharingAllowedMustBeBoolean",this.message="Resharing allowed value must be a boolean.",this.status=nt}}class Ps extends Error{constructor(e,...t){super(e,...t),this.name="ResharingNotAllowed",this.message="Resharing not allowed. ".concat(e,"."),this.status=it}}class xs extends Error{constructor(...e){super(...e),this.name="ResharingWithWriteAccessNotAllowed",this.message="Resharing with write access not allowed. Must have permission to write to the database to reshare the database with write access another user.",this.status=it}}class Us extends Error{constructor(...e){super(...e),this.name="SharingWithSelfNotAllowed",this.message="Sharing database with self is not allowed. Must share database with another user.",this.status=nt}}class Ns extends Error{constructor(...e){super(...e),this.name="ModifyingOwnPermissionsNotAllowed",this.message="Modifying own database permissions not allowed. Must modify another user's permissions.",this.status=nt}}class Ts extends Error{constructor(...e){super(...e),this.name="ModifyingOwnerPermissionsNotAllowed",this.message="Modifying the owner of a database's permissions is not allowed.",this.status=it}}class Ds extends Error{constructor(...e){super(...e),this.name="ModifyingPermissionsNotAllowed",this.message="Modifying another user's permissions is not allowed. Must have permission to reshare the database with another user.",this.status=it}}class Ks extends Error{constructor(...e){super(...e),this.name="GrantingWriteAccessNotAllowed",this.message="Granting write access not allowed. Must have permission to write to the database to grant write access to another user.",this.status=it}}class Os extends Error{constructor(...e){super(...e),this.name="RequireVerifiedMustBeBoolean",this.message="Require verified value must be a boolean.",this.status=nt}}class Rs extends Error{constructor(...e){super(...e),this.name="RequireVerifiedParamNotNecessary",this.message="Require verified parameter not necessary when sharing database without a username.",this.status=nt}}class Cs extends Error{constructor(...e){super(...e),this.name="RevokeMustBeBoolean",this.message="Revoke value must be a boolean.",this.status=nt}}class Fs extends Error{constructor(...e){super(...e),this.name="ItemMissing",this.message="Item missing.",this.status=nt}}class Ls extends Error{constructor(...e){super(...e),this.name="ItemInvalid",this.message="Item must be serializable to JSON.",this.status=nt}}class qs extends Error{constructor(e,...t){super(e,...t),this.name="ItemTooLarge",this.message="Item must be less than ".concat(e," KB."),this.status=nt}}class js extends Error{constructor(...e){super(...e),this.name="ItemIdMustBeString",this.message="Item id must be a string.",this.status=nt}}class Vs extends Error{constructor(e,...t){super(e,...t),this.name="ItemIdTooLong",this.message="Item id cannot be more than ".concat(e," characters."),this.status=nt}}class _s extends Error{constructor(...e){super(...e),this.name="ItemIdMissing",this.message="Item id missing.",this.status=nt}}class Hs extends Error{constructor(...e){super(...e),this.name="ItemIdCannotBeBlank",this.message="Item id cannot be blank.",this.status=nt}}class $s extends Error{constructor(...e){super(...e),this.name="ItemAlreadyExists",this.message="Item with the same id already exists.",this.status=ct}}class Gs extends Error{constructor(...e){super(...e),this.name="ItemDoesNotExist",this.message="Item with the provided id does not exist.",this.status=ot}}class Js extends Error{constructor(...e){super(...e),this.name="ItemUpdateConflict",this.message="Item update conflict.",this.status=ct}}class zs extends Error{constructor(...e){super(...e),this.name="FileMissing",this.message="File missing.",this.status=nt}}class Ws extends Error{constructor(...e){super(...e),this.name="FileMustBeFile",this.message="File must be a file.",this.status=nt}}class Qs extends Error{constructor(...e){super(...e),this.name="FileCannotBeEmpty",this.message="File cannot be empty.",this.status=nt}}class Zs extends Error{constructor(...e){super(...e),this.name="FileUploadConflict",this.message="File upload conflict.",this.status=ct}}class Ys extends Error{constructor(...e){super(...e),this.name="FileNotFound",this.message="File not found.",this.status=ot}}class Xs extends Error{constructor(...e){super(...e),this.name="FileIdMissing",this.message="File id missing.",this.status=nt}}class en extends Error{constructor(...e){super(...e),this.name="FileIdMustBeString",this.message="File id must be a string.",this.status=nt}}class tn extends Error{constructor(...e){super(...e),this.name="FileIdCannotBeBlank",this.message="File id cannot be blank.",this.status=nt}}class sn extends Error{constructor(e,...t){super(e,...t),this.name="FileIdTooLong",this.message="File id cannot be more than ".concat(e," characters."),this.status=nt}}class nn extends Error{constructor(...e){super(...e),this.name="RangeMustBeObject",this.message="Range param provided must be object.",this.status=nt}}class rn extends Error{constructor(...e){super(...e),this.name="RangeMissingStart",this.message="Range param missing start.",this.status=nt}}class an extends Error{constructor(...e){super(...e),this.name="RangeMissingEnd",this.message="Range param missing end.",this.status=nt}}class on extends Error{constructor(...e){super(...e),this.name="RangeStartMustBeNumber",this.message="Range start provided must be a number.",this.status=nt}}class cn extends Error{constructor(...e){super(...e),this.name="RangeEndMustBeNumber",this.message="Range end provided must be a number.",this.status=nt}}class un extends Error{constructor(...e){super(...e),this.name="RangeStartMustBeGreaterThanZero",this.message="Range start provided must be greater than 0.",this.status=nt}}class ln extends Error{constructor(...e){super(...e),this.name="RangeEndMustBeGreaterThanRangeStart",this.message="Range end provided must be greater than range start.",this.status=nt}}class dn extends Error{constructor(...e){super(...e),this.name="RangeEndMustBeLessThanFileSize",this.message="Range end provided must be less than file size.",this.status=nt}}class hn extends Error{constructor(...e){super(...e),this.name="OperationsMissing",this.message="Operations missing.",this.status=nt}}class fn extends Error{constructor(...e){super(...e),this.name="OperationsMustBeArray",this.message="Operations provided must be an array.",this.status=nt}}class pn extends Error{constructor(e,...t){super(e,...t),this.name="CommandNotRecognized",this.message="Command '".concat(e,"' not recognized."),this.status=nt}}class mn extends Error{constructor(...e){super(...e),this.name="OperationsConflict",this.message="Operations conflict. Only allowed 1 operation per item.",this.status=ct}}class wn extends Error{constructor(e,...t){super(e,...t),this.name="OperationsExceedLimit",this.message="Operations exceed limit. Only allowed ".concat(e," operations."),this.status=nt}}class gn extends Error{constructor(...e){super(...e),this.name="UserNotVerified",this.message="User not verified. Either verify user before sharing database, or set requireVerified to false.",this.status=it}}class yn extends Error{constructor(...e){super(...e),this.name="UserMustBeReverified",this.message="User must be reverified.",this.status=it}}class bn extends Error{constructor(...e){super(...e),this.name="UserUnableToReceiveDatabase",this.message="User unable to receive database. User must sign in with an updated userbase-js client to be able to receive database.",this.status=it}}class vn extends Error{constructor(...e){super(...e),this.name="VerificationMessageMissing",this.message="Verification message missing.",this.status=nt}}class Mn extends Error{constructor(...e){super(...e),this.name="VerificationMessageCannotBeBlank",this.message="Verification message cannot be blank.",this.status=nt}}class Sn extends Error{constructor(...e){super(...e),this.name="VerificationMessageMustBeString",this.message="Verification message must be a string.",this.status=nt}}class In extends Error{constructor(e,...t){super(e,...t),this.name="VerificationMessageInvalid",this.message="Verification message invalid.",this.status=nt}}class En extends Error{constructor(e,...t){super(e,...t),this.name="VerifyingSelfNotAllowed",this.message="Verifying self not allowed. Can only verify other users.",this.status=nt}}class An extends Error{constructor(...e){super(...e),this.name="ProgressHandlerMustBeFunction",this.message="Progress handler must be a function.",this.status=nt}}class Bn extends Error{constructor(e,...t){super(e,...t),this.name="TransactionUnauthorized",this.message="Calling '".concat(e,"' on this item is unauthorized."),this.status=it}}class kn extends Error{constructor(e,...t){super(e,...t),this.name="WriteAccessParamNotAllowed",this.message="Write access parameter not allowed. Only the item creator or database owner can change an item's write access settings.",this.status=it}}var Pn={DatabaseNameMissing:ss,DatabaseNameCannotBeBlank:ns,DatabaseNameMustBeString:rs,DatabaseNameTooLong:as,DatabaseNameRestricted:is,DatabaseNotFound:fs,DatabaseIsReadOnly:ps,DatabaseAlreadyOpening:os,DatabaseIdMustBeString:ms,DatabaseIdCannotBeBlank:ws,DatabaseIdNotAllowed:gs,DatabaseIdNotAllowedForOwnDatabase:ys,DatabaseIdInvalidLength:bs,ShareTokenInvalid:vs,ShareTokenNotFound:Ms,ShareTokenNotAllowed:Ss,ShareTokenNotAllowedForOwnDatabase:Is,ReadOnlyMustBeBoolean:Es,ReadOnlyParamNotAllowed:As,ResharingAllowedMustBeBoolean:ks,ResharingNotAllowed:Ps,ResharingWithWriteAccessNotAllowed:xs,ResharingAllowedParamNotAllowed:Bs,SharingWithSelfNotAllowed:Us,ModifyingOwnPermissionsNotAllowed:Ns,ModifyingOwnerPermissionsNotAllowed:Ts,ModifyingPermissionsNotAllowed:Ds,GrantingWriteAccessNotAllowed:Ks,RequireVerifiedMustBeBoolean:Os,RequireVerifiedParamNotNecessary:Rs,RevokeMustBeBoolean:Cs,ChangeHandlerMissing:cs,ChangeHandlerMustBeFunction:us,EncryptionModeNotValid:ls,ServerSideEncryptionNotEnabledInClient:ds,DatabaseNotOpen:hs,ItemMissing:Fs,ItemInvalid:Ls,ItemTooLarge:qs,ItemIdMustBeString:js,ItemIdTooLong:Vs,ItemIdMissing:_s,ItemIdCannotBeBlank:Hs,ItemAlreadyExists:$s,ItemDoesNotExist:Gs,ItemUpdateConflict:Js,FileMissing:zs,FileMustBeFile:Ws,FileCannotBeEmpty:Qs,FileUploadConflict:Zs,FileNotFound:Ys,FileIdMissing:Xs,FileIdMustBeString:en,FileIdCannotBeBlank:tn,FileIdTooLong:sn,RangeMustBeObject:nn,RangeMissingStart:rn,RangeMissingEnd:an,RangeStartMustBeNumber:on,RangeEndMustBeNumber:cn,RangeStartMustBeGreaterThanZero:un,RangeEndMustBeGreaterThanRangeStart:ln,RangeEndMustBeLessThanFileSize:dn,OperationsMissing:hn,OperationsMustBeArray:fn,OperationsConflict:mn,OperationsExceedLimit:wn,CommandNotRecognized:pn,UserNotVerified:gn,UserMustBeReverified:yn,UserUnableToReceiveDatabase:bn,VerificationMessageMissing:vn,VerificationMessageMustBeString:Sn,VerificationMessageCannotBeBlank:Mn,VerificationMessageInvalid:In,VerifyingSelfNotAllowed:En,ProgressHandlerMustBeFunction:An,TransactionUnauthorized:Bn,WriteAccessParamNotAllowed:kn};class xn extends Error{constructor(e,...t){super(e,...t),this.name="AppIdAlreadySet",this.message="Application ID already set.",this.status=ct,this.appId=e}}class Un extends Error{constructor(...e){super(...e),this.name="AppIdMustBeString",this.message="Application ID must be a string.",this.status=nt}}class Nn extends Error{constructor(...e){super(...e),this.name="AppIdMissing",this.message="Application ID missing.",this.status=nt}}class Tn extends Error{constructor(...e){super(...e),this.name="AppIdCannotBeBlank",this.message="Application ID cannot be blank.",this.status=nt}}class Dn extends Error{constructor(...e){super(...e),this.name="WebCryptoUnavailable",this.message="The WebCrypto API is unavailable. Please make sure your website uses https.",this.status=nt}}class Kn extends Error{constructor(...e){super(...e),this.name="UpdateUserHandlerMustBeFunction",this.message="Update user handler must be a function.",this.status=nt}}var On={AppIdAlreadySet:xn,AppIdMustBeString:Un,AppIdMissing:Nn,AppIdCannotBeBlank:Tn,WebCryptoUnavailable:Dn,UpdateUserHandlerMustBeFunction:Kn};class Rn extends Error{constructor(...e){super(...e),this.name="SuccessUrlMissing",this.message="Success url missing to let Stripe know where to redirect users on successful payment.",this.status=nt}}class Cn extends Error{constructor(...e){super(...e),this.name="SuccessUrlMustBeString",this.message="Success url must be a string.",this.status=nt}}class Fn extends Error{constructor(e,...t){super(e,...t),this.name="SuccessUrlInvalid",this.message=e?"Success url must start with http or https.":"Success url invalid.",this.status=nt}}class Ln extends Error{constructor(...e){super(...e),this.name="CancelUrlMissing",this.message="Cancel url missing to let Stripe know where to redirect users on canceled payment.",this.status=nt}}class qn extends Error{constructor(...e){super(...e),this.name="CancelUrlMustBeString",this.message="Cancel url must be a string.",this.status=nt}}class jn extends Error{constructor(e,...t){super(e,...t),this.name="CancelUrlInvalid",this.message=e?"Cancel url must start with http or https.":"Cancel url invalid.",this.status=nt}}class Vn extends Error{constructor(...e){super(...e),this.name="StripeLibraryMissing",this.message="Stripe.js library missing. Be sure to include the script in your html file (https://stripe.com/docs/stripe-js#setup).",this.status=nt}}class _n extends Error{constructor(...e){super(...e),this.name="PaymentsDisabled",this.message="Payments on this app are disabled. Enable payments in the admin panel.",this.status=it}}class Hn extends Error{constructor(...e){super(...e),this.name="PriceIdOrPlanIdAllowed",this.message="Only one of priceId or planId allowed.",this.status=nt}}class $n extends Error{constructor(...e){super(...e),this.name="PriceIdOrPlanIdMissing",this.message="Please provide a priceId or planId. You can create a product in the Stripe dashboard and find its priceId there.",this.status=nt}}class Gn extends Error{constructor(...e){super(...e),this.name="SubscriptionPlanAlreadyPurchased",this.message="Subscription plan already purchased. Cancel subscription to purchase another.",this.status=ct}}class Jn extends Error{constructor(...e){super(...e),this.name="StripeAccountNotConnected",this.message="Stripe account not connected. Connect a Stripe account in the admin panel.",this.status=it}}class zn extends Error{constructor(...e){super(...e),this.name="SubscriptionNotFound",this.message="Subscription not found. User must purchase a subscription.",this.status=at}}class Wn extends Error{constructor(e,...t){super(...t),this.name="SubscriptionInactive",this.message="The user's subscription is inactive.",this.subscriptionStatus=e,this.status=at}}class Qn extends Error{constructor(...e){super(...e),this.name="SubscriptionNotPurchased",this.message="Subscription not purchased. User must purchase a subscription.",this.status=at}}class Zn extends Error{constructor(...e){super(...e),this.name="SubscriptionAlreadyCanceled",this.message="Subscription already canceled. User must purchase a new subscription.",this.status=nt}}class Yn extends Error{constructor(...e){super(...e),this.name="TrialExpired",this.message="Trial expired. User must purchase a subscription.",this.status=at}}class Xn extends Error{constructor(e,...t){super(e,...t);const{status:s,type:n,message:r}=e;this.name="StripeError",this.message=r,this.type=n,this.status=s}}var er={SuccessUrlMissing:Rn,SuccessUrlMustBeString:Cn,SuccessUrlInvalid:Fn,CancelUrlMissing:Ln,CancelUrlMustBeString:qn,CancelUrlInvalid:jn,StripeJsLibraryMissing:Vn,PaymentsDisabled:_n,PriceIdOrPlanIdAllowed:Hn,PriceIdOrPlanIdMissing:$n,SubscriptionPlanAlreadyPurchased:Gn,StripeAccountNotConnected:Jn,SubscriptionNotFound:zn,SubscriptionInactive:Wn,SubscriptionNotPurchased:Qn,SubscriptionAlreadyCanceled:Zn,TrialExpired:Yn,StripeError:Xn};function tr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function sr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(s),!0).forEach((function(t){Ze(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):tr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}class nr extends Error{constructor(...e){super(...e),this.name="AppIdNotSet",this.message="App ID not set yet. Make sure to configure app ID.",this.status=nt}}class rr extends Error{constructor(...e){super(...e),this.name="ServiceUnavailable",this.message="Service unavailable.",this.status=dt}}class ar extends Error{constructor(...e){super(...e),this.name="ParamsMustBeObject",this.message="Parameters passed to function must be placed inside an object.",this.status=nt}}class ir extends Error{constructor(e,...t){super(e,...t);const s=Math.floor(e/1e3);this.name="TooManyRequests",this.message="Too many requests in a row. Please try again in ".concat(s," second").concat(1!==s?"s":"","."),this.status=ut}}var or=sr(sr(sr(sr(sr({},ts),Pn),On),er),{},{AppIdNotSet:nr,InternalServerError:class extends rr{constructor(...e){super(...e),this.status=lt}},ServiceUnavailable:rr,Timeout:class extends rr{constructor(...e){super(...e),this.status=ht}},Reconnecting:class extends rr{constructor(...e){super(...e),this.message="Reconnecting."}},UnknownServiceUnavailable:class extends rr{constructor(e,...t){super(e,...t),console.error("Userbase error. Please report this to support@userbase.com.\n\n",e)}},ParamsMustBeObject:ar,TooManyRequests:ir});let cr=null,ur=null,lr=!1;var dr="2.8.0",hr=()=>{if(!cr)throw new or.AppIdNotSet;return cr},fr=()=>ur,pr=()=>window._userbaseEndpoint||"https://v1.userbase.com/v1",mr=({appId:e,updateUserHandler:t,allowServerSideEncryption:s})=>{if(cr&&cr!==e)throw new or.AppIdAlreadySet(cr);cr=e,ur=t,lr=s},wr=e=>e?window._USERBASE_STRIPE_PRODUCTION_PUBLISHABLE_KEY||"pk_live_jI6lbsAIQlu2u4uTkDXFrSEW":window._USERBASE_STRIPE_TEST_PUBLISHABLE_KEY||"pk_test_rYANrLdNfdJXJ2d808wW4pqY",gr=()=>lr;class yr extends Error{constructor(e,t,s,...n){super(e,t,s,...n),this.response={data:e,status:t,statusText:s},this.message="Request failed with status code "+t}}class br extends Error{constructor(e,...t){super(e,...t),this.message="timeout of ".concat(e,"ms exceeded")}}const vr=(e,t,s,n=1e4)=>{e.timeout=n,e.onload=()=>((e,t,s)=>{let n;try{n=JSON.parse(e.response)}catch(t){n=e.response}e.status>=200&&e.status<300?t(n):s(new yr(n,e.status,e.statusText))})(e,t,s),e.onerror=()=>s(new or.ServiceUnavailable),e.ontimeout=()=>s(new br(n))};for(var Mr=(e,t,s,n,r,a,i,o,c)=>new Promise(((u,l)=>{const d=new XMLHttpRequest,h="".concat(pr(),"/api/auth/sign-up?appId=").concat(hr(),"&userbaseJsVersion=").concat(dr),f=JSON.stringify({username:e,passwordToken:t,ecKeyData:s,passwordSalts:n,keySalts:r,email:a,profile:i,passwordBasedBackup:o,sessionLength:c});d.open("POST",h),d.setRequestHeader("Content-Type","application/json"),d.send(f),vr(d,u,l)})),Sr=e=>new Promise(((t,s)=>{const n=new XMLHttpRequest,r="".concat(pr(),"/api/auth/get-password-salts?appId=").concat(hr(),"&username=").concat(encodeURIComponent(e),"&userbaseJsVersion=").concat(dr);n.open("GET",r),n.send(),vr(n,t,s)})),Ir=async(e,t,s)=>new Promise(((n,r)=>{const a=new XMLHttpRequest,i="".concat(pr(),"/api/auth/sign-in?appId=").concat(hr(),"&userbaseJsVersion=").concat(dr),o=JSON.stringify({username:e,passwordToken:t,sessionLength:s});a.open("POST",i),a.setRequestHeader("Content-Type","application/json"),a.send(o),vr(a,n,r)})),Er=(e,t)=>new Promise(((s,n)=>{const r=new XMLHttpRequest,a="".concat(pr(),"/api/auth/sign-in-with-session?appId=").concat(hr(),"&sessionId=").concat(e,"&userbaseJsVersion=").concat(dr),i=JSON.stringify({sessionLength:t});r.open("POST",a),r.setRequestHeader("Content-Type","application/json"),r.send(i),vr(r,s,n)})),Ar=async()=>new Promise(((e,t)=>{const s=new XMLHttpRequest,n="".concat(pr(),"/api/auth/server-public-key?&userbaseJsVersion=").concat(dr);s.open("GET",n),s.responseType="arraybuffer",s.send(),vr(s,e,t)})),Br=e=>new Promise(((t,s)=>{const n=new XMLHttpRequest,r="".concat(pr(),"/api/public-key?appId=").concat(hr(),"&username=").concat(encodeURIComponent(e),"&userbaseJsVersion=").concat(dr);n.open("GET",r),n.send(),vr(n,t,s)})),kr=Xe((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var s=new Uint8Array(16);e.exports=function(){return t(s),s}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}})),Pr=[],xr=0;xr<256;++xr)Pr[xr]=(xr+256).toString(16).substr(1);var Ur=function(e,t){var s=t||0,n=Pr;return[n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]]].join("")};var Nr=function(e,t,s){var n=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||kr)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var a=0;a<16;++a)t[n+a]=r[a];return t||Ur(r)};function Tr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Dr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(s),!0).forEach((function(t){Ze(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Tr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const Kr=e=>(...t)=>{try{return e(...t)}catch(e){console.warn("Error accessing browser storage. Defaulting to memory.\n\n",e)}},Or=(e,t)=>"userbaseSeed.".concat(e,".").concat(t),Rr=Kr(((e,t,s,n,r,a)=>{const i={username:t,signedIn:s,sessionId:n,creationDate:r,expirationDate:a},o=JSON.stringify(i);"local"===e?localStorage.setItem("userbaseCurrentSession",o):"session"===e&&sessionStorage.setItem("userbaseCurrentSession",o)}));var Cr={signInSession:(e,t,s,n,r)=>{Rr(e,t,!0,s,n,r)},signOutSession:(e,t)=>{Rr(e,t,!1)},getCurrentSession:Kr((()=>{const e=sessionStorage.getItem("userbaseCurrentSession");if(e){if(!JSON.parse(e).signedIn){const e=localStorage.getItem("userbaseCurrentSession");if(e){const t=JSON.parse(e);if(t.signedIn)return Dr(Dr({},t),{},{rememberMe:"local"})}}return Dr(Dr({},JSON.parse(e)),{},{rememberMe:"session"})}const t=localStorage.getItem("userbaseCurrentSession");return t&&Dr(Dr({},JSON.parse(t)),{},{rememberMe:"local"})})),saveSeedString:Kr(((e,t,s,n)=>{"local"===e?localStorage.setItem(Or(t,s),n):"session"===e&&sessionStorage.setItem(Or(t,s),n)})),removeSeedString:Kr(((e,t)=>{const s=Or(e,t);sessionStorage.removeItem(s),localStorage.removeItem(s)})),getSeedString:Kr(((e,t)=>{const s=Or(e,t);return sessionStorage.getItem(s)||localStorage.getItem(s)})),removeCurrentSession:Kr((()=>{sessionStorage.removeItem("userbaseCurrentSession"),localStorage.removeItem("userbaseCurrentSession")}))};const Fr=(e,t)=>{const s=t?new Uint8Array(e):new Uint16Array(e),n=s.length;let r="",a=10240;for(var i=0;i<n;i+=a){i+a>n&&(a=n-i);const e=s.subarray(i,i+a);r+=String.fromCharCode.apply(null,e)}return r},Lr=(e,t=!1)=>{let s=new ArrayBuffer(e.length*(t?1:2)),n=t?new Uint8Array(s):new Uint16Array(s);for(let t=0,s=e.length;t<s;t++)n[t]=e.charCodeAt(t);return s},qr=(e,t)=>{const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer},jr="SHA-256",Vr=async e=>await window.crypto.subtle.digest({name:jr},e);var _r={BYTE_SIZE:32,HASH_ALGORITHM_NAME:jr,hash:Vr,hashBase64String:async e=>{const t=tt.decode(e),s=await Vr(t);return tt.encode(s)},hashString:async e=>{const t=Lr(e),s=await Vr(t);return tt.encode(s)}};const Hr="HKDF",$r=["deriveKey","deriveBits"],Gr=async e=>await window.crypto.subtle.importKey("raw",e,{name:Hr},false,$r),Jr=_r.BYTE_SIZE,zr=(e,t)=>({name:Hr,info:Lr(e),hash:_r.HASH_ALGORITHM_NAME,salt:t});var Wr={importHkdfKeyFromString:async e=>{const t=Lr(e);return await Gr(t)},importHkdfKey:Gr,generateSalt:()=>window.crypto.getRandomValues(new Uint8Array(Jr)),getParams:zr,getPasswordToken:async(e,t)=>{const s=await window.crypto.subtle.deriveBits(zr("password-token",t),e,256);return tt.encode(s)}};const Qr="AES-GCM",Zr=!0,Yr=["encrypt","decrypt"],Xr="raw",ea=()=>"undefined"!=typeof window?window:self,ta=()=>({name:Qr,length:256}),sa=e=>({name:Qr,tagLength:128,iv:e}),na=()=>window.crypto.getRandomValues(new Uint8Array(12)),ra=e=>{const t=e.byteLength-12;return{ciphertextArrayBuffer:e.slice(0,t),iv:e.slice(t)}},aa=async()=>await window.crypto.subtle.generateKey(ta(),Zr,Yr),ia=async e=>await ea().crypto.subtle.importKey(Xr,e,{name:Qr},Zr,Yr),oa=async e=>await ea().crypto.subtle.exportKey(Xr,e),ca=async(e,t)=>{const s=na(),n=await ea().crypto.subtle.encrypt(sa(s),e,t);return qr(n,s)},ua=async(e,t)=>{const s=Lr(t),n=await ca(e,s);return tt.encode(n)},la=async(e,t)=>{const{ciphertextArrayBuffer:s,iv:n}=ra(t);return await ea().crypto.subtle.decrypt(sa(n),e,s)},da=async(e,t)=>{const s=tt.decode(t),n=await la(e,s);return Fr(n)};for(var ha={getEncryptionKeyParams:ta,getCiphertextParams:sa,generateIv:na,sliceEncryptedArrayBuffer:ra,importKeyFromMaster:async(e,t,s="encryption")=>await window.crypto.subtle.deriveKey(Wr.getParams(s,t),e,ta(),Zr,Yr),generateKey:aa,getKeyStringFromKey:async e=>{const t=await window.crypto.subtle.exportKey(Xr,e);return tt.encode(t)},getKeyFromKeyString:async e=>{const t=tt.decode(e);return await ia(t)},getRawKeyFromKey:oa,getKeyFromRawKey:ia,encrypt:ca,encryptJson:async(e,t)=>{const s=JSON.stringify(t);return await ua(e,s)},encryptString:ua,decrypt:la,decryptJson:async(e,t)=>{const s=await da(e,t);return JSON.parse(s)},decryptString:da,getPasswordBasedEncryptionKey:async(e,t)=>await window.crypto.subtle.deriveKey(Wr.getParams("password-based-encryption",t),e,ta(),!1,Yr),generateAndEncryptKeyEncryptionKey:async e=>{const t=await aa(),s=await oa(t);return[t,await ca(e,s)]},RAW_KEY_TYPE:Xr,KEY_WILL_BE_USED_TO:Yr},fa=function(e){var t=Sa(e),s=t[0],n=t[1];return 3*(s+n)/4-n},pa=function(e){var t,s,n=Sa(e),r=n[0],a=n[1],i=new ya(function(e,t,s){return 3*(t+s)/4-s}(0,r,a)),o=0,c=a>0?r-4:r;for(s=0;s<c;s+=4)t=ga[e.charCodeAt(s)]<<18|ga[e.charCodeAt(s+1)]<<12|ga[e.charCodeAt(s+2)]<<6|ga[e.charCodeAt(s+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=255&t;2===a&&(t=ga[e.charCodeAt(s)]<<2|ga[e.charCodeAt(s+1)]>>4,i[o++]=255&t);1===a&&(t=ga[e.charCodeAt(s)]<<10|ga[e.charCodeAt(s+1)]<<4|ga[e.charCodeAt(s+2)]>>2,i[o++]=t>>8&255,i[o++]=255&t);return i},ma=function(e){for(var t,s=e.length,n=s%3,r=[],a=16383,i=0,o=s-n;i<o;i+=a)r.push(Ia(e,i,i+a>o?o:i+a));1===n?(t=e[s-1],r.push(wa[t>>2]+wa[t<<4&63]+"==")):2===n&&(t=(e[s-2]<<8)+e[s-1],r.push(wa[t>>10]+wa[t>>4&63]+wa[t<<2&63]+"="));return r.join("")},wa=[],ga=[],ya="undefined"!=typeof Uint8Array?Uint8Array:Array,ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",va=0,Ma=ba.length;va<Ma;++va)wa[va]=ba[va],ga[ba.charCodeAt(va)]=va;function Sa(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");return-1===s&&(s=t),[s,s===t?0:4-s%4]}function Ia(e,t,s){for(var n,r,a=[],i=t;i<s;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),a.push(wa[(r=n)>>18&63]+wa[r>>12&63]+wa[r>>6&63]+wa[63&r]);return a.join("")}ga["-".charCodeAt(0)]=62,ga["_".charCodeAt(0)]=63;var Ea,Aa={byteLength:fa,toByteArray:pa,fromByteArray:ma},Ba=function(e,t,s,n,r){var a,i,o=8*r-n-1,c=(1<<o)-1,u=c>>1,l=-7,d=s?r-1:0,h=s?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-l)-1,f>>=-l,l+=o;l>0;a=256*a+e[t+d],d+=h,l-=8);for(i=a&(1<<-l)-1,a>>=-l,l+=n;l>0;i=256*i+e[t+d],d+=h,l-=8);if(0===a)a=1-u;else{if(a===c)return i?NaN:1/0*(f?-1:1);i+=Math.pow(2,n),a-=u}return(f?-1:1)*i*Math.pow(2,a-n)},ka=function(e,t,s,n,r,a){var i,o,c,u=8*a-r-1,l=(1<<u)-1,d=l>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=l):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),(t+=i+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(i++,c/=2),i+d>=l?(o=0,i=l):i+d>=1?(o=(t*c-1)*Math.pow(2,r),i+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,r),i=0));r>=8;e[s+f]=255&o,f+=p,o/=256,r-=8);for(i=i<<r|o,u+=r;u>0;e[s+f]=255&i,f+=p,i/=256,u-=8);e[s+f-p]|=128*m},Pa=Xe((function(e,t){const s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},t.INSPECT_MAX_BYTES=50;const n=2147483647;function r(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,s){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return i(e,t,s)}function i(e,t,s){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const s=0|h(e,t);let n=r(s);const i=n.write(e,t);i!==s&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return l(e,t,s);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return l(e,t,s);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,s);const i=function(e){if(a.isBuffer(e)){const t=0|d(e.length),s=r(t);return 0===s.length||e.copy(s,0,0,t),s}if(void 0!==e.length)return"number"!=typeof e.length||J(e.length)?r(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return o(e),r(e<0?0:0|d(e))}function u(e){const t=e.length<0?0:0|d(e.length),s=r(t);for(let n=0;n<t;n+=1)s[n]=255&e[n];return s}function l(e,t,s){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(s||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===s?new Uint8Array(e):void 0===s?new Uint8Array(e,t):new Uint8Array(e,t,s),Object.setPrototypeOf(n,a.prototype),n}function d(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function h(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const s=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===s)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return _(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return H(e).length;default:if(r)return n?-1:_(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,s){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===s||s>this.length)&&(s=this.length),s<=0)return"";if((s>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,s);case"utf8":case"utf-8":return I(this,t,s);case"ascii":return A(this,t,s);case"latin1":case"binary":return B(this,t,s);case"base64":return S(this,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,s);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function p(e,t,s){const n=e[t];e[t]=e[s],e[s]=n}function m(e,t,s,n,r){if(0===e.length)return-1;if("string"==typeof s?(n=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),J(s=+s)&&(s=r?0:e.length-1),s<0&&(s=e.length+s),s>=e.length){if(r)return-1;s=e.length-1}else if(s<0){if(!r)return-1;s=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:w(e,t,s,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,s):Uint8Array.prototype.lastIndexOf.call(e,t,s):w(e,[t],s,n,r);throw new TypeError("val must be string, number or Buffer")}function w(e,t,s,n,r){let a,i=1,o=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;i=2,o/=2,c/=2,s/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(r){let n=-1;for(a=s;a<o;a++)if(u(e,a)===u(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===c)return n*i}else-1!==n&&(a-=a-n),n=-1}else for(s+c>o&&(s=o-c),a=s;a>=0;a--){let s=!0;for(let n=0;n<c;n++)if(u(e,a+n)!==u(t,n)){s=!1;break}if(s)return a}return-1}function g(e,t,s,n){s=Number(s)||0;const r=e.length-s;n?(n=Number(n))>r&&(n=r):n=r;const a=t.length;let i;for(n>a/2&&(n=a/2),i=0;i<n;++i){const n=parseInt(t.substr(2*i,2),16);if(J(n))return i;e[s+i]=n}return i}function y(e,t,s,n){return $(_(t,e.length-s),e,s,n)}function b(e,t,s,n){return $(function(e){const t=[];for(let s=0;s<e.length;++s)t.push(255&e.charCodeAt(s));return t}(t),e,s,n)}function v(e,t,s,n){return $(H(t),e,s,n)}function M(e,t,s,n){return $(function(e,t){let s,n,r;const a=[];for(let i=0;i<e.length&&!((t-=2)<0);++i)s=e.charCodeAt(i),n=s>>8,r=s%256,a.push(r),a.push(n);return a}(t,e.length-s),e,s,n)}function S(e,t,s){return 0===t&&s===e.length?Aa.fromByteArray(e):Aa.fromByteArray(e.slice(t,s))}function I(e,t,s){s=Math.min(e.length,s);const n=[];let r=t;for(;r<s;){const t=e[r];let a=null,i=t>239?4:t>223?3:t>191?2:1;if(r+i<=s){let s,n,o,c;switch(i){case 1:t<128&&(a=t);break;case 2:s=e[r+1],128==(192&s)&&(c=(31&t)<<6|63&s,c>127&&(a=c));break;case 3:s=e[r+1],n=e[r+2],128==(192&s)&&128==(192&n)&&(c=(15&t)<<12|(63&s)<<6|63&n,c>2047&&(c<55296||c>57343)&&(a=c));break;case 4:s=e[r+1],n=e[r+2],o=e[r+3],128==(192&s)&&128==(192&n)&&128==(192&o)&&(c=(15&t)<<18|(63&s)<<12|(63&n)<<6|63&o,c>65535&&c<1114112&&(a=c))}}null===a?(a=65533,i=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),r+=i}return function(e){const t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);let s="",n=0;for(;n<t;)s+=String.fromCharCode.apply(String,e.slice(n,n+=E));return s}(n)}t.kMaxLength=n,a.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,s){return i(e,t,s)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,s){return function(e,t,s){return o(e),e<=0?r(e):void 0!==t?"string"==typeof s?r(e).fill(t,s):r(e).fill(t):r(e)}(e,t,s)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(G(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let s=e.length,n=t.length;for(let r=0,a=Math.min(s,n);r<a;++r)if(e[r]!==t[r]){s=e[r],n=t[r];break}return s<n?-1:n<s?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);let s;if(void 0===t)for(t=0,s=0;s<e.length;++s)t+=e[s].length;const n=a.allocUnsafe(t);let r=0;for(s=0;s<e.length;++s){let t=e[s];if(G(t,Uint8Array))r+t.length>n.length?(a.isBuffer(t)||(t=a.from(t)),t.copy(n,r)):Uint8Array.prototype.set.call(n,t,r);else{if(!a.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,r)}r+=t.length}return n},a.byteLength=h,a.prototype._isBuffer=!0,a.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)p(this,t,t+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},a.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):f.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){let e="";const s=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(e+=" ... "),"<Buffer "+e+">"},s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=function(e,t,s,n,r){if(G(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===s&&(s=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||s>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=s)return 0;if(n>=r)return-1;if(t>=s)return 1;if(this===e)return 0;let i=(r>>>=0)-(n>>>=0),o=(s>>>=0)-(t>>>=0);const c=Math.min(i,o),u=this.slice(n,r),l=e.slice(t,s);for(let e=0;e<c;++e)if(u[e]!==l[e]){i=u[e],o=l[e];break}return i<o?-1:o<i?1:0},a.prototype.includes=function(e,t,s){return-1!==this.indexOf(e,t,s)},a.prototype.indexOf=function(e,t,s){return m(this,e,t,s,!0)},a.prototype.lastIndexOf=function(e,t,s){return m(this,e,t,s,!1)},a.prototype.write=function(e,t,s,n){if(void 0===t)n="utf8",s=this.length,t=0;else if(void 0===s&&"string"==typeof t)n=t,s=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(s)?(s>>>=0,void 0===n&&(n="utf8")):(n=s,s=void 0)}const r=this.length-t;if((void 0===s||s>r)&&(s=r),e.length>0&&(s<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return g(this,e,t,s);case"utf8":case"utf-8":return y(this,e,t,s);case"ascii":case"latin1":case"binary":return b(this,e,t,s);case"base64":return v(this,e,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,s);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const E=4096;function A(e,t,s){let n="";s=Math.min(e.length,s);for(let r=t;r<s;++r)n+=String.fromCharCode(127&e[r]);return n}function B(e,t,s){let n="";s=Math.min(e.length,s);for(let r=t;r<s;++r)n+=String.fromCharCode(e[r]);return n}function k(e,t,s){const n=e.length;(!t||t<0)&&(t=0),(!s||s<0||s>n)&&(s=n);let r="";for(let n=t;n<s;++n)r+=z[e[n]];return r}function P(e,t,s){const n=e.slice(t,s);let r="";for(let e=0;e<n.length-1;e+=2)r+=String.fromCharCode(n[e]+256*n[e+1]);return r}function x(e,t,s){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>s)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,s,n,r,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<i)throw new RangeError('"value" argument is out of bounds');if(s+n>e.length)throw new RangeError("Index out of range")}function N(e,t,s,n,r){L(t,n,r,e,s,7);let a=Number(t&BigInt(4294967295));e[s++]=a,a>>=8,e[s++]=a,a>>=8,e[s++]=a,a>>=8,e[s++]=a;let i=Number(t>>BigInt(32)&BigInt(4294967295));return e[s++]=i,i>>=8,e[s++]=i,i>>=8,e[s++]=i,i>>=8,e[s++]=i,s}function T(e,t,s,n,r){L(t,n,r,e,s,7);let a=Number(t&BigInt(4294967295));e[s+7]=a,a>>=8,e[s+6]=a,a>>=8,e[s+5]=a,a>>=8,e[s+4]=a;let i=Number(t>>BigInt(32)&BigInt(4294967295));return e[s+3]=i,i>>=8,e[s+2]=i,i>>=8,e[s+1]=i,i>>=8,e[s]=i,s+8}function D(e,t,s,n,r,a){if(s+n>e.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function K(e,t,s,n,r){return t=+t,s>>>=0,r||D(e,0,s,4),ka(e,t,s,n,23,4),s+4}function O(e,t,s,n,r){return t=+t,s>>>=0,r||D(e,0,s,8),ka(e,t,s,n,52,8),s+8}a.prototype.slice=function(e,t){const s=this.length;(e=~~e)<0?(e+=s)<0&&(e=0):e>s&&(e=s),(t=void 0===t?s:~~t)<0?(t+=s)<0&&(t=0):t>s&&(t=s),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,s){e>>>=0,t>>>=0,s||x(e,t,this.length);let n=this[e],r=1,a=0;for(;++a<t&&(r*=256);)n+=this[e+a]*r;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,s){e>>>=0,t>>>=0,s||x(e,t,this.length);let n=this[e+--t],r=1;for(;t>0&&(r*=256);)n+=this[e+--t]*r;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=W((function(e){q(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||j(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+s*2**24;return BigInt(n)+(BigInt(r)<<BigInt(32))})),a.prototype.readBigUInt64BE=W((function(e){q(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||j(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+s;return(BigInt(n)<<BigInt(32))+BigInt(r)})),a.prototype.readIntLE=function(e,t,s){e>>>=0,t>>>=0,s||x(e,t,this.length);let n=this[e],r=1,a=0;for(;++a<t&&(r*=256);)n+=this[e+a]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,s){e>>>=0,t>>>=0,s||x(e,t,this.length);let n=t,r=1,a=this[e+--n];for(;n>0&&(r*=256);)a+=this[e+--n]*r;return r*=128,a>=r&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);const s=this[e]|this[e+1]<<8;return 32768&s?4294901760|s:s},a.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);const s=this[e+1]|this[e]<<8;return 32768&s?4294901760|s:s},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=W((function(e){q(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||j(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(s<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),a.prototype.readBigInt64BE=W((function(e){q(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||j(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+s)})),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),Ba(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),Ba(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),Ba(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),Ba(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,s,n){if(e=+e,t>>>=0,s>>>=0,!n){U(this,e,t,s,Math.pow(2,8*s)-1,0)}let r=1,a=0;for(this[t]=255&e;++a<s&&(r*=256);)this[t+a]=e/r&255;return t+s},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,s,n){if(e=+e,t>>>=0,s>>>=0,!n){U(this,e,t,s,Math.pow(2,8*s)-1,0)}let r=s-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+s},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=W((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=W((function(e,t=0){return T(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(e,t,s,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*s-1);U(this,e,t,s,n-1,-n)}let r=0,a=1,i=0;for(this[t]=255&e;++r<s&&(a*=256);)e<0&&0===i&&0!==this[t+r-1]&&(i=1),this[t+r]=(e/a>>0)-i&255;return t+s},a.prototype.writeIntBE=function(e,t,s,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*s-1);U(this,e,t,s,n-1,-n)}let r=s-1,a=1,i=0;for(this[t+r]=255&e;--r>=0&&(a*=256);)e<0&&0===i&&0!==this[t+r+1]&&(i=1),this[t+r]=(e/a>>0)-i&255;return t+s},a.prototype.writeInt8=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,s){return e=+e,t>>>=0,s||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=W((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=W((function(e,t=0){return T(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(e,t,s){return K(this,e,t,!0,s)},a.prototype.writeFloatBE=function(e,t,s){return K(this,e,t,!1,s)},a.prototype.writeDoubleLE=function(e,t,s){return O(this,e,t,!0,s)},a.prototype.writeDoubleBE=function(e,t,s){return O(this,e,t,!1,s)},a.prototype.copy=function(e,t,s,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(s||(s=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<s&&(n=s),n===s)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-s&&(n=e.length-t+s);const r=n-s;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,s,n):Uint8Array.prototype.set.call(e,this.subarray(s,n),t),r},a.prototype.fill=function(e,t,s,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,s=this.length):"string"==typeof s&&(n=s,s=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<s)throw new RangeError("Out of range index");if(s<=t)return this;let r;if(t>>>=0,s=void 0===s?this.length:s>>>0,e||(e=0),"number"==typeof e)for(r=t;r<s;++r)this[r]=e;else{const i=a.isBuffer(e)?e:a.from(e,n),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<s-t;++r)this[r+t]=i[r%o]}return this};const R={};function C(e,t,s){R[e]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",s=e.length;const n="-"===e[0]?1:0;for(;s>=n+4;s-=3)t=`_${e.slice(s-3,s)}${t}`;return`${e.slice(0,s)}${t}`}function L(e,t,s,n,r,a){if(e>s||e<t){const n="bigint"==typeof t?"n":"";let r;throw r=a>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`:`>= ${t}${n} and <= ${s}${n}`,new R.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,s){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+s]||j(t,e.length-(s+1))}(n,r,a)}function q(e,t){if("number"!=typeof e)throw new R.ERR_INVALID_ARG_TYPE(t,"number",e)}function j(e,t,s){if(Math.floor(e)!==e)throw q(e,s),new R.ERR_OUT_OF_RANGE(s||"offset","an integer",e);if(t<0)throw new R.ERR_BUFFER_OUT_OF_BOUNDS;throw new R.ERR_OUT_OF_RANGE(s||"offset",`>= ${s?1:0} and <= ${t}`,e)}C("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),C("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),C("ERR_OUT_OF_RANGE",(function(e,t,s){let n=`The value of "${e}" is out of range.`,r=s;return Number.isInteger(s)&&Math.abs(s)>2**32?r=F(String(s)):"bigint"==typeof s&&(r=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(r=F(r)),r+="n"),n+=` It must be ${t}. Received ${r}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function _(e,t){let s;t=t||1/0;const n=e.length;let r=null;const a=[];for(let i=0;i<n;++i){if(s=e.charCodeAt(i),s>55295&&s<57344){if(!r){if(s>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(i+1===n){(t-=3)>-1&&a.push(239,191,189);continue}r=s;continue}if(s<56320){(t-=3)>-1&&a.push(239,191,189),r=s;continue}s=65536+(r-55296<<10|s-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,s<128){if((t-=1)<0)break;a.push(s)}else if(s<2048){if((t-=2)<0)break;a.push(s>>6|192,63&s|128)}else if(s<65536){if((t-=3)<0)break;a.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return a}function H(e){return Aa.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,s,n){let r;for(r=0;r<n&&!(r+s>=t.length||r>=e.length);++r)t[r+s]=e[r];return r}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const z=function(){const e="0123456789abcdef",t=new Array(256);for(let s=0;s<16;++s){const n=16*s;for(let r=0;r<16;++r)t[n+r]=e[s]+e[r]}return t}();function W(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}})),xa=Xe((function(e,t){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var s=Pa.Buffer;function n(e,t){for(var s in e)t[s]=e[s]}function r(e,t,n){return s(e,t,n)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=Pa:(n(Pa,t),t.Buffer=r),r.prototype=Object.create(s.prototype),n(s,r),r.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,n)},r.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=s(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},r.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},r.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Pa.SlowBuffer(e)}})),Ua=Xe((function(e){var t=65536,s=4294967295;var n=xa.Buffer,r=Ye.crypto||Ye.msCrypto;r&&r.getRandomValues?e.exports=function(e,a){if(e>s)throw new RangeError("requested too many random bytes");var i=n.allocUnsafe(e);if(e>0)if(e>t)for(var o=0;o<e;o+=t)r.getRandomValues(i.slice(o,o+t));else r.getRandomValues(i);if("function"==typeof a)return process.nextTick((function(){a(null,i)}));return i}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}})),Na=et(Object.freeze({__proto__:null,default:{}})),Ta=Xe((function(e){!function(e,t){function s(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}function r(e,t,s){if(r.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(s=t,t=10),this._init(e||0,t||10,s||"be"))}var a;"object"==typeof e?e.exports=r:t.BN=r,r.BN=r,r.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:Na.Buffer}catch(e){}function i(e,t){var s=e.charCodeAt(t);return s>=65&&s<=70?s-55:s>=97&&s<=102?s-87:s-48&15}function o(e,t,s){var n=i(e,s);return s-1>=t&&(n|=i(e,s-1)<<4),n}function c(e,t,s,n){for(var r=0,a=Math.min(e.length,s),i=t;i<a;i++){var o=e.charCodeAt(i)-48;r*=n,r+=o>=49?o-49+10:o>=17?o-17+10:o}return r}r.isBN=function(e){return e instanceof r||null!==e&&"object"==typeof e&&e.constructor.wordSize===r.wordSize&&Array.isArray(e.words)},r.max=function(e,t){return e.cmp(t)>0?e:t},r.min=function(e,t){return e.cmp(t)<0?e:t},r.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),s(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,n):(this._parseBase(e,t,r),"le"===n&&this._initArray(this.toArray(),t,n)))},r.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(s(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},r.prototype._initArray=function(e,t,n){if(s("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var a,i,o=0;if("be"===n)for(r=e.length-1,a=0;r>=0;r-=3)i=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[a]|=i<<o&67108863,this.words[a+1]=i>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===n)for(r=0,a=0;r<e.length;r+=3)i=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[a]|=i<<o&67108863,this.words[a+1]=i>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},r.prototype._parseHex=function(e,t,s){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,a=0,i=0;if("be"===s)for(n=e.length-1;n>=t;n-=2)r=o(e,t,n)<<a,this.words[i]|=67108863&r,a>=18?(a-=18,i+=1,this.words[i]|=r>>>26):a+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)r=o(e,t,n)<<a,this.words[i]|=67108863&r,a>=18?(a-=18,i+=1,this.words[i]|=r>>>26):a+=8;this.strip()},r.prototype._parseBase=function(e,t,s){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var a=e.length-s,i=a%n,o=Math.min(a,a-i)+s,u=0,l=s;l<o;l+=n)u=c(e,l,l+n,t),this.imuln(r),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==i){var d=1;for(u=c(e,l,e.length,t),l=0;l<i;l++)d*=t;this.imuln(d),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},r.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},r.prototype.clone=function(){var e=new r(null);return this.copy(e),e},r.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},r.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function h(e,t,s){s.negative=t.negative^e.negative;var n=e.length+t.length|0;s.length=n,n=n-1|0;var r=0|e.words[0],a=0|t.words[0],i=r*a,o=67108863&i,c=i/67108864|0;s.words[0]=o;for(var u=1;u<n;u++){for(var l=c>>>26,d=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;l+=(i=(r=0|e.words[p])*(a=0|t.words[f])+d)/67108864|0,d=67108863&i}s.words[u]=0|d,c=0|l}return 0!==c?s.words[u]=0|c:s.length--,s.strip()}r.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var r=0,a=0,i=0;i<this.length;i++){var o=this.words[i],c=(16777215&(o<<r|a)).toString(16);n=0!==(a=o>>>24-r&16777215)||i!==this.length-1?u[6-c.length]+c+n:c+n,(r+=2)>=26&&(r-=26,i--)}for(0!==a&&(n=a.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var h=l[e],f=d[e];n="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);n=(p=p.idivn(f)).isZero()?m+n:u[h-m.length]+m+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}s(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&s(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(e,t){return s(void 0!==a),this.toArrayLike(a,e,t)},r.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},r.prototype.toArrayLike=function(e,t,n){var r=this.byteLength(),a=n||Math.max(1,r);s(r<=a,"byte array longer than desired length"),s(a>0,"Requested array length <= 0"),this.strip();var i,o,c="le"===t,u=new e(a),l=this.clone();if(c){for(o=0;!l.isZero();o++)i=l.andln(255),l.iushrn(8),u[o]=i;for(;o<a;o++)u[o]=0}else{for(o=0;o<a-r;o++)u[o]=0;for(o=0;!l.isZero();o++)i=l.andln(255),l.iushrn(8),u[a-o-1]=i}return u},Math.clz32?r.prototype._countBits=function(e){return 32-Math.clz32(e)}:r.prototype._countBits=function(e){var t=e,s=0;return t>=4096&&(s+=13,t>>>=13),t>=64&&(s+=7,t>>>=7),t>=8&&(s+=4,t>>>=4),t>=2&&(s+=2,t>>>=2),s+t},r.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,s=0;return 0==(8191&t)&&(s+=13,t>>>=13),0==(127&t)&&(s+=7,t>>>=7),0==(15&t)&&(s+=4,t>>>=4),0==(3&t)&&(s+=2,t>>>=2),0==(1&t)&&s++,s},r.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var s=this._zeroBits(this.words[t]);if(e+=s,26!==s)break}return e},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},r.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},r.prototype.ior=function(e){return s(0==(this.negative|e.negative)),this.iuor(e)},r.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},r.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},r.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var s=0;s<t.length;s++)this.words[s]=this.words[s]&e.words[s];return this.length=t.length,this.strip()},r.prototype.iand=function(e){return s(0==(this.negative|e.negative)),this.iuand(e)},r.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},r.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},r.prototype.iuxor=function(e){var t,s;this.length>e.length?(t=this,s=e):(t=e,s=this);for(var n=0;n<s.length;n++)this.words[n]=t.words[n]^s.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},r.prototype.ixor=function(e){return s(0==(this.negative|e.negative)),this.iuxor(e)},r.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},r.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},r.prototype.inotn=function(e){s("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return n>0&&(this.words[r]=~this.words[r]&67108863>>26-n),this.strip()},r.prototype.notn=function(e){return this.clone().inotn(e)},r.prototype.setn=function(e,t){s("number"==typeof e&&e>=0);var n=e/26|0,r=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<r:this.words[n]&~(1<<r),this.strip()},r.prototype.iadd=function(e){var t,s,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(s=this,n=e):(s=e,n=this);for(var r=0,a=0;a<n.length;a++)t=(0|s.words[a])+(0|n.words[a])+r,this.words[a]=67108863&t,r=t>>>26;for(;0!==r&&a<s.length;a++)t=(0|s.words[a])+r,this.words[a]=67108863&t,r=t>>>26;if(this.length=s.length,0!==r)this.words[this.length]=r,this.length++;else if(s!==this)for(;a<s.length;a++)this.words[a]=s.words[a];return this},r.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},r.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(s=this,n=e):(s=e,n=this);for(var a=0,i=0;i<n.length;i++)a=(t=(0|s.words[i])-(0|n.words[i])+a)>>26,this.words[i]=67108863&t;for(;0!==a&&i<s.length;i++)a=(t=(0|s.words[i])+a)>>26,this.words[i]=67108863&t;if(0===a&&i<s.length&&s!==this)for(;i<s.length;i++)this.words[i]=s.words[i];return this.length=Math.max(this.length,i),s!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,s){var n,r,a,i=e.words,o=t.words,c=s.words,u=0,l=0|i[0],d=8191&l,h=l>>>13,f=0|i[1],p=8191&f,m=f>>>13,w=0|i[2],g=8191&w,y=w>>>13,b=0|i[3],v=8191&b,M=b>>>13,S=0|i[4],I=8191&S,E=S>>>13,A=0|i[5],B=8191&A,k=A>>>13,P=0|i[6],x=8191&P,U=P>>>13,N=0|i[7],T=8191&N,D=N>>>13,K=0|i[8],O=8191&K,R=K>>>13,C=0|i[9],F=8191&C,L=C>>>13,q=0|o[0],j=8191&q,V=q>>>13,_=0|o[1],H=8191&_,$=_>>>13,G=0|o[2],J=8191&G,z=G>>>13,W=0|o[3],Q=8191&W,Z=W>>>13,Y=0|o[4],X=8191&Y,ee=Y>>>13,te=0|o[5],se=8191&te,ne=te>>>13,re=0|o[6],ae=8191&re,ie=re>>>13,oe=0|o[7],ce=8191&oe,ue=oe>>>13,le=0|o[8],de=8191&le,he=le>>>13,fe=0|o[9],pe=8191&fe,me=fe>>>13;s.negative=e.negative^t.negative,s.length=19;var we=(u+(n=Math.imul(d,j))|0)+((8191&(r=(r=Math.imul(d,V))+Math.imul(h,j)|0))<<13)|0;u=((a=Math.imul(h,V))+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(p,j),r=(r=Math.imul(p,V))+Math.imul(m,j)|0,a=Math.imul(m,V);var ge=(u+(n=n+Math.imul(d,H)|0)|0)+((8191&(r=(r=r+Math.imul(d,$)|0)+Math.imul(h,H)|0))<<13)|0;u=((a=a+Math.imul(h,$)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,j),r=(r=Math.imul(g,V))+Math.imul(y,j)|0,a=Math.imul(y,V),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,$)|0)+Math.imul(m,H)|0,a=a+Math.imul(m,$)|0;var ye=(u+(n=n+Math.imul(d,J)|0)|0)+((8191&(r=(r=r+Math.imul(d,z)|0)+Math.imul(h,J)|0))<<13)|0;u=((a=a+Math.imul(h,z)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(v,j),r=(r=Math.imul(v,V))+Math.imul(M,j)|0,a=Math.imul(M,V),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,$)|0)+Math.imul(y,H)|0,a=a+Math.imul(y,$)|0,n=n+Math.imul(p,J)|0,r=(r=r+Math.imul(p,z)|0)+Math.imul(m,J)|0,a=a+Math.imul(m,z)|0;var be=(u+(n=n+Math.imul(d,Q)|0)|0)+((8191&(r=(r=r+Math.imul(d,Z)|0)+Math.imul(h,Q)|0))<<13)|0;u=((a=a+Math.imul(h,Z)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(I,j),r=(r=Math.imul(I,V))+Math.imul(E,j)|0,a=Math.imul(E,V),n=n+Math.imul(v,H)|0,r=(r=r+Math.imul(v,$)|0)+Math.imul(M,H)|0,a=a+Math.imul(M,$)|0,n=n+Math.imul(g,J)|0,r=(r=r+Math.imul(g,z)|0)+Math.imul(y,J)|0,a=a+Math.imul(y,z)|0,n=n+Math.imul(p,Q)|0,r=(r=r+Math.imul(p,Z)|0)+Math.imul(m,Q)|0,a=a+Math.imul(m,Z)|0;var ve=(u+(n=n+Math.imul(d,X)|0)|0)+((8191&(r=(r=r+Math.imul(d,ee)|0)+Math.imul(h,X)|0))<<13)|0;u=((a=a+Math.imul(h,ee)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(B,j),r=(r=Math.imul(B,V))+Math.imul(k,j)|0,a=Math.imul(k,V),n=n+Math.imul(I,H)|0,r=(r=r+Math.imul(I,$)|0)+Math.imul(E,H)|0,a=a+Math.imul(E,$)|0,n=n+Math.imul(v,J)|0,r=(r=r+Math.imul(v,z)|0)+Math.imul(M,J)|0,a=a+Math.imul(M,z)|0,n=n+Math.imul(g,Q)|0,r=(r=r+Math.imul(g,Z)|0)+Math.imul(y,Q)|0,a=a+Math.imul(y,Z)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,X)|0,a=a+Math.imul(m,ee)|0;var Me=(u+(n=n+Math.imul(d,se)|0)|0)+((8191&(r=(r=r+Math.imul(d,ne)|0)+Math.imul(h,se)|0))<<13)|0;u=((a=a+Math.imul(h,ne)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(x,j),r=(r=Math.imul(x,V))+Math.imul(U,j)|0,a=Math.imul(U,V),n=n+Math.imul(B,H)|0,r=(r=r+Math.imul(B,$)|0)+Math.imul(k,H)|0,a=a+Math.imul(k,$)|0,n=n+Math.imul(I,J)|0,r=(r=r+Math.imul(I,z)|0)+Math.imul(E,J)|0,a=a+Math.imul(E,z)|0,n=n+Math.imul(v,Q)|0,r=(r=r+Math.imul(v,Z)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,Z)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(y,X)|0,a=a+Math.imul(y,ee)|0,n=n+Math.imul(p,se)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,se)|0,a=a+Math.imul(m,ne)|0;var Se=(u+(n=n+Math.imul(d,ae)|0)|0)+((8191&(r=(r=r+Math.imul(d,ie)|0)+Math.imul(h,ae)|0))<<13)|0;u=((a=a+Math.imul(h,ie)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(T,j),r=(r=Math.imul(T,V))+Math.imul(D,j)|0,a=Math.imul(D,V),n=n+Math.imul(x,H)|0,r=(r=r+Math.imul(x,$)|0)+Math.imul(U,H)|0,a=a+Math.imul(U,$)|0,n=n+Math.imul(B,J)|0,r=(r=r+Math.imul(B,z)|0)+Math.imul(k,J)|0,a=a+Math.imul(k,z)|0,n=n+Math.imul(I,Q)|0,r=(r=r+Math.imul(I,Z)|0)+Math.imul(E,Q)|0,a=a+Math.imul(E,Z)|0,n=n+Math.imul(v,X)|0,r=(r=r+Math.imul(v,ee)|0)+Math.imul(M,X)|0,a=a+Math.imul(M,ee)|0,n=n+Math.imul(g,se)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(y,se)|0,a=a+Math.imul(y,ne)|0,n=n+Math.imul(p,ae)|0,r=(r=r+Math.imul(p,ie)|0)+Math.imul(m,ae)|0,a=a+Math.imul(m,ie)|0;var Ie=(u+(n=n+Math.imul(d,ce)|0)|0)+((8191&(r=(r=r+Math.imul(d,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((a=a+Math.imul(h,ue)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(O,j),r=(r=Math.imul(O,V))+Math.imul(R,j)|0,a=Math.imul(R,V),n=n+Math.imul(T,H)|0,r=(r=r+Math.imul(T,$)|0)+Math.imul(D,H)|0,a=a+Math.imul(D,$)|0,n=n+Math.imul(x,J)|0,r=(r=r+Math.imul(x,z)|0)+Math.imul(U,J)|0,a=a+Math.imul(U,z)|0,n=n+Math.imul(B,Q)|0,r=(r=r+Math.imul(B,Z)|0)+Math.imul(k,Q)|0,a=a+Math.imul(k,Z)|0,n=n+Math.imul(I,X)|0,r=(r=r+Math.imul(I,ee)|0)+Math.imul(E,X)|0,a=a+Math.imul(E,ee)|0,n=n+Math.imul(v,se)|0,r=(r=r+Math.imul(v,ne)|0)+Math.imul(M,se)|0,a=a+Math.imul(M,ne)|0,n=n+Math.imul(g,ae)|0,r=(r=r+Math.imul(g,ie)|0)+Math.imul(y,ae)|0,a=a+Math.imul(y,ie)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,a=a+Math.imul(m,ue)|0;var Ee=(u+(n=n+Math.imul(d,de)|0)|0)+((8191&(r=(r=r+Math.imul(d,he)|0)+Math.imul(h,de)|0))<<13)|0;u=((a=a+Math.imul(h,he)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(F,j),r=(r=Math.imul(F,V))+Math.imul(L,j)|0,a=Math.imul(L,V),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,$)|0)+Math.imul(R,H)|0,a=a+Math.imul(R,$)|0,n=n+Math.imul(T,J)|0,r=(r=r+Math.imul(T,z)|0)+Math.imul(D,J)|0,a=a+Math.imul(D,z)|0,n=n+Math.imul(x,Q)|0,r=(r=r+Math.imul(x,Z)|0)+Math.imul(U,Q)|0,a=a+Math.imul(U,Z)|0,n=n+Math.imul(B,X)|0,r=(r=r+Math.imul(B,ee)|0)+Math.imul(k,X)|0,a=a+Math.imul(k,ee)|0,n=n+Math.imul(I,se)|0,r=(r=r+Math.imul(I,ne)|0)+Math.imul(E,se)|0,a=a+Math.imul(E,ne)|0,n=n+Math.imul(v,ae)|0,r=(r=r+Math.imul(v,ie)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,ie)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(y,ce)|0,a=a+Math.imul(y,ue)|0,n=n+Math.imul(p,de)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,de)|0,a=a+Math.imul(m,he)|0;var Ae=(u+(n=n+Math.imul(d,pe)|0)|0)+((8191&(r=(r=r+Math.imul(d,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((a=a+Math.imul(h,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(F,H),r=(r=Math.imul(F,$))+Math.imul(L,H)|0,a=Math.imul(L,$),n=n+Math.imul(O,J)|0,r=(r=r+Math.imul(O,z)|0)+Math.imul(R,J)|0,a=a+Math.imul(R,z)|0,n=n+Math.imul(T,Q)|0,r=(r=r+Math.imul(T,Z)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,Z)|0,n=n+Math.imul(x,X)|0,r=(r=r+Math.imul(x,ee)|0)+Math.imul(U,X)|0,a=a+Math.imul(U,ee)|0,n=n+Math.imul(B,se)|0,r=(r=r+Math.imul(B,ne)|0)+Math.imul(k,se)|0,a=a+Math.imul(k,ne)|0,n=n+Math.imul(I,ae)|0,r=(r=r+Math.imul(I,ie)|0)+Math.imul(E,ae)|0,a=a+Math.imul(E,ie)|0,n=n+Math.imul(v,ce)|0,r=(r=r+Math.imul(v,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0,n=n+Math.imul(g,de)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(y,de)|0,a=a+Math.imul(y,he)|0;var Be=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((a=a+Math.imul(m,me)|0)+(r>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(F,J),r=(r=Math.imul(F,z))+Math.imul(L,J)|0,a=Math.imul(L,z),n=n+Math.imul(O,Q)|0,r=(r=r+Math.imul(O,Z)|0)+Math.imul(R,Q)|0,a=a+Math.imul(R,Z)|0,n=n+Math.imul(T,X)|0,r=(r=r+Math.imul(T,ee)|0)+Math.imul(D,X)|0,a=a+Math.imul(D,ee)|0,n=n+Math.imul(x,se)|0,r=(r=r+Math.imul(x,ne)|0)+Math.imul(U,se)|0,a=a+Math.imul(U,ne)|0,n=n+Math.imul(B,ae)|0,r=(r=r+Math.imul(B,ie)|0)+Math.imul(k,ae)|0,a=a+Math.imul(k,ie)|0,n=n+Math.imul(I,ce)|0,r=(r=r+Math.imul(I,ue)|0)+Math.imul(E,ce)|0,a=a+Math.imul(E,ue)|0,n=n+Math.imul(v,de)|0,r=(r=r+Math.imul(v,he)|0)+Math.imul(M,de)|0,a=a+Math.imul(M,he)|0;var ke=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((a=a+Math.imul(y,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(F,Q),r=(r=Math.imul(F,Z))+Math.imul(L,Q)|0,a=Math.imul(L,Z),n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(R,X)|0,a=a+Math.imul(R,ee)|0,n=n+Math.imul(T,se)|0,r=(r=r+Math.imul(T,ne)|0)+Math.imul(D,se)|0,a=a+Math.imul(D,ne)|0,n=n+Math.imul(x,ae)|0,r=(r=r+Math.imul(x,ie)|0)+Math.imul(U,ae)|0,a=a+Math.imul(U,ie)|0,n=n+Math.imul(B,ce)|0,r=(r=r+Math.imul(B,ue)|0)+Math.imul(k,ce)|0,a=a+Math.imul(k,ue)|0,n=n+Math.imul(I,de)|0,r=(r=r+Math.imul(I,he)|0)+Math.imul(E,de)|0,a=a+Math.imul(E,he)|0;var Pe=(u+(n=n+Math.imul(v,pe)|0)|0)+((8191&(r=(r=r+Math.imul(v,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((a=a+Math.imul(M,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(F,X),r=(r=Math.imul(F,ee))+Math.imul(L,X)|0,a=Math.imul(L,ee),n=n+Math.imul(O,se)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(R,se)|0,a=a+Math.imul(R,ne)|0,n=n+Math.imul(T,ae)|0,r=(r=r+Math.imul(T,ie)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,ie)|0,n=n+Math.imul(x,ce)|0,r=(r=r+Math.imul(x,ue)|0)+Math.imul(U,ce)|0,a=a+Math.imul(U,ue)|0,n=n+Math.imul(B,de)|0,r=(r=r+Math.imul(B,he)|0)+Math.imul(k,de)|0,a=a+Math.imul(k,he)|0;var xe=(u+(n=n+Math.imul(I,pe)|0)|0)+((8191&(r=(r=r+Math.imul(I,me)|0)+Math.imul(E,pe)|0))<<13)|0;u=((a=a+Math.imul(E,me)|0)+(r>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(F,se),r=(r=Math.imul(F,ne))+Math.imul(L,se)|0,a=Math.imul(L,ne),n=n+Math.imul(O,ae)|0,r=(r=r+Math.imul(O,ie)|0)+Math.imul(R,ae)|0,a=a+Math.imul(R,ie)|0,n=n+Math.imul(T,ce)|0,r=(r=r+Math.imul(T,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0,n=n+Math.imul(x,de)|0,r=(r=r+Math.imul(x,he)|0)+Math.imul(U,de)|0,a=a+Math.imul(U,he)|0;var Ue=(u+(n=n+Math.imul(B,pe)|0)|0)+((8191&(r=(r=r+Math.imul(B,me)|0)+Math.imul(k,pe)|0))<<13)|0;u=((a=a+Math.imul(k,me)|0)+(r>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,n=Math.imul(F,ae),r=(r=Math.imul(F,ie))+Math.imul(L,ae)|0,a=Math.imul(L,ie),n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(R,ce)|0,a=a+Math.imul(R,ue)|0,n=n+Math.imul(T,de)|0,r=(r=r+Math.imul(T,he)|0)+Math.imul(D,de)|0,a=a+Math.imul(D,he)|0;var Ne=(u+(n=n+Math.imul(x,pe)|0)|0)+((8191&(r=(r=r+Math.imul(x,me)|0)+Math.imul(U,pe)|0))<<13)|0;u=((a=a+Math.imul(U,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(F,ce),r=(r=Math.imul(F,ue))+Math.imul(L,ce)|0,a=Math.imul(L,ue),n=n+Math.imul(O,de)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(R,de)|0,a=a+Math.imul(R,he)|0;var Te=(u+(n=n+Math.imul(T,pe)|0)|0)+((8191&(r=(r=r+Math.imul(T,me)|0)+Math.imul(D,pe)|0))<<13)|0;u=((a=a+Math.imul(D,me)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(F,de),r=(r=Math.imul(F,he))+Math.imul(L,de)|0,a=Math.imul(L,he);var De=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(R,pe)|0))<<13)|0;u=((a=a+Math.imul(R,me)|0)+(r>>>13)|0)+(De>>>26)|0,De&=67108863;var Ke=(u+(n=Math.imul(F,pe))|0)+((8191&(r=(r=Math.imul(F,me))+Math.imul(L,pe)|0))<<13)|0;return u=((a=Math.imul(L,me))+(r>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,c[0]=we,c[1]=ge,c[2]=ye,c[3]=be,c[4]=ve,c[5]=Me,c[6]=Se,c[7]=Ie,c[8]=Ee,c[9]=Ae,c[10]=Be,c[11]=ke,c[12]=Pe,c[13]=xe,c[14]=Ue,c[15]=Ne,c[16]=Te,c[17]=De,c[18]=Ke,0!==u&&(c[19]=u,s.length++),s};function p(e,t,s){return(new m).mulp(e,t,s)}function m(e,t){this.x=e,this.y=t}Math.imul||(f=h),r.prototype.mulTo=function(e,t){var s=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):s<63?h(this,e,t):s<1024?function(e,t,s){s.negative=t.negative^e.negative,s.length=e.length+t.length;for(var n=0,r=0,a=0;a<s.length-1;a++){var i=r;r=0;for(var o=67108863&n,c=Math.min(a,t.length-1),u=Math.max(0,a-e.length+1);u<=c;u++){var l=a-u,d=(0|e.words[l])*(0|t.words[u]),h=67108863&d;o=67108863&(h=h+o|0),r+=(i=(i=i+(d/67108864|0)|0)+(h>>>26)|0)>>>26,i&=67108863}s.words[a]=o,n=i,i=r}return 0!==n?s.words[a]=n:s.length--,s.strip()}(this,e,t):p(this,e,t)},m.prototype.makeRBT=function(e){for(var t=new Array(e),s=r.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,s,e);return t},m.prototype.revBin=function(e,t,s){if(0===e||e===s-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},m.prototype.permute=function(e,t,s,n,r,a){for(var i=0;i<a;i++)n[i]=t[e[i]],r[i]=s[e[i]]},m.prototype.transform=function(e,t,s,n,r,a){this.permute(a,e,t,s,n,r);for(var i=1;i<r;i<<=1)for(var o=i<<1,c=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),l=0;l<r;l+=o)for(var d=c,h=u,f=0;f<i;f++){var p=s[l+f],m=n[l+f],w=s[l+f+i],g=n[l+f+i],y=d*w-h*g;g=d*g+h*w,w=y,s[l+f]=p+w,n[l+f]=m+g,s[l+f+i]=p-w,n[l+f+i]=m-g,f!==o&&(y=c*d-u*h,h=c*h+u*d,d=y)}},m.prototype.guessLen13b=function(e,t){var s=1|Math.max(t,e),n=1&s,r=0;for(s=s/2|0;s;s>>>=1)r++;return 1<<r+1+n},m.prototype.conjugate=function(e,t,s){if(!(s<=1))for(var n=0;n<s/2;n++){var r=e[n];e[n]=e[s-n-1],e[s-n-1]=r,r=t[n],t[n]=-t[s-n-1],t[s-n-1]=-r}},m.prototype.normalize13b=function(e,t){for(var s=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+s;e[n]=67108863&r,s=r<67108864?0:r/67108864|0}return e},m.prototype.convert13b=function(e,t,n,r){for(var a=0,i=0;i<t;i++)a+=0|e[i],n[2*i]=8191&a,a>>>=13,n[2*i+1]=8191&a,a>>>=13;for(i=2*t;i<r;++i)n[i]=0;s(0===a),s(0==(-8192&a))},m.prototype.stub=function(e){for(var t=new Array(e),s=0;s<e;s++)t[s]=0;return t},m.prototype.mulp=function(e,t,s){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),a=this.stub(n),i=new Array(n),o=new Array(n),c=new Array(n),u=new Array(n),l=new Array(n),d=new Array(n),h=s.words;h.length=n,this.convert13b(e.words,e.length,i,n),this.convert13b(t.words,t.length,u,n),this.transform(i,a,o,c,n,r),this.transform(u,a,l,d,n,r);for(var f=0;f<n;f++){var p=o[f]*l[f]-c[f]*d[f];c[f]=o[f]*d[f]+c[f]*l[f],o[f]=p}return this.conjugate(o,c,n),this.transform(o,c,h,a,n,r),this.conjugate(h,a,n),this.normalize13b(h,n),s.negative=e.negative^t.negative,s.length=e.length+t.length,s.strip()},r.prototype.mul=function(e){var t=new r(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},r.prototype.mulf=function(e){var t=new r(null);return t.words=new Array(this.length+e.length),p(this,e,t)},r.prototype.imul=function(e){return this.clone().mulTo(e,this)},r.prototype.imuln=function(e){s("number"==typeof e),s(e<67108864);for(var t=0,n=0;n<this.length;n++){var r=(0|this.words[n])*e,a=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=a>>>26,this.words[n]=67108863&a}return 0!==t&&(this.words[n]=t,this.length++),this},r.prototype.muln=function(e){return this.clone().imuln(e)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),s=0;s<t.length;s++){var n=s/26|0,r=s%26;t[s]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new r(1);for(var s=this,n=0;n<t.length&&0===t[n];n++,s=s.sqr());if(++n<t.length)for(var a=s.sqr();n<t.length;n++,a=a.sqr())0!==t[n]&&(s=s.mul(a));return s},r.prototype.iushln=function(e){s("number"==typeof e&&e>=0);var t,n=e%26,r=(e-n)/26,a=67108863>>>26-n<<26-n;if(0!==n){var i=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,c=(0|this.words[t])-o<<n;this.words[t]=c|i,i=o>>>26-n}i&&(this.words[t]=i,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},r.prototype.ishln=function(e){return s(0===this.negative),this.iushln(e)},r.prototype.iushrn=function(e,t,n){var r;s("number"==typeof e&&e>=0),r=t?(t-t%26)/26:0;var a=e%26,i=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,c=n;if(r-=i,r=Math.max(0,r),c){for(var u=0;u<i;u++)c.words[u]=this.words[u];c.length=i}if(0===i);else if(this.length>i)for(this.length-=i,u=0;u<this.length;u++)this.words[u]=this.words[u+i];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=r);u--){var d=0|this.words[u];this.words[u]=l<<26-a|d>>>a,l=d&o}return c&&0!==l&&(c.words[c.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(e,t,n){return s(0===this.negative),this.iushrn(e,t,n)},r.prototype.shln=function(e){return this.clone().ishln(e)},r.prototype.ushln=function(e){return this.clone().iushln(e)},r.prototype.shrn=function(e){return this.clone().ishrn(e)},r.prototype.ushrn=function(e){return this.clone().iushrn(e)},r.prototype.testn=function(e){s("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,r=1<<t;return!(this.length<=n)&&!!(this.words[n]&r)},r.prototype.imaskn=function(e){s("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(s(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},r.prototype.maskn=function(e){return this.clone().imaskn(e)},r.prototype.iaddn=function(e){return s("number"==typeof e),s(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},r.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},r.prototype.isubn=function(e){if(s("number"==typeof e),s(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},r.prototype.addn=function(e){return this.clone().iaddn(e)},r.prototype.subn=function(e){return this.clone().isubn(e)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(e,t,n){var r,a,i=e.length+n;this._expand(i);var o=0;for(r=0;r<e.length;r++){a=(0|this.words[r+n])+o;var c=(0|e.words[r])*t;o=((a-=67108863&c)>>26)-(c/67108864|0),this.words[r+n]=67108863&a}for(;r<this.length-n;r++)o=(a=(0|this.words[r+n])+o)>>26,this.words[r+n]=67108863&a;if(0===o)return this.strip();for(s(-1===o),o=0,r=0;r<this.length;r++)o=(a=-(0|this.words[r])+o)>>26,this.words[r]=67108863&a;return this.negative=1,this.strip()},r.prototype._wordDiv=function(e,t){var s=(this.length,e.length),n=this.clone(),a=e,i=0|a.words[a.length-1];0!==(s=26-this._countBits(i))&&(a=a.ushln(s),n.iushln(s),i=0|a.words[a.length-1]);var o,c=n.length-a.length;if("mod"!==t){(o=new r(null)).length=c+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var l=n.clone()._ishlnsubmul(a,1,c);0===l.negative&&(n=l,o&&(o.words[c]=1));for(var d=c-1;d>=0;d--){var h=67108864*(0|n.words[a.length+d])+(0|n.words[a.length+d-1]);for(h=Math.min(h/i|0,67108863),n._ishlnsubmul(a,h,d);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(a,1,d),n.isZero()||(n.negative^=1);o&&(o.words[d]=h)}return o&&o.strip(),n.strip(),"div"!==t&&0!==s&&n.iushrn(s),{div:o||null,mod:n}},r.prototype.divmod=function(e,t,n){return s(!e.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(a=o.div.neg()),"div"!==t&&(i=o.mod.neg(),n&&0!==i.negative&&i.iadd(e)),{div:a,mod:i}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(a=o.div.neg()),{div:a,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(i=o.mod.neg(),n&&0!==i.negative&&i.isub(e)),{div:o.div,mod:i}):e.length>this.length||this.cmp(e)<0?{div:new r(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new r(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new r(this.modn(e.words[0]))}:this._wordDiv(e,t);var a,i,o},r.prototype.div=function(e){return this.divmod(e,"div",!1).div},r.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},r.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},r.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var s=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),a=s.cmp(n);return a<0||1===r&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},r.prototype.modn=function(e){s(e<=67108863);for(var t=(1<<26)%e,n=0,r=this.length-1;r>=0;r--)n=(t*n+(0|this.words[r]))%e;return n},r.prototype.idivn=function(e){s(e<=67108863);for(var t=0,n=this.length-1;n>=0;n--){var r=(0|this.words[n])+67108864*t;this.words[n]=r/e|0,t=r%e}return this.strip()},r.prototype.divn=function(e){return this.clone().idivn(e)},r.prototype.egcd=function(e){s(0===e.negative),s(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a=new r(1),i=new r(0),o=new r(0),c=new r(1),u=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++u;for(var l=n.clone(),d=t.clone();!t.isZero();){for(var h=0,f=1;0==(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(a.isOdd()||i.isOdd())&&(a.iadd(l),i.isub(d)),a.iushrn(1),i.iushrn(1);for(var p=0,m=1;0==(n.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(l),c.isub(d)),o.iushrn(1),c.iushrn(1);t.cmp(n)>=0?(t.isub(n),a.isub(o),i.isub(c)):(n.isub(t),o.isub(a),c.isub(i))}return{a:o,b:c,gcd:n.iushln(u)}},r.prototype._invmp=function(e){s(0===e.negative),s(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var a,i=new r(1),o=new r(0),c=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var u=0,l=1;0==(t.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(t.iushrn(u);u-- >0;)i.isOdd()&&i.iadd(c),i.iushrn(1);for(var d=0,h=1;0==(n.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(n.iushrn(d);d-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(o)):(n.isub(t),o.isub(i))}return(a=0===t.cmpn(1)?i:o).cmpn(0)<0&&a.iadd(e),a},r.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),s=e.clone();t.negative=0,s.negative=0;for(var n=0;t.isEven()&&s.isEven();n++)t.iushrn(1),s.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;s.isEven();)s.iushrn(1);var r=t.cmp(s);if(r<0){var a=t;t=s,s=a}else if(0===r||0===s.cmpn(1))break;t.isub(s)}return s.iushln(n)},r.prototype.invm=function(e){return this.egcd(e).a.umod(e)},r.prototype.isEven=function(){return 0==(1&this.words[0])},r.prototype.isOdd=function(){return 1==(1&this.words[0])},r.prototype.andln=function(e){return this.words[0]&e},r.prototype.bincn=function(e){s("number"==typeof e);var t=e%26,n=(e-t)/26,r=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=r,this;for(var a=r,i=n;0!==a&&i<this.length;i++){var o=0|this.words[i];a=(o+=a)>>>26,o&=67108863,this.words[i]=o}return 0!==a&&(this.words[i]=a,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this.strip(),this.length>1)t=1;else{n&&(e=-e),s(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},r.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},r.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,s=this.length-1;s>=0;s--){var n=0|this.words[s],r=0|e.words[s];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},r.prototype.gtn=function(e){return 1===this.cmpn(e)},r.prototype.gt=function(e){return 1===this.cmp(e)},r.prototype.gten=function(e){return this.cmpn(e)>=0},r.prototype.gte=function(e){return this.cmp(e)>=0},r.prototype.ltn=function(e){return-1===this.cmpn(e)},r.prototype.lt=function(e){return-1===this.cmp(e)},r.prototype.lten=function(e){return this.cmpn(e)<=0},r.prototype.lte=function(e){return this.cmp(e)<=0},r.prototype.eqn=function(e){return 0===this.cmpn(e)},r.prototype.eq=function(e){return 0===this.cmp(e)},r.red=function(e){return new S(e)},r.prototype.toRed=function(e){return s(!this.red,"Already a number in reduction context"),s(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},r.prototype.fromRed=function(){return s(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(e){return this.red=e,this},r.prototype.forceRed=function(e){return s(!this.red,"Already a number in reduction context"),this._forceRed(e)},r.prototype.redAdd=function(e){return s(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},r.prototype.redIAdd=function(e){return s(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},r.prototype.redSub=function(e){return s(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},r.prototype.redISub=function(e){return s(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},r.prototype.redShl=function(e){return s(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},r.prototype.redMul=function(e){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},r.prototype.redIMul=function(e){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},r.prototype.redSqr=function(){return s(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return s(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return s(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return s(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return s(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(e){return s(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function g(e,t){this.name=e,this.p=new r(t,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function v(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=r._prime(e);this.m=t.p,this.prime=t}else s(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}g.prototype._tmp=function(){var e=new r(null);return e.words=new Array(Math.ceil(this.n/13)),e},g.prototype.ireduce=function(e){var t,s=e;do{this.split(s,this.tmp),t=(s=(s=this.imulK(s)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:s.ucmp(this.p);return 0===n?(s.words[0]=0,s.length=1):n>0?s.isub(this.p):void 0!==s.strip?s.strip():s._strip(),s},g.prototype.split=function(e,t){e.iushrn(this.n,0,t)},g.prototype.imulK=function(e){return e.imul(this.k)},n(y,g),y.prototype.split=function(e,t){for(var s=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=a&s,r=10;r<e.length;r++){var i=0|e.words[r];e.words[r-10]=(i&s)<<4|a>>>22,a=i}a>>>=22,e.words[r-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},y.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,s=0;s<e.length;s++){var n=0|e.words[s];t+=977*n,e.words[s]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(b,g),n(v,g),n(M,g),M.prototype.imulK=function(e){for(var t=0,s=0;s<e.length;s++){var n=19*(0|e.words[s])+t,r=67108863&n;n>>>=26,e.words[s]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},r._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new y;else if("p224"===e)t=new b;else if("p192"===e)t=new v;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new M}return w[e]=t,t},S.prototype._verify1=function(e){s(0===e.negative,"red works only with positives"),s(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){s(0==(e.negative|t.negative),"red works only with positives"),s(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var s=e.add(t);return s.cmp(this.m)>=0&&s.isub(this.m),s._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var s=e.iadd(t);return s.cmp(this.m)>=0&&s.isub(this.m),s},S.prototype.sub=function(e,t){this._verify2(e,t);var s=e.sub(t);return s.cmpn(0)<0&&s.iadd(this.m),s._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var s=e.isub(t);return s.cmpn(0)<0&&s.iadd(this.m),s},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(s(t%2==1),3===t){var n=this.m.add(new r(1)).iushrn(2);return this.pow(e,n)}for(var a=this.m.subn(1),i=0;!a.isZero()&&0===a.andln(1);)i++,a.iushrn(1);s(!a.isZero());var o=new r(1).toRed(this),c=o.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new r(2*l*l).toRed(this);0!==this.pow(l,u).cmp(c);)l.redIAdd(c);for(var d=this.pow(l,a),h=this.pow(e,a.addn(1).iushrn(1)),f=this.pow(e,a),p=i;0!==f.cmp(o);){for(var m=f,w=0;0!==m.cmp(o);w++)m=m.redSqr();s(w<p);var g=this.pow(d,new r(1).iushln(p-w-1));h=h.redMul(g),d=g.redSqr(),f=f.redMul(d),p=w}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new r(1).toRed(this);if(0===t.cmpn(1))return e.clone();var s=new Array(16);s[0]=new r(1).toRed(this),s[1]=e;for(var n=2;n<s.length;n++)s[n]=this.mul(s[n-1],e);var a=s[0],i=0,o=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],l=c-1;l>=0;l--){var d=u>>l&1;a!==s[0]&&(a=this.sqr(a)),0!==d||0!==i?(i<<=1,i|=d,(4===++o||0===n&&0===l)&&(a=this.mul(a,s[i]),o=0,i=0)):o=0}c=26}return a},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},r.mont=function(e){return new I(e)},n(I,S),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var s=e.imul(t),n=s.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=s.isub(n).iushrn(this.shift),a=r;return r.cmp(this.m)>=0?a=r.isub(this.m):r.cmpn(0)<0&&(a=r.iadd(this.m)),a._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new r(0)._forceRed(this);var s=e.mul(t),n=s.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=s.isub(n).iushrn(this.shift),i=a;return a.cmp(this.m)>=0?i=a.isub(this.m):a.cmpn(0)<0&&(i=a.iadd(this.m)),i._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,Ye)})),Da=function(e){return Ea||(Ea=new Ka(null)),Ea.generate(e)};
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ka(e){this.rand=e}var Oa=Ka;if(Ka.prototype.generate=function(e){return this._rand(e)},Ka.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),s=0;s<t.length;s++)t[s]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?Ka.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?Ka.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(Ka.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Ra=Na;if("function"!=typeof Ra.randomBytes)throw new Error("Not supported");Ka.prototype._rand=function(e){return Ra.randomBytes(e)}}catch(e){}function Ca(e){this.rand=e||new Da.Rand}Da.Rand=Oa;var Fa=Ca;Ca.create=function(e){return new Ca(e)},Ca.prototype._randbelow=function(e){var t=e.bitLength(),s=Math.ceil(t/8);do{var n=new Ta(this.rand.generate(s))}while(n.cmp(e)>=0);return n},Ca.prototype._randrange=function(e,t){var s=t.sub(e);return e.add(this._randbelow(s))},Ca.prototype.test=function(e,t,s){var n=e.bitLength(),r=Ta.mont(e),a=new Ta(1).toRed(r);t||(t=Math.max(1,n/48|0));for(var i=e.subn(1),o=0;!i.testn(o);o++);for(var c=e.shrn(o),u=i.toRed(r);t>0;t--){var l=this._randrange(new Ta(2),i);s&&s(l);var d=l.toRed(r).redPow(c);if(0!==d.cmp(a)&&0!==d.cmp(u)){for(var h=1;h<o;h++){if(0===(d=d.redSqr()).cmp(a))return!1;if(0===d.cmp(u))break}if(h===o)return!1}}return!0},Ca.prototype.getDivisor=function(e,t){var s=e.bitLength(),n=Ta.mont(e),r=new Ta(1).toRed(n);t||(t=Math.max(1,s/48|0));for(var a=e.subn(1),i=0;!a.testn(i);i++);for(var o=e.shrn(i),c=a.toRed(n);t>0;t--){var u=this._randrange(new Ta(2),a),l=e.gcd(u);if(0!==l.cmpn(1))return l;var d=u.toRed(n).redPow(o);if(0!==d.cmp(r)&&0!==d.cmp(c)){for(var h=1;h<i;h++){if(0===(d=d.redSqr()).cmp(r))return d.fromRed().subn(1).gcd(e);if(0===d.cmp(c))break}if(h===i)return(d=d.redSqr()).fromRed().subn(1).gcd(e)}}return!1};var La=Ya;Ya.simpleSieve=Qa,Ya.fermatTest=Za;var qa=new Ta(24),ja=new Fa,Va=new Ta(1),_a=new Ta(2),Ha=new Ta(5);new Ta(16),new Ta(8);var $a=new Ta(10),Ga=new Ta(3);new Ta(7);var Ja=new Ta(11),za=new Ta(4);new Ta(12);var Wa=null;function Qa(e){for(var t=function(){if(null!==Wa)return Wa;var e=[];e[0]=2;for(var t=1,s=3;s<1048576;s+=2){for(var n=Math.ceil(Math.sqrt(s)),r=0;r<t&&e[r]<=n&&s%e[r]!=0;r++);t!==r&&e[r]<=n||(e[t++]=s)}return Wa=e,e}(),s=0;s<t.length;s++)if(0===e.modn(t[s]))return 0===e.cmpn(t[s]);return!0}function Za(e){var t=Ta.mont(e);return 0===_a.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function Ya(e,t){if(e<16)return new Ta(2===t||5===t?[140,123]:[140,39]);var s,n;for(t=new Ta(t);;){for(s=new Ta(Ua(Math.ceil(e/8)));s.bitLength()>e;)s.ishrn(1);if(s.isEven()&&s.iadd(Va),s.testn(1)||s.iadd(_a),t.cmp(_a)){if(!t.cmp(Ha))for(;s.mod($a).cmp(Ga);)s.iadd(za)}else for(;s.mod(qa).cmp(Ja);)s.iadd(za);if(Qa(n=s.shrn(1))&&Qa(s)&&Za(n)&&Za(s)&&ja.test(n)&&ja.test(s))return s}}var Xa={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}},ei=new Fa,ti=new Ta(24),si=new Ta(11),ni=new Ta(10),ri=new Ta(3),ai=new Ta(7),ii=li;function oi(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._pub=new Ta(e),this}function ci(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._priv=new Ta(e),this}var ui={};function li(e,t,s){this.setGenerator(t),this.__prime=new Ta(e),this._prime=Ta.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,s?(this.setPublicKey=oi,this.setPrivateKey=ci):this._primeCode=8}function di(e,t){var s=new Buffer(e.toArray());return t?s.toString(t):s}Object.defineProperty(li.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var s=t.toString("hex"),n=[s,e.toString(16)].join("_");if(n in ui)return ui[n];var r,a=0;if(e.isEven()||!La.simpleSieve||!La.fermatTest(e)||!ei.test(e))return a+=1,a+="02"===s||"05"===s?8:4,ui[n]=a,a;switch(ei.test(e.shrn(1))||(a+=2),s){case"02":e.mod(ti).cmp(si)&&(a+=8);break;case"05":(r=e.mod(ni)).cmp(ri)&&r.cmp(ai)&&(a+=8);break;default:a+=4}return ui[n]=a,a}(this.__prime,this.__gen)),this._primeCode}}),li.prototype.generateKeys=function(){return this._priv||(this._priv=new Ta(Ua(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},li.prototype.computeSecret=function(e){var t=(e=(e=new Ta(e)).toRed(this._prime)).redPow(this._priv).fromRed(),s=new Buffer(t.toArray()),n=this.getPrime();if(s.length<n.length){var r=new Buffer(n.length-s.length);r.fill(0),s=Buffer.concat([r,s])}return s},li.prototype.getPublicKey=function(e){return di(this._pub,e)},li.prototype.getPrivateKey=function(e){return di(this._priv,e)},li.prototype.getPrime=function(e){return di(this.__prime,e)},li.prototype.getGenerator=function(e){return di(this._gen,e)},li.prototype.setGenerator=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.__gen=e,this._gen=new Ta(e),this};var hi=Xe((function(e,t){var s={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=function(e){var t=new Buffer(Xa[e].prime,"hex"),s=new Buffer(Xa[e].gen,"hex");return new ii(t,s)},t.createDiffieHellman=t.DiffieHellman=function e(t,n,r,a){return Buffer.isBuffer(n)||void 0===s[n]?e(t,"binary",n,r):(n=n||"binary",a=a||"binary",r=r||new Buffer([2]),Buffer.isBuffer(r)||(r=new Buffer(r,a)),"number"==typeof t?new ii(La(t,r),r,!0):(Buffer.isBuffer(t)||(t=new Buffer(t,n)),new ii(t,r,!0)))}}));const fi=["encrypt"],pi=(e=>{if(e.length%2!=0)throw new Error("Hex string must be even length");const t=e.length/2,s=[];for(let n=0;n<t;n++){const t=2*n,r=e.substring(t,t+2),a=parseInt(r,16);s.push(a)}return new Uint8Array(s)})("ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"),mi=[2];let wi=null;const gi=e=>((e,t)=>(e.setPrivateKey(t),e.generateKeys(),e))(hi.createDiffieHellman(pi,mi),e),yi=async(e,t)=>{const s=gi(e).computeSecret(t),n=await _r.hash(s);return await ha.getKeyFromRawKey(n)};var bi={getPublicKey:e=>gi(e).getPublicKey(),getSharedKey:yi,getSharedKeyWithServer:async e=>await yi(e,new Uint8Array(await(async()=>wi||(wi=await Ar(),wi))())),importKeyFromMaster:async(e,t)=>{const s=await window.crypto.subtle.deriveKey(Wr.getParams("diffie-hellman",t),e,ha.getEncryptionKeyParams(),true,fi);return await ha.getRawKeyFromKey(s)}};const vi="ECDSA",Mi=!0,Si=["sign","verify"],Ii=["sign"],Ei=["verify"],Ai="spki",Bi={name:vi,namedCurve:"P-256"},ki={name:vi,hash:{name:_r.HASH_ALGORITHM_NAME}},Pi=async e=>await window.crypto.subtle.exportKey(Ai,e),xi=async e=>{const t=await Pi(e);return tt.encode(t)},Ui=async(e,t)=>await ha.importKeyFromMaster(e,t,"ecdsa-key-encryption-key"),Ni=async(e,t)=>await window.crypto.subtle.sign(ki,e,t),Ti=async(e,t,s)=>await window.crypto.subtle.verify(ki,e,t,s);var Di={generateEcdsaKeyData:async e=>{const t=await(async()=>await window.crypto.subtle.generateKey(Bi,Mi,Si))(),s=Wr.generateSalt(),n=await Ui(e,s),r=await(async e=>{const t=await window.crypto.subtle.exportKey("jwk",e);return Lr(JSON.stringify(t))})(t.privateKey),a=await ha.encrypt(n,r);return{ecdsaPrivateKey:t.privateKey,ecdsaPublicKey:await xi(t.publicKey),encryptedEcdsaPrivateKey:tt.encode(a),ecdsaKeyEncryptionKeySalt:tt.encode(s)}},importEcdsaKeyEncryptionKeyFromMaster:Ui,getPrivateKeyFromRawPrivateKey:async e=>{const t=JSON.parse(Fr(e));return await window.crypto.subtle.importKey("jwk",t,Bi,Mi,Ii)},getPublicKeyFromRawPublicKey:async e=>await window.crypto.subtle.importKey(Ai,e,Bi,Mi,Ei),getRawPublicKeyFromPublicKey:Pi,getPublicKeyStringFromPublicKey:xi,getPublicKeyFromPrivateKey:async e=>{const t=await window.crypto.subtle.exportKey("jwk",e);delete t.d,t.key_ops=Ei;return await window.crypto.subtle.importKey("jwk",t,Bi,Mi,Ei)},sign:Ni,signString:async(e,t)=>{const s=Lr(t),n=await Ni(e,s);return tt.encode(n)},verify:Ti,verifyString:async(e,t,s)=>{const n=Lr(s),r=tt.decode(t);return await Ti(e,r,n)}};const Ki="ECDH",Oi=!0,Ri=["deriveKey","deriveBits"],Ci="spki",Fi="P-256",Li={name:Ki,namedCurve:Fi},qi=async()=>await window.crypto.subtle.generateKey(Li,Oi,Ri),ji=async e=>await window.crypto.subtle.exportKey(Ci,e),Vi=async(e,t)=>await ha.importKeyFromMaster(e,t,"ecdh-key-encryption-key");var _i={generateKeyPair:qi,generateEcdhKeyData:async(e,t)=>{const s=await qi(),n=Wr.generateSalt(),r=await Vi(e,n),a=await(async e=>{const t=await window.crypto.subtle.exportKey("jwk",e);return Lr(JSON.stringify(t))})(s.privateKey),i=await ha.encrypt(r,a),o=await ji(s.publicKey),c=await Di.sign(t,o);return{ecdhPrivateKey:s.privateKey,ecdhPublicKey:tt.encode(o),encryptedEcdhPrivateKey:tt.encode(i),signedEcdhPublicKey:tt.encode(c),ecdhKeyEncryptionKeySalt:tt.encode(n)}},importEcdhKeyEncryptionKeyFromMaster:Vi,getPrivateKeyFromRawPrivateKey:async e=>{const t=JSON.parse(Fr(e));return await window.crypto.subtle.importKey("jwk",t,Li,Oi,Ri)},getRawPublicKeyFromPublicKey:ji,getPublicKeyFromRawPublicKey:async e=>await window.crypto.subtle.importKey(Ci,e,Li,Oi,[]),computeSharedKeyEncryptionKey:async(e,t)=>await window.crypto.subtle.deriveKey({name:Ki,namedCurve:Fi,public:e},t,ha.getEncryptionKeyParams(),!1,ha.KEY_WILL_BE_USED_TO)};const Hi="HMAC",$i=["sign"],Gi=["sign","verify"],Ji=async(e,t)=>await window.crypto.subtle.sign({name:Hi},e,t);var zi={importKeyFromMaster:async(e,t)=>await window.crypto.subtle.deriveKey(Wr.getParams("authentication",t),e,{name:Hi,hash:{name:_r.HASH_ALGORITHM_NAME},length:512},false,$i),importKeyFromRawBits:async e=>await window.crypto.subtle.importKey("raw",e,{name:Hi,hash:{name:_r.HASH_ALGORITHM_NAME},length:256},false,Gi),sign:Ji,signString:async(e,t)=>{const s=await Ji(e,Lr(t));return tt.encode(s)}},Wi=Xe((function(e,t){!function(t){const s=2147483647;function n(e){const t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);let s=1779033703,n=3144134277,r=1013904242,a=2773480762,i=1359893119,o=2600822924,c=528734635,u=1541459225;const l=new Uint32Array(64);function d(e){let d=0,h=e.length;for(;h>=64;){let f,p,m,w,g,y=s,b=n,v=r,M=a,S=i,I=o,E=c,A=u;for(p=0;p<16;p++)m=d+4*p,l[p]=(255&e[m])<<24|(255&e[m+1])<<16|(255&e[m+2])<<8|255&e[m+3];for(p=16;p<64;p++)f=l[p-2],w=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,f=l[p-15],g=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3,l[p]=(w+l[p-7]|0)+(g+l[p-16]|0)|0;for(p=0;p<64;p++)w=(((S>>>6|S<<26)^(S>>>11|S<<21)^(S>>>25|S<<7))+(S&I^~S&E)|0)+(A+(t[p]+l[p]|0)|0)|0,g=((y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10))+(y&b^y&v^b&v)|0,A=E,E=I,I=S,S=M+w|0,M=v,v=b,b=y,y=w+g|0;s=s+y|0,n=n+b|0,r=r+v|0,a=a+M|0,i=i+S|0,o=o+I|0,c=c+E|0,u=u+A|0,d+=64,h-=64}}d(e);let h,f=e.length%64,p=e.length/536870912|0,m=e.length<<3,w=f<56?56:120,g=e.slice(e.length-f,e.length);for(g.push(128),h=f+1;h<w;h++)g.push(0);return g.push(p>>>24&255),g.push(p>>>16&255),g.push(p>>>8&255),g.push(p>>>0&255),g.push(m>>>24&255),g.push(m>>>16&255),g.push(m>>>8&255),g.push(m>>>0&255),d(g),[s>>>24&255,s>>>16&255,s>>>8&255,s>>>0&255,n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255,r>>>24&255,r>>>16&255,r>>>8&255,r>>>0&255,a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255,i>>>24&255,i>>>16&255,i>>>8&255,i>>>0&255,o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255,u>>>24&255,u>>>16&255,u>>>8&255,u>>>0&255]}function r(e,t,s){e=e.length<=64?e:n(e);const r=64+t.length+4,a=new Array(r),i=new Array(64);let o,c=[];for(o=0;o<64;o++)a[o]=54;for(o=0;o<e.length;o++)a[o]^=e[o];for(o=0;o<t.length;o++)a[64+o]=t[o];for(o=r-4;o<r;o++)a[o]=0;for(o=0;o<64;o++)i[o]=92;for(o=0;o<e.length;o++)i[o]^=e[o];function u(){for(let e=r-1;e>=r-4;e--){if(a[e]++,a[e]<=255)return;a[e]=0}}for(;s>=32;)u(),c=c.concat(n(i.concat(n(a)))),s-=32;return s>0&&(u(),c=c.concat(n(i.concat(n(a))).slice(0,s))),c}function a(e,t,s,n,r){let a;for(u(e,16*(2*s-1),r,0,16),a=0;a<2*s;a++)c(e,16*a,r,16),o(r,n),u(r,0,e,t+16*a,16);for(a=0;a<s;a++)u(e,t+2*a*16,e,16*a,16);for(a=0;a<s;a++)u(e,t+16*(2*a+1),e,16*(a+s),16)}function i(e,t){return e<<t|e>>>32-t}function o(e,t){u(e,0,t,0,16);for(let e=8;e>0;e-=2)t[4]^=i(t[0]+t[12],7),t[8]^=i(t[4]+t[0],9),t[12]^=i(t[8]+t[4],13),t[0]^=i(t[12]+t[8],18),t[9]^=i(t[5]+t[1],7),t[13]^=i(t[9]+t[5],9),t[1]^=i(t[13]+t[9],13),t[5]^=i(t[1]+t[13],18),t[14]^=i(t[10]+t[6],7),t[2]^=i(t[14]+t[10],9),t[6]^=i(t[2]+t[14],13),t[10]^=i(t[6]+t[2],18),t[3]^=i(t[15]+t[11],7),t[7]^=i(t[3]+t[15],9),t[11]^=i(t[7]+t[3],13),t[15]^=i(t[11]+t[7],18),t[1]^=i(t[0]+t[3],7),t[2]^=i(t[1]+t[0],9),t[3]^=i(t[2]+t[1],13),t[0]^=i(t[3]+t[2],18),t[6]^=i(t[5]+t[4],7),t[7]^=i(t[6]+t[5],9),t[4]^=i(t[7]+t[6],13),t[5]^=i(t[4]+t[7],18),t[11]^=i(t[10]+t[9],7),t[8]^=i(t[11]+t[10],9),t[9]^=i(t[8]+t[11],13),t[10]^=i(t[9]+t[8],18),t[12]^=i(t[15]+t[14],7),t[13]^=i(t[12]+t[15],9),t[14]^=i(t[13]+t[12],13),t[15]^=i(t[14]+t[13],18);for(let s=0;s<16;++s)e[s]+=t[s]}function c(e,t,s,n){for(let r=0;r<n;r++)s[r]^=e[t+r]}function u(e,t,s,n,r){for(;r--;)s[n++]=e[t++]}function l(e){if(!e||"number"!=typeof e.length)return!1;for(let t=0;t<e.length;t++){const s=e[t];if("number"!=typeof s||s%1||s<0||s>=256)return!1}return!0}function d(e,t){if("number"!=typeof e||e%1)throw new Error("invalid "+t);return e}function h(e,t,n,i,o,h,f){if(n=d(n,"N"),i=d(i,"r"),o=d(o,"p"),h=d(h,"dkLen"),0===n||0!=(n&n-1))throw new Error("N must be power of 2");if(n>s/128/i)throw new Error("N too large");if(i>s/128/o)throw new Error("r too large");if(!l(e))throw new Error("password must be an array or buffer");if(e=Array.prototype.slice.call(e),!l(t))throw new Error("salt must be an array or buffer");t=Array.prototype.slice.call(t);let p=r(e,t,128*o*i);const m=new Uint32Array(32*o*i);for(let e=0;e<m.length;e++){const t=4*e;m[e]=(255&p[t+3])<<24|(255&p[t+2])<<16|(255&p[t+1])<<8|(255&p[t+0])<<0}const w=new Uint32Array(64*i),g=new Uint32Array(32*i*n),y=32*i,b=new Uint32Array(16),v=new Uint32Array(16),M=o*n*2;let S,I,E=0,A=null,B=!1,k=0,P=0;const x=f?parseInt(1e3/i):4294967295,U="undefined"!=typeof setImmediate?setImmediate:setTimeout,N=function(){if(B)return f(new Error("cancelled"),E/M);let t;switch(k){case 0:I=32*P*i,u(m,I,w,0,y),k=1,S=0;case 1:t=n-S,t>x&&(t=x);for(let e=0;e<t;e++)u(w,0,g,(S+e)*y,y),a(w,y,i,b,v);if(S+=t,E+=t,f){const e=parseInt(1e3*E/M);if(e!==A){if(B=f(null,E/M),B)break;A=e}}if(S<n)break;S=0,k=2;case 2:t=n-S,t>x&&(t=x);for(let e=0;e<t;e++){const e=w[16*(2*i-1)]&n-1;c(g,e*y,w,y),a(w,y,i,b,v)}if(S+=t,E+=t,f){const e=parseInt(1e3*E/M);if(e!==A){if(B=f(null,E/M),B)break;A=e}}if(S<n)break;if(u(w,0,m,I,y),P++,P<o){k=0;break}p=[];for(let e=0;e<m.length;e++)p.push(m[e]>>0&255),p.push(m[e]>>8&255),p.push(m[e]>>16&255),p.push(m[e]>>24&255);const s=r(e,p,h);return f&&f(null,1,s),s}f&&U(N)};if(!f)for(;;){const e=N();if(null!=e)return e}N()}const f={scrypt:function(e,t,s,n,r,a,i){return new Promise((function(o,c){let u=0;i&&i(0),h(e,t,s,n,r,a,(function(e,t,s){if(e)c(e);else if(s)i&&1!==u&&i(1),o(new Uint8Array(s));else if(i&&t!==u)return u=t,i(t)}))}))},syncScrypt:function(e,t,s,n,r,a){return new Uint8Array(h(e,t,s,n,r,a))}};e.exports=f}()}));var Qi={generateSeed:()=>window.crypto.getRandomValues(new Uint8Array(32)),aesGcm:ha,diffieHellman:bi,ecdsa:Di,ecdh:_i,sha256:_r,hmac:zi,hkdf:Wr,scrypt:{generateSalt:()=>window.crypto.getRandomValues(new Uint8Array(16)),hash:async(e,t,s=Wi.scrypt)=>{const n=new Uint8Array(Lr(e)),r=await s(n,t,16384,8,1,32);return tt.encode(r)}}};const Zi=e=>e.split(":")[0],Yi=e=>{const t=(e=>{const t="http://",s="https://";return e.substring(0,t.length)===t?e.substring(t.length):e.substring(0,s.length)===s?e.substring(s.length):e})(e);return("https"===Zi(e)?"wss://":"ws://")+t},Xi=e=>2*e.length,eo=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function to(){let e=[],t=0;this.getLength=()=>e.length-t,this.isEmpty=()=>0===e.length,this.enqueue=t=>(e.push(t),this.getLength()),this.dequeue=()=>{const s=e[t];return t+=1,2*t>e.length&&(e=e.slice(t),t=0),s},this.peek=()=>e[t]}const so=()=>{const e=URL.createObjectURL(new Blob(["(",function(){self.onmessage=function(e){const{compress:t,decompress:s,data:n}=e.data,r=function(){function e(e,t){if(!r[e]){r[e]={};for(var s=0;s<e.length;s++)r[e][e.charAt(s)]=s}return r[e][t]}var t=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},a={compressToBase64:function(e){if(null==e)return"";var t=a._compress(e,6,(function(e){return s.charAt(e)}));switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,(function(n){return e(s,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":a._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=a.compress(e),s=new Uint8Array(2*t.length),n=0,r=t.length;r>n;n++){var i=t.charCodeAt(n);s[2*n]=i>>>8,s[2*n+1]=i%256}return s},decompressFromUint8Array:function(e){if(null==e)return a.decompress(e);for(var s=new Array(e.length/2),n=0,r=s.length;r>n;n++)s[n]=256*e[2*n]+e[2*n+1];var i=[];return s.forEach((function(e){i.push(t(e))})),a.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,(function(s){return e(n,t.charAt(s))})))},compress:function(e){return a._compress(e,16,(function(e){return t(e)}))},_compress:function(e,t,s){if(null==e)return"";var n,r,a,i={},o={},c="",u="",l="",d=2,h=3,f=2,p=[],m=0,w=0;for(a=0;a<e.length;a+=1)if(c=e.charAt(a),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=h++,o[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(o,l)){if(l.charCodeAt(0)<256){for(n=0;f>n;n++)m<<=1,w==t-1?(w=0,p.push(s(m)),m=0):w++;for(r=l.charCodeAt(0),n=0;8>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1}else{for(r=1,n=0;f>n;n++)m=m<<1|r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r=0;for(r=l.charCodeAt(0),n=0;16>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete o[l]}else for(r=i[l],n=0;f>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1;0==--d&&(d=Math.pow(2,f),f++),i[u]=h++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(o,l)){if(l.charCodeAt(0)<256){for(n=0;f>n;n++)m<<=1,w==t-1?(w=0,p.push(s(m)),m=0):w++;for(r=l.charCodeAt(0),n=0;8>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1}else{for(r=1,n=0;f>n;n++)m=m<<1|r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r=0;for(r=l.charCodeAt(0),n=0;16>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete o[l]}else for(r=i[l],n=0;f>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1;0==--d&&(d=Math.pow(2,f),f++)}for(r=2,n=0;f>n;n++)m=m<<1|1&r,w==t-1?(w=0,p.push(s(m)),m=0):w++,r>>=1;for(;;){if(m<<=1,w==t-1){p.push(s(m));break}w++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(e,s,n){var r,a,i,o,c,u,l,d=[],h=4,f=4,p=3,m="",w=[],g={val:n(0),position:s,index:1};for(r=0;3>r;r+=1)d[r]=r;for(i=0,c=Math.pow(2,2),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;l=t(i);break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;l=t(i);break;case 2:return""}for(d[3]=l,a=l,w.push(l);;){if(g.index>e)return"";for(i=0,c=Math.pow(2,p),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;d[f++]=t(i),l=f-1,h--;break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=s,g.val=n(g.index++)),i|=(o>0?1:0)*u,u<<=1;d[f++]=t(i),l=f-1,h--;break;case 2:return w.join("")}if(0==h&&(h=Math.pow(2,p),p++),d[l])m=d[l];else{if(l!==f)return null;m=a+a.charAt(0)}w.push(m),d[f++]=a+m.charAt(0),a=m,0==--h&&(h=Math.pow(2,p),p++)}}};return a}();t?postMessage(r.compress(n)):s&&postMessage(r.decompress(n))}}.toString(),")()"],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t},no=async e=>{const t=so();return new Promise((s=>{t.onmessage=e=>{s(e.data),t.terminate()},t.postMessage({compress:!0,data:e})}))},ro=async e=>{const t=so();return new Promise((s=>{t.onmessage=e=>{s(e.data),t.terminate()},t.postMessage({decompress:!0,data:e})}))},ao=async(e,t,s,n,r,a)=>new Promise(((i,o)=>{const c=new XMLHttpRequest,u="".concat(pr(),"/api/bundle-chunk?userbaseJsVersion=").concat(dr,"&")+"userId=".concat(e,"&")+"databaseId=".concat(t,"&")+"seqNo=".concat(s,"&")+"bundleId=".concat(n,"&")+"chunkNumber=".concat(r);c.open("POST",u),c.send(new Uint8Array(a)),vr(c,i,o,3e4)}));function io(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function oo(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?io(Object(s),!0).forEach((function(t){Ze(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):io(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const co="Web Socket already connected",uo=524288,lo=Nr();class ho extends Error{constructor(e,t,...s){super(...s),this.name="RequestFailed: ".concat(e),this.message=t.message,this.status=t.status||"timeout"===t.message&&ht,this.response=t.status&&t}}class fo extends Error{constructor(e,t,s,...n){super(...n),this.name="WebSocket error",this.message=e,this.username=t,this.e=s}}var po=new class{constructor(){this.init()}init(e,t,s,n,r,a,i,o){this.pingTimeout&&clearTimeout(this.pingTimeout);for(const e of Object.keys(this))delete this[e];this.ws=null,this.connected=!1,this.resolveConnection=e,this.rejectConnection=t,this.connectionResolved=!1,this.session={username:s&&s.username,sessionId:s&&s.sessionId,creationDate:s&&s.creationDate,expirationDate:s&&s.expirationDate,userId:s&&s.userId,authToken:s&&s.authToken},this.seedString=n,this.changePassword=a,this.keys={init:!1,salts:{}},this.userData={stripeData:{}},this.rememberMe=r,this.requests={},this.state=i||{dbNameToHash:{},databases:{},databasesByDbId:{},shareTokenIdToDbId:{}},this.encryptionMode=o}connect(e,t=null,s,n,r,a){if(this.connected)throw new fo(co,this.session.username);return new Promise(((i,o)=>{let c=!1;const u=setTimeout((()=>{this.connected||this.reconnecting||(c=!0,o(new fo("timeout")))}),1e4),l="".concat(Yi(pr()),"/api?appId=").concat(hr(),"&sessionId=").concat(e.sessionId,"&clientId=").concat(lo,"&userbaseJsVersion=").concat(dr),d=new WebSocket(l);d.onopen=async()=>{c||clearTimeout(u)},d.onmessage=async r=>{if(!c)try{const c=JSON.parse(r.data);switch(c.route){case"Ping":{this.heartbeat();const e="Pong";this.ws.send(JSON.stringify({action:e}));break}case"Connection":{const{encryptionMode:u}=c;if(this.init(i,o,e,t,s,n,a,u),this.ws=d,this.heartbeat(),this.connected=!0,t){const{keySalts:e,validationMessage:t,ecKeyData:s,encryptedValidationMessage:n}=c;this.keys.salts=e,this.validationMessage=t,this.ecKeyData=s,n&&(this.encryptedValidationMessage=new Uint8Array(n.data));try{await this.setKeys(this.seedString);const e=await this.validateKey();this.userData=e}catch(r){throw r&&"OperationError"===r.name||r instanceof DOMException?new Error("Invalid seed"):r}this.keys.init=!0}this.resolveConnection(),this.connectionResolved=!0;break}case"ApplyTransactions":{const e=c.dbId,t=c.dbNameHash,s=c.isOwner?this.state.databases[t]:this.state.databasesByDbId[e];if(!s)throw new Error("Missing database");s.applyTransactionsQueue.isEmpty()?s.applyTransactionsQueue.enqueue(null):await new Promise((e=>{const t=e;s.applyTransactionsQueue.enqueue(t)}));if((c.dbNameHash&&(c.dbKey||c.plaintextDbKey)||c.shareTokenEncryptedDbKey)&&(!s.dbKeyString||!s.dbKey)){const e=c.plaintextDbKey||(c.dbKey?await Qi.aesGcm.decryptString(this.keys.encryptionKey,c.dbKey):await s.decryptShareTokenEncryptedDbKey(c.shareTokenEncryptedDbKey,c.shareTokenEncryptionKeySalt));s.dbKeyString=e,s.dbKey=await Qi.aesGcm.getKeyFromKeyString(e)}if(!s.dbKey)throw new Error("Missing db key");if(c.writers){s.attributionEnabled=!0;for(const{userId:e,username:t}of c.writers)s.usernamesByUserId.set(e,t)}if(c.waitForFullBundle){s.finishedWaitingForBundle||await new Promise((e=>s.finishedWaitingForBundle=e));try{const e=await this.rebuildBundle(s,c.bundleSeqNo,c.encryptedBundleEncryptionKey);await s.applyBundle(e,c.bundleSeqNo)}catch(r){throw window.alert("Oops! Something went wrong. Please contact the site administrator with this issue (".concat(e,").\n\n")+r),r}}const n=c.transactionLog;if(await s.applyTransactions(n,c.ownerId,e,t),c.buildBundle&&this.buildBundle(s),s.applyTransactionsQueue.dequeue(),!s.applyTransactionsQueue.isEmpty()){s.applyTransactionsQueue.peek()()}break}case"DownloadBundleChunk":{const{dbId:e,dbNameHash:t,isOwner:s,bundleSeqNo:n,isFirstChunk:r,isLastChunk:a,chunk:i}=c,o=s?this.state.databases[t]:this.state.databasesByDbId[e];if(!o)throw new Error("Missing database");r&&(o.bundleChunks[n]=[]),o.bundleChunks[n].push(i),a&&(o.finishedWaitingForBundle?o.finishedWaitingForBundle():o.finishedWaitingForBundle=!0);break}case"UpdatedUser":this.handleUpdateUser(c.updatedUser);break;case"SignOut":case"UpdateUser":case"DeleteUser":case"CreateDatabase":case"OpenDatabase":case"OpenDatabaseByDatabaseId":case"GetDatabases":case"GetDatabaseUsers":case"Insert":case"Update":case"Delete":case"BatchTransaction":case"InitBundleUpload":case"CompleteBundleUpload":case"GenerateFileId":case"UploadFileChunk":case"CompleteFileUpload":case"GetChunk":case"ValidateKey":case"GetPasswordSalts":case"PurchaseSubscription":case"CancelSubscription":case"ResumeSubscription":case"UpdatePaymentMethod":case"ShareDatabase":case"ShareDatabaseToken":case"AuthenticateShareToken":case"SaveDatabase":case"ModifyDatabasePermissions":case"VerifyUser":{const e=c.requestId;if(!e)return console.warn("Missing request id");const t=this.requests[e];if(!t)return console.warn("Request ".concat(e," no longer exists!"));if(!t.promiseResolve||!t.promiseReject)return;const s=c.response;return s&&s.status===st?t.promiseResolve(s):t.promiseReject(s)}default:console.log("Received unknown message from backend:"+JSON.stringify(c))}}catch(r){this.connectionResolved?console.warn("Error handling message: ",r):(this.close(),o(new fo(r.message,e.username,r)))}},d.onclose=async u=>{if(c)return;const l=u.code===ft,d=u.code===pt;if(l||d||!u.wasClean){const c=l&&!r?0:r?r+1e3:1e3;this.reconnecting=!0,await this.reconnect(i,o,e,this.seedString||t,s,n,c,!this.reconnected&&a)}else u.code===mt?o(new fo(co,e.username,u)):this.init()},d.onerror=()=>{}}))}async reconnect(e,t,s,n,r,a,i,o){try{const t=Math.min(i,3e4);console.log("Connection to server lost. Attempting to reconnect in ".concat(t/1e3," second").concat(1e3!==t?"s":"","..."));const c=[],u=[];e(await new Promise(((e,l)=>setTimeout((async()=>{try{const t=o||{dbNameToHash:oo({},this.state.dbNameToHash),databases:oo({},this.state.databases),databasesByDbId:oo({},this.state.databasesByDbId),shareTokenIdToDbId:oo({},this.state.shareTokenIdToDbId)};for(const e in t.databases)t.databases[e].init=!1,t.databases[e].finishedWaitingForBundle=!1,c.push(e);for(const e in t.databasesByDbId)t.databasesByDbId[e].init=!1,t.databasesByDbId[e].finishedWaitingForBundle=!1,u.push(e);this.init(),this.reconnecting=!0;const l=await this.connect(s,n,r,a,i,t);this.reconnected=!0,o||(await this.reopenDatabases(c,u,1e3),console.log("Reconnected!")),e(l)}catch(e){l(e)}}),t))))}catch(e){t(e)}}async reopenDatabases(e,t,s){try{const s=[];for(const t of e){const e=this.state.databases[t];if(!e.init){const n="OpenDatabase",r={dbNameHash:t,reopenAtSeqNo:e.lastSeqNo};s.push(this.request(n,r))}}for(const e of t){const t=this.state.databasesByDbId[e];if(!t.init){const n=t.shareTokenHkdfKey,r=n?await this.authenticateShareToken(t.shareTokenId,n):{},a="OpenDatabaseByDatabaseId",i=oo({databaseId:e,reopenAtSeqNo:t.lastSeqNo},r);s.push(this.request(a,i))}}await Promise.all(s)}catch(n){await new Promise((n=>setTimeout((async()=>{await this.reopenDatabases(e,t,s+1e3),n()}),Math.min(s,3e4))))}}heartbeat(){clearTimeout(this.pingTimeout);this.pingTimeout=setTimeout((()=>{this.ws&&this.ws.close(pt)}),33e3)}close(e){this.ws?this.ws.close(e):this.init()}async signOut(){const e=this.session.username,t=this.connectionResolved,s=this.rejectConnection;try{Cr.signOutSession(this.rememberMe,e);const n=this.session.sessionId;if(this.reconnecting)throw new or.Reconnecting;const r="SignOut",a={sessionId:n};await this.request(r,a),this.close(),!t&&s&&s(new fo("Canceled",e))}catch(n){throw!t&&s&&s(new fo("Canceled",e)),n}}async setKeys(e){if(this.keys.init)return;if(!e)throw new fo("Missing seed",this.session.username);if(!this.keys.salts)throw new fo("Missing salts",this.session.username);this.seedString||(this.seedString=e);const t=tt.decode(e),s=await Qi.hkdf.importHkdfKey(t),n=this.keys.salts;if(this.keys.encryptionKey=await Qi.aesGcm.importKeyFromMaster(s,tt.decode(n.encryptionKeySalt)),this.keys.hmacKey=await Qi.hmac.importKeyFromMaster(s,tt.decode(n.hmacKeySalt)),n.ecdsaKeyEncryptionKeySalt){const e=await Qi.ecdsa.importEcdsaKeyEncryptionKeyFromMaster(s,tt.decode(n.ecdsaKeyEncryptionKeySalt)),t=tt.decode(this.ecKeyData.encryptedEcdsaPrivateKey),r=await Qi.aesGcm.decrypt(e,t);this.keys.ecdsaPrivateKey=await Qi.ecdsa.getPrivateKeyFromRawPrivateKey(r);const a=await Qi.ecdh.importEcdhKeyEncryptionKeyFromMaster(s,tt.decode(n.ecdhKeyEncryptionKeySalt)),i=tt.decode(this.ecKeyData.encryptedEcdhPrivateKey),o=await Qi.aesGcm.decrypt(a,i);this.keys.ecdhPrivateKey=await Qi.ecdh.getPrivateKeyFromRawPrivateKey(o)}else n.dhKeySalt&&(this.keys.dhPrivateKey=await Qi.diffieHellman.importKeyFromMaster(s,tt.decode(n.dhKeySalt)));if(n.dhKeySalt||n.ecdsaKeyWrapperSalt){const e=await Qi.ecdsa.generateEcdsaKeyData(s),t=await Qi.ecdh.generateEcdhKeyData(s,e.ecdsaPrivateKey);this.keys.ecdsaPrivateKey=e.ecdsaPrivateKey,this.keys.ecdhPrivateKey=t.ecdhPrivateKey,delete e.ecdsaPrivateKey,delete t.ecdhPrivateKey,this.newEcKeyData={ecdsaKeyData:e,ecdhKeyData:t}}}async validateKey(){let e;if(this.keys.ecdsaPrivateKey&&!this.keys.dhPrivateKey)e=await Qi.ecdsa.sign(this.keys.ecdsaPrivateKey,tt.decode(this.validationMessage));else if(this.keys.dhPrivateKey){const t=await Qi.diffieHellman.getSharedKeyWithServer(this.keys.dhPrivateKey);e=await Qi.aesGcm.decrypt(t,this.encryptedValidationMessage),delete this.keys.dhPrivateKey}const t={validationMessage:tt.encode(e),ecKeyData:this.newEcKeyData};return(await this.request("ValidateKey",t)).data}async request(e,t){const s=Nr();this.requests[s]={};const n=this.watch(s);this.ws.send(JSON.stringify({requestId:s,action:e,params:t}));try{return await n}catch(t){throw t.status===ut?new or.TooManyRequests(t.data.retryDelay):new ho(e,t)}}async watch(e){const t=await new Promise(((t,s)=>{this.requests[e].promiseResolve=t,this.requests[e].promiseReject=s,setTimeout((()=>{s(new Error("timeout"))}),3e4)}));return delete this.requests[e],t}async rebuildBundle(e,t,s){const n=[];for(let s=0;s<e.bundleChunks[t].length;s++){const r=e.bundleChunks[t][s],a=Lr(r);n.push(a)}const r=(e=>{const t=e.map((e=>e.byteLength)),s=t.reduce(((e,t)=>e+t)),n=new Uint8Array(s);let r=0;for(let s=0;s<e.length;s++)n.set(new Uint8Array(e[s]),r),r+=t[s];return{buffer:n.buffer,byteLengths:t}})(n).buffer,{encrypted:a,plaintextMetadata:i}=JSON.parse(Fr(r)),o=await Qi.aesGcm.decrypt(e.dbKey,tt.decode(s)),c=await Qi.aesGcm.getKeyFromRawKey(o),u=await Qi.aesGcm.decrypt(c,Lr(a)),l=Fr(u),[d,h]=await Promise.all([ro(l),ro(i)]),f=oo(oo({},JSON.parse(d)),JSON.parse(h));return delete e.bundleChunks[t],f}async uploadBundle(e,t,s,n,r){let a=0,i=0,o=[];for(;a<r.byteLength;){const c=r.slice(a,a+uo);if(o.push(ao(e,t,s,n,i,c)),10===o.length){try{await Promise.all(o)}catch(e){return 0}o=[]}i+=1,a+=uo}try{await Promise.all(o)}catch(e){return 0}return i}async initBundleUpload(e,t,s){const n={dbId:e,seqNo:t};let r;try{r=await this.request("InitBundleUpload",n)}catch(e){return{}}const{bundleId:a}=r.data,[i,o]=await Qi.aesGcm.generateAndEncryptKeyEncryptionKey(s);return{bundleId:a,bundleEncryptionKey:i,encryptedBundleEncryptionKey:tt.encode(o)}}orderedItems(e,t){const s=[];for(let n=0;n<t.array.length;n++){const r=t.array[n].itemId;s.push(e[r])}return s}prepareBundle(e){const{items:t,itemsIndex:s,itemsPlaintextMetadata:n}=e;return{encrypted:JSON.stringify({items:this.orderedItems(t,s),itemsIndex:s.array}),plaintextMetadata:JSON.stringify({itemsPlaintextMetadata:this.orderedItems(n,s)})}}async buildBundle(e){const t=e.dbId,s=e.lastSeqNo,n=e.dbKey,r=this.session.userId;if(e.bundledAtSeqNo&&e.bundledAtSeqNo>=s)return;e.bundledAtSeqNo=s;const a=this.prepareBundle(e),i=e.attributionEnabled?[...e.usernamesByUserId.keys()].join(","):void 0,{bundleId:o,bundleEncryptionKey:c,encryptedBundleEncryptionKey:u}=await this.initBundleUpload(t,s,n);if(!o)return;const[l,d]=await Promise.all([no(a.encrypted),no(a.plaintextMetadata)]),h=Lr(l),f=await Qi.aesGcm.encrypt(c,h);a.encrypted=Fr(f),a.plaintextMetadata=d;const p=Lr(JSON.stringify(a)),m=await this.uploadBundle(r,t,s,o,p);if(!m)return;const w={dbId:t,seqNo:s,bundleId:o,writers:i,numChunks:m,encryptedBundleEncryptionKey:u};try{await this.request("CompleteBundleUpload",w)}catch(e){return}}buildUserResult({username:e,userId:t,authToken:s,email:n,profile:r,protectedProfile:a,usedTempPassword:i,changePassword:o,passwordChanged:c,userData:u}){const l={username:e,userId:t,authToken:s};if(n&&(l.email=n),r&&(l.profile=r),a&&(l.protectedProfile=a),i&&(l.usedTempPassword=i),o&&(l.changePassword=o),c&&(l.passwordChanged=c),u){const{creationDate:e,stripeData:t}=u;if(e&&(l.creationDate=e),t){const{paymentsMode:e,subscriptionStatus:s,cancelSubscriptionAt:n,subscriptionPlanId:r,trialExpirationDate:a}=t;e&&(l.paymentsMode=e),s&&(l.subscriptionStatus=s),n&&(l.cancelSubscriptionAt=n),r&&(l.subscriptionPlanId=r),a&&(l.trialExpirationDate=a)}}return l}handleUpdateUser(e){if(this.session&&this.session.userId===e.userId){this.session.username=e.username,this.userData=e.userData;const t=fr();t&&t({user:this.buildUserResult(oo({authToken:this.session.authToken},e))})}}async rotateKeys(e,t){const{keySalts:s,ecKeyData:n}=t,{ecdsaKeyData:r,ecdhKeyData:a}=n;s.ecdsaKeyEncryptionKeySalt=r.ecdsaKeyEncryptionKeySalt,s.ecdhKeyEncryptionKeySalt=a.ecdhKeyEncryptionKeySalt,this.keys.salts=s,this.ecKeyData=oo(oo({},r),a),await this.setKeys(e),this.keys.init=!0}async authenticateShareToken(e,t){const s={shareTokenId:e};let n;try{n=await this.request("AuthenticateShareToken",s)}catch(e){if(e.response&&"ShareTokenNotFound"===e.response.data)throw new or.ShareTokenNotFound;throw e}const{databaseId:r,shareTokenAuthKeyData:a,validationMessage:i}=n.data;let o;try{const e=tt.decode(a.shareTokenEcdsaKeyEncryptionKeySalt),s=await Qi.ecdsa.importEcdsaKeyEncryptionKeyFromMaster(t,e),n=tt.decode(a.shareTokenEncryptedEcdsaPrivateKey),r=await Qi.aesGcm.decrypt(s,n);o=await Qi.ecdsa.getPrivateKeyFromRawPrivateKey(r)}catch(e){throw new or.ShareTokenInvalid}const c=await Qi.ecdsa.sign(o,tt.decode(i));return{databaseId:r,validationMessage:i,signedValidationMessage:tt.encode(c)}}};function mo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function wo(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(s),!0).forEach((function(t){Ze(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):mo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const go={local:!0,session:!0,none:!0},yo="Device not recognized. This temporary password can only be used to sign in from a device you've signed in from before.",bo="Device not recognized. Forgot password only works from a device you've signed in from before.",vo=e=>{if(e.response){if("Domain not whitelisted"===e.response.data)throw new or.DomainNotWhitelisted(window.location.origin);if("App ID not valid"===e.response.data)throw new or.AppIdNotValid;if("UserNotFound"===e.response.data)throw new or.UserNotFound;if(e.response.status===lt)throw new or.InternalServerError;if(e.response.status===ht)throw new or.Timeout}else if(e.message&&-1!==e.message.indexOf("timeout"))throw new or.Timeout},Mo=async(e,t,s,n)=>{try{await po.connect(e,t,s,n)}catch(e){if(vo(e),"Web Socket already connected"===e.message)throw new or.UserAlreadySignedIn(e.username);throw e}},So=e=>{if(e.response&&"UsernameTooLong"===e.response.data.error)throw new or.UsernameTooLong(e.response.data.maxLen);if(e.response&&"PasswordAttemptLimitExceeded"===e.response.data.error)throw new or.PasswordAttemptLimitExceeded(e.response.data.delay)},Io=e=>{if(e.response&&e.response.data){const t=e.response.data;switch(t.error){case"SessionLengthTooShort":throw new or.SessionLengthTooShort(t.minLen);case"SessionLengthTooLong":throw new or.SessionLengthTooLong(t.maxLen)}}},Eo=(e,t)=>{if(vo(e),So(e),e.response){const s=e.response.data;switch(s){case"UsernameAlreadyExists":throw new or.UsernameAlreadyExists(t);case"TrialExceededLimit":throw new or.TrialExceededLimit;case"CurrentPasswordIncorrect":throw new or.CurrentPasswordIncorrect}switch(s.error){case"EmailNotValid":throw new or.EmailNotValid;case"ProfileMustBeObject":throw new or.ProfileMustBeObject;case"ProfileKeyTooLong":throw new or.ProfileKeyTooLong(s.maxLen,s.key);case"ProfileValueMustBeString":throw new or.ProfileValueMustBeString(s.key,s.value);case"ProfileValueCannotBeBlank":throw new or.ProfileValueCannotBeBlank(s.key);case"ProfileValueTooLong":throw new or.ProfileValueTooLong(s.maxLen,s.key,s.value);case"ProfileHasTooManyKeys":throw new or.ProfileHasTooManyKeys(s.maxKeys);case"ProfileCannotBeEmpty":throw new or.ProfileCannotBeEmpty}}throw e},Ao=e=>e&&60*e*60*1e3,Bo=e=>{if("string"!=typeof e)throw new or.UsernameMustBeString;if(0===e.length)throw new or.UsernameCannotBeBlank},ko=e=>{if("string"!=typeof e)throw new or.PasswordMustBeString;if(0===e.length)throw new or.PasswordCannotBeBlank;if(e.length<6)throw new or.PasswordTooShort(6);if(e.length>1e3)throw new or.PasswordTooLong(1e3)},Po=e=>{if("object"!=typeof e)throw new or.ParamsMustBeObject;if(!eo(e,"username"))throw new or.UsernameMissing;if(!eo(e,"password"))throw new or.PasswordMissing;if(Bo(e.username),ko(e.password),eo(e,"rememberMe")&&!go[e.rememberMe])throw new or.RememberMeValueNotValid(go);if(eo(e,"sessionLength")&&"number"!=typeof e.sessionLength)throw new or.SessionLengthMustBeNumber},xo=async(e,t,s)=>{const n=Qi.scrypt.generateSalt(),r=await Qi.scrypt.hash(e,n,s),a=await Qi.hkdf.importHkdfKeyFromString(r),i=Qi.hkdf.generateSalt(),o=await Qi.hkdf.getPasswordToken(a,i),c=Qi.hkdf.generateSalt(),u=await Qi.aesGcm.getPasswordBasedEncryptionKey(a,c),l=await Qi.aesGcm.encrypt(u,t);return{passwordToken:o,passwordSalts:{passwordSalt:tt.encode(n),passwordTokenSalt:tt.encode(i)},passwordBasedBackup:{passwordBasedEncryptionKeySalt:tt.encode(c),passwordEncryptedSeed:tt.encode(l)}}},Uo=async e=>{const t=await Qi.hkdf.importHkdfKey(e),s=Qi.hkdf.generateSalt(),n=Qi.hkdf.generateSalt(),r={encryptionKeySalt:tt.encode(s),hmacKeySalt:tt.encode(n)},a=await Qi.ecdsa.generateEcdsaKeyData(t),i=await Qi.ecdh.generateEcdhKeyData(t,a.ecdsaPrivateKey);delete a.ecdsaPrivateKey,delete i.ecdhPrivateKey;return{ecKeyData:{ecdsaKeyData:a,ecdhKeyData:i},keySalts:r}},No=e=>{if("object"!=typeof e)throw new or.ProfileMustBeObject;let t=!1;for(const s in e){t=!0;const n=e[s];if("string"!=typeof n)throw new or.ProfileValueMustBeString(s,n);if(!n)throw new or.ProfileValueCannotBeBlank(s)}if(!t)throw new or.ProfileCannotBeEmpty},To=async()=>{try{const e="GetPasswordSalts";return(await po.request(e)).data}catch(e){throw vo(e),e}},Do=async(e,t,s)=>{const{passwordSalt:n,passwordTokenSalt:r}=t,a=await Qi.scrypt.hash(e,new Uint8Array(tt.decode(n)),s),i=await Qi.hkdf.importHkdfKeyFromString(a);return{passwordHkdfKey:i,passwordToken:await Qi.hkdf.getPasswordToken(i,tt.decode(r))}},Ko=async(e,t)=>{let s;try{const n=Cr.getCurrentSession();if(!n)return{};const{signedIn:r,sessionId:a,creationDate:i,expirationDate:o,rememberMe:c}=n;s=n.username;const u=Cr.getSeedString(e,s);if(!r||!u||new Date>new Date(o))return{lastUsedUsername:s};let l;try{l=await Er(a,t)}catch(e){if(vo(e),Io(e),e.response&&"Session invalid"===e.response.data)return{lastUsedUsername:s};throw e}const{userId:d,authToken:h,username:f,email:p,profile:m,protectedProfile:w}=l;if(f!==s&&(Cr.saveSeedString(c,e,f,u),Cr.removeSeedString(e,s)),Cr.signInSession(c,f,a,i,l.expirationDate),po.connectionResolved){if(po.session.sessionId===a)return{user:po.buildUserResult({username:f,userId:d,authToken:po.session.authToken,email:p,profile:m,protectedProfile:w,userData:po.userData})};throw new or.UserAlreadySignedIn(po.session.username)}const g=wo(wo({},n),{},{username:f,userId:d,authToken:h});return await Mo(g,u,c),{user:po.buildUserResult({username:f,userId:d,authToken:h,email:p,profile:m,protectedProfile:w,userData:po.userData})}}catch(e){if("Invalid seed"===e.message)return{lastUsedUsername:s};throw vo(e),e}},Oo=async(e,t)=>{const s=Cr.getSeedString(e,t);if(!s)throw new or.KeyNotFound(bo);const n=tt.decode(s);return await Qi.hkdf.importHkdfKey(n)};var Ro={signUp:async e=>{try{(e=>{if(Po(e),e.profile&&No(e.profile),e.email&&"string"!=typeof e.email)throw new or.EmailNotValid})(e);const{password:t,profile:s,passwordHashAlgo:n,rememberMe:r="session"}=e,a=e.username.toLowerCase(),i=e.email&&e.email.toLowerCase(),o=hr(),c=await Qi.generateSeed(),u=Ao(e.sessionLength),{sessionId:l,creationDate:d,expirationDate:h,userId:f,authToken:p}=await(async(e,t,s,n,r,a,i)=>{const{passwordToken:o,passwordSalts:c,passwordBasedBackup:u}=await xo(t,s,n),{ecKeyData:l,keySalts:d}=await Uo(s);try{return await Mr(e,o,l,c,d,r,a,u,i)}catch(t){Io(t),Eo(t,e)}})(a,t,c,n,i,s,u),m={username:a,userId:f,sessionId:l,creationDate:d,expirationDate:h,authToken:p},w=tt.encode(c);return Cr.saveSeedString(r,o,a,w),Cr.signInSession(r,a,l,d,h),await Mo(m,w,r),po.buildUserResult({username:a,userId:f,authToken:p,email:i,profile:s,userData:po.userData})}catch(e){switch(e.name){case"ParamsMustBeObject":case"UsernameMissing":case"UsernameAlreadyExists":case"UsernameCannotBeBlank":case"UsernameMustBeString":case"UsernameTooLong":case"PasswordMissing":case"PasswordCannotBeBlank":case"PasswordTooShort":case"PasswordTooLong":case"PasswordMustBeString":case"EmailNotValid":case"ProfileMustBeObject":case"ProfileCannotBeEmpty":case"ProfileHasTooManyKeys":case"ProfileKeyTooLong":case"ProfileValueMustBeString":case"ProfileValueCannotBeBlank":case"ProfileValueTooLong":case"RememberMeValueNotValid":case"SessionLengthMustBeNumber":case"SessionLengthTooShort":case"SessionLengthTooLong":case"TrialExceededLimit":case"AppIdNotSet":case"AppIdNotValid":case"DomainNotWhitelisted":case"UserAlreadySignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},signOut:async()=>{try{if(!po.session.username)throw new or.UserNotSignedIn;try{await po.signOut()}catch(e){throw vo(e),e}}catch(e){switch(e.name){case"UserNotSignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},signIn:async e=>{try{Po(e);const t=e.username.toLowerCase(),{password:s,passwordHashAlgo:n,rememberMe:r="session"}=e,a=hr(),i=await(async e=>{try{return await Sr(e)}catch(e){if(vo(e),So(e),e.response&&"User not found"===e.response.data)throw new or.UsernameOrPasswordMismatch;throw e}})(t),{passwordHkdfKey:o,passwordToken:c}=await Do(s,i,n),u=Ao(e.sessionLength),l=await(async(e,t,s)=>{try{return await Ir(e,t,s)}catch(e){if(vo(e),So(e),Io(e),e.response&&"Invalid password"===e.response.data)throw new or.UsernameOrPasswordMismatch;if(e.response&&"User pending deletion"===e.response.data)throw new or.UserPendingDeletion;throw e}})(t,c,u),{userId:d,email:h,profile:f,passwordBasedBackup:p,protectedProfile:m,usedTempPassword:w,changePassword:g}=l,y=wo(wo({},l.session),{},{username:t,userId:d});let b;if(!g){const e=Cr.getSeedString(a,t);let s;if(!e&&w)throw new or.KeyNotFound(yo);w||(s=await(async(e,t)=>{const{passwordBasedEncryptionKeySalt:s,passwordEncryptedSeed:n}=t,r=await Qi.aesGcm.getPasswordBasedEncryptionKey(e,tt.decode(s)),a=await Qi.aesGcm.decrypt(r,tt.decode(n));return tt.encode(a)})(o,p),Cr.saveSeedString(r,a,t,s)),b=s||e}Cr.signInSession(r,t,y.sessionId,y.creationDate,y.expirationDate);try{await Mo(y,b,r,g)}catch(e){if(w&&"Invalid seed"===e.message)throw new or.KeyNotFound(yo);throw e}return po.buildUserResult({username:t,userId:d,authToken:y.authToken,email:h,profile:f,protectedProfile:m,usedTempPassword:w,changePassword:g,userData:po.userData})}catch(e){switch(e.name){case"ParamsMustBeObject":case"UsernameMissing":case"UsernameOrPasswordMismatch":case"UserPendingDeletion":case"UsernameCannotBeBlank":case"UsernameTooLong":case"UsernameMustBeString":case"PasswordMissing":case"PasswordCannotBeBlank":case"PasswordTooShort":case"PasswordTooLong":case"PasswordMustBeString":case"PasswordAttemptLimitExceeded":case"RememberMeValueNotValid":case"SessionLengthMustBeNumber":case"SessionLengthTooShort":case"SessionLengthTooLong":case"KeyNotFound":case"AppIdNotSet":case"AppIdNotValid":case"DomainNotWhitelisted":case"UserAlreadySignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},init:async e=>{try{if(!window.crypto.subtle)throw new or.WebCryptoUnavailable;if("object"!=typeof e)throw new or.ParamsMustBeObject;if(!eo(e,"appId"))throw new or.AppIdMissing;if("string"!=typeof e.appId)throw new or.AppIdMustBeString;if(0===e.appId.length)throw new or.AppIdCannotBeBlank;if(eo(e,"updateUserHandler")&&"function"!=typeof e.updateUserHandler)throw new or.UpdateUserHandlerMustBeFunction;if(eo(e,"sessionLength")&&"number"!=typeof e.sessionLength)throw new or.SessionLengthMustBeNumber;if(eo(e,"allowServerSideEncryption")&&"boolean"!=typeof e.allowServerSideEncryption)throw new or.AllowServerSideEncryptionMustBeBoolean;mr(e);return await Ko(e.appId,Ao(e.sessionLength))}catch(e){switch(e.name){case"WebCryptoUnavailable":case"ParamsMustBeObject":case"AppIdMissing":case"AppIdAlreadySet":case"AppIdMustBeString":case"AppIdCannotBeBlank":case"AppIdNotValid":case"DomainNotWhitelisted":case"UpdateUserHandlerMustBeFunction":case"SessionLengthMustBeNumber":case"SessionLengthTooShort":case"SessionLengthTooLong":case"AllowServerSideEncryptionMustBeBoolean":case"UserAlreadySignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},updateUser:async e=>{try{if("object"!=typeof e)throw new or.ParamsMustBeObject;if((e=>{if(!(eo(e,"username")||eo(e,"newPassword")||eo(e,"email")||eo(e,"profile")))throw new or.ParamsMissing;const{username:t,currentPassword:s,newPassword:n,email:r,profile:a}=e;if(eo(e,"username")&&Bo(t),eo(e,"newPassword")){if(!eo(e,"currentPassword"))throw new or.CurrentPasswordMissing;ko(s),ko(n)}if(r&&"string"!=typeof r)throw new or.EmailNotValid;a&&No(a)})(e),po.reconnecting)throw new or.Reconnecting;if(!po.connectionResolved)throw new or.UserNotSignedIn;const t=po.session.userId,s=e.newPassword&&!po.keys.init&&po.changePassword&&await Qi.generateSeed(),n="UpdateUser",r=await(async(e,t)=>{if(e.username&&(e.username=e.username.toLowerCase()),e.newPassword){const[s,n,r]=await Promise.all([To(),xo(e.newPassword,t||tt.decode(po.seedString)),t&&Uo(t)]),{passwordToken:a}=await Do(e.currentPassword,s,e.passwordHashAlgo);e.currentPasswordToken=a,delete e.currentPassword,e.passwordToken=n.passwordToken,e.passwordSalts=n.passwordSalts,e.passwordBasedBackup=n.passwordBasedBackup,delete e.newPassword,r&&(e.newKeyData=r)}return e.email?e.email=e.email.toLowerCase():eo(e,"email")&&(e.email=!1),!e.profile&&eo(e,"profile")&&(e.profile=!1),e})(wo({},e),s);if(po.reconnecting)throw new or.Reconnecting;if(!po.connectionResolved)throw new or.UserNotSignedIn;if(!po.session||t!==po.session.userId)throw new or.ServiceUnavailable;try{r.username&&Cr.saveSeedString(po.rememberMe,hr(),r.username,po.seedString);const e=(await po.request(n,r)).data.updatedUser;if(po.handleUpdateUser(e),s&&po.session&&t===po.session.userId){const t=tt.encode(s);await po.rotateKeys(t,r.newKeyData),Cr.saveSeedString(po.rememberMe,hr(),e.username,t);const{sessionId:n,creationDate:a,expirationDate:i}=po.session;Cr.signInSession(po.rememberMe,e.username,n,a,i)}}catch(e){Eo(e,r.username)}}catch(e){switch(e.name){case"ParamsMustBeObject":case"ParamsMissing":case"UsernameAlreadyExists":case"UsernameMustBeString":case"UsernameCannotBeBlank":case"UsernameTooLong":case"CurrentPasswordMissing":case"CurrentPasswordIncorrect":case"PasswordAttemptLimitExceeded":case"PasswordMustBeString":case"PasswordCannotBeBlank":case"PasswordTooShort":case"PasswordTooLong":case"EmailNotValid":case"ProfileMustBeObject":case"ProfileCannotBeEmpty":case"ProfileHasTooManyKeys":case"ProfileKeyTooLong":case"ProfileValueMustBeString":case"ProfileValueCannotBeBlank":case"ProfileValueTooLong":case"AppIdNotSet":case"AppIdNotValid":case"UserNotFound":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},deleteUser:async()=>{try{(()=>{if(po.reconnecting)throw new or.Reconnecting;if(!po.keys.init&&po.changePassword)throw new or.UserMustChangePassword;if(!po.keys.init)throw new or.UserNotSignedIn})();const e=po.session.username;Cr.removeSeedString(hr(),e),Cr.removeCurrentSession();try{const e="DeleteUser";await po.request(e)}catch(e){throw vo(e),e}po.close()}catch(e){switch(e.name){case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},forgotPassword:async e=>{try{if("object"!=typeof e)throw new or.ParamsMustBeObject;if(eo(e,"deleteEndToEndEncryptedData")&&"boolean"!=typeof e.deleteEndToEndEncryptedData)throw new or.DeleteEndToEndEncryptedDataMustBeBoolean;if(!eo(e,"username"))throw new or.UsernameMissing;Bo(e.username);const t=e.username.toLowerCase(),s=hr(),n="".concat(Yi(pr()),"/api/auth/forgot-password?appId=").concat(s,"&username=").concat(encodeURIComponent(t),"&userbaseJsVersion=").concat(dr),r=new WebSocket(n+(eo(e,"deleteEndToEndEncryptedData")?"&deleteEndToEndEncryptedData=".concat(e.deleteEndToEndEncryptedData):""));await new Promise(((e,n)=>{setTimeout((()=>n(new or.Timeout)),15e3),r.onerror=()=>n(new or.ServiceUnavailable),r.onmessage=async a=>{try{const i=JSON.parse(a.data);switch(i.route){case"ReceiveEncryptedToken":{const e=await Oo(s,t),n=new Uint8Array(i.encryptedForgotPasswordToken.data),a=await Qi.diffieHellman.importKeyFromMaster(e,tt.decode(i.dhKeySalt)),o=await Qi.diffieHellman.getSharedKeyWithServer(a);let c;try{c=tt.encode(await Qi.aesGcm.decrypt(o,n))}catch(e){throw new or.KeyNotFound(bo)}r.send(JSON.stringify({action:"ForgotPassword",params:{forgotPasswordToken:c}}));break}case"ReceiveToken":{const e=await Oo(s,t),{ecdsaKeyEncryptionKeySalt:n,encryptedEcdsaPrivateKey:a,forgotPasswordToken:o}=i,c=await Qi.ecdsa.importEcdsaKeyEncryptionKeyFromMaster(e,tt.decode(n));let u;try{const e=await Qi.aesGcm.decrypt(c,tt.decode(a));u=await Qi.ecdsa.getPrivateKeyFromRawPrivateKey(e)}catch(e){throw new or.KeyNotFound(bo)}const l=tt.encode(await Qi.ecdsa.sign(u,tt.decode(o)));r.send(JSON.stringify({action:"ForgotPassword",params:{signedForgotPasswordToken:l}}));break}case"SuccessfullyForgotPassword":e();break;case"Error":{const e=i.data;switch(e.name){case"UsernameTooLong":throw new or.UsernameTooLong(e.maxLen);case"AppIdNotValid":throw new or.AppIdNotValid;case"UserNotFound":throw new or.UserNotFound;case"UserEmailNotFound":throw new or.UserEmailNotFound;default:throw i.status===lt?new or.ServiceUnavailable:new or.UnknownServiceUnavailable(e)}}case"Ping":break;default:n(new Error("Received unknown message from userbase-server: ".concat(a.data)))}}catch(a){n(a)}}})),r.close()}catch(e){switch(e.name){case"ParamsMustBeObject":case"UsernameMissing":case"UsernameMustBeString":case"UsernameCannotBeBlank":case"UsernameTooLong":case"AppIdNotSet":case"AppIdNotValid":case"KeyNotFound":case"UserNotFound":case"UserEmailNotFound":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}}},Co=Xe((function(e){var t=function(){var e,t,s=((t=(e={constructor:function(e,t){this.array=[],this.compare=t||n;for(var s=e.length,r=0;r<s;)this.insert(e[r++])},insert:function(e){for(var t,s,n=this.array,r=this.compare,a=n.length-1,i=0,o=-1;a>=i;)if((s=r(n[t=(a+i)/2>>>0],e))<0)i=t+1;else{if(!(s>0)){o=t;break}a=t-1}for(-1===o&&(o=a),o++,a=n.length-1;o<a&&0===r(e,n[o]);)o++;for(t=n.length,n.push(e);t>o;)n[t]=n[--t];return n[o]=e,this},search:function(e){for(var t,s,n=this.array,r=this.compare,a=n.length-1,i=0;a>=i;)if((s=r(n[t=(a+i)/2>>>0],e))<0)i=t+1;else{if(!(s>0))return t;a=t-1}return-1},remove:function(e){var t=this.search(e);return t>=0&&this.array.splice(t,1),this}}).constructor).prototype=e,t);return s.comparing=function(e,t){return new s(t,(function(t,s){return n(t[e],s[e])}))},s;function n(e,t){return e<t?-1:e>t?1:0}}();e.exports=t}));function Fo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Lo(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Fo(Object(s),!0).forEach((function(t){Ze(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Fo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const qo="Success",jo=100,Vo=524288,_o="__userbase_verified_users",Ho={"end-to-end":!0,"server-side":!0},$o=()=>{if(po.reconnecting)throw new or.Reconnecting;if(!po.keys.init&&po.changePassword)throw new or.UserMustChangePassword;if(!po.keys.init||!Ho[po.encryptionMode])throw new or.UserNotSignedIn},Go=e=>{if(e.response){if("UserNotFound"===e.response.data)throw new or.UserNotFound;if(e.response.status===lt)throw new or.InternalServerError;if(e.response.status===ht)throw new or.Timeout}else if(e.message&&-1!==e.message.indexOf("timeout"))throw new or.Timeout};class Jo{constructor(e){this.startSeqNo=e,this.txSeqNo=null,this.transactions={},this.promiseResolve=null,this.promiseReject=null,this.index=null}getStartSeqNo(){return this.startSeqNo}getIndex(){return this.index}setIndex(e){this.index=e}async getResult(e){this.txSeqNo=e;const t=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,setTimeout((()=>{t(new Error("timeout"))}),3e4)}));return this.verifyPromise(),t}verifyPromise(){(this.txSeqNo||0==this.txSeqNo)&&this.promiseResolve&&this.promiseReject&&this.transactions[this.txSeqNo]&&("Success"==this.transactions[this.txSeqNo]?this.promiseResolve():this.promiseReject(this.transactions[this.txSeqNo]))}addTransaction(e,t){this.transactions[e.seqNo]||(this.transactions[e.seqNo]=t,this.verifyPromise())}}class zo{constructor(e,t,s,n){this.onChange=Wo(e),this.items={},this.itemsPlaintextMetadata={},this.fileIds={};this.itemsIndex=new Co([],((e,t)=>e.seqNo<t.seqNo||e.seqNo===t.seqNo&&e.operationIndex<t.operationIndex?-1:e.seqNo>t.seqNo||e.seqNo===t.seqNo&&e.operationIndex>t.operationIndex?1:0)),this.unverifiedTransactions=[],this.lastSeqNo=0,this.init=!1,this.dbKey=null,this.receivedMessage=t,this.usernamesByUserId=new Map,this.attributionEnabled=!1,this.shareTokenId=s,this.shareTokenHkdfKey=n,this.applyTransactionsQueue=new to,this.bundleChunks={}}async applyTransactions(e,t,s,n){for(let s=0;s<e.length;s++){const n=e[s],r=n.seqNo;if(r!==this.lastSeqNo+1){console.warn("Client attempted to apply transaction with seq no ".concat(r," when last seq no is ").concat(this.lastSeqNo));continue}const a=await this.applyTransaction(this.dbKey,n,t);this.lastSeqNo=r;for(let t=0;t<this.unverifiedTransactions.length;t++)!this.unverifiedTransactions[t]||r<this.unverifiedTransactions[t].getStartSeqNo()||this.unverifiedTransactions[t].addTransaction(e[s],a);this.init&&"Success"===a&&this.onChange(this.getItems())}this.init||(this.init=!0,this.dbId=s,this.dbNameHash=n,this.onChange(this.getItems()),this.receivedMessage())}async applyBundle(e,t){if(0===this.lastSeqNo){for(let t=0;t<e.itemsIndex.length;t++){const s=e.itemsIndex[t],n=e.itemsIndex[t].itemId,r=e.items[t],a=e.itemsPlaintextMetadata[t];r.file&&r.file.fileEncryptionKeyString&&(r.file.fileEncryptionKey=await Qi.aesGcm.getKeyFromKeyString(r.file.fileEncryptionKeyString),this.fileIds[r.file.fileId]=n),this.items[n]=r,this.itemsPlaintextMetadata[n]=a,this.itemsIndex.insert(s)}this.lastSeqNo=t}else console.warn("Client attempted to apply bundle when last seq no is ".concat(this.lastSeqNo))}async applyTransaction(e,t,s){const n=t.seqNo,r=t.command;switch(r){case"Insert":try{const s=await Qi.aesGcm.decryptJson(e,t.record),r=s.id,a=s.item,i=this.attributionFromTransaction(t),o=t.writeAccess;return this.validateInsert(r),this.applyInsert(r,n,a,i,o)}catch(e){return e}case"Update":try{const n=await Qi.aesGcm.decryptJson(e,t.record),r=n.id,a=n.item,i=this.attributionFromTransaction(t),o=n.__v,c=t.writeAccess;return this.validateUpdate(r,o,i,s,c,"updateItem"),this.applyUpdate(r,a,o,i,c)}catch(e){return e}case"Delete":try{const n=await Qi.aesGcm.decryptJson(e,t.record),r=n.id,a=this.attributionFromTransaction(t),i=n.__v;return this.validateUpdateOrDelete(r,i,a,s,"deleteItem"),this.applyDelete(r)}catch(e){return e}case"BatchTransaction":try{const r=t.operations,a=this.attributionFromTransaction(t),i=[];for(const t of r)i.push(t.record&&Qi.aesGcm.decryptJson(e,t.record));const o=await Promise.all(i);return this.validateBatchTransaction(r,o,a,s),this.applyBatchTransaction(n,r,o,a)}catch(e){return e}case"UploadFile":try{const n=await Qi.aesGcm.decrypt(e,tt.decode(t.fileEncryptionKey)),r=await Qi.aesGcm.getKeyFromRawKey(n),a=await Qi.aesGcm.getKeyStringFromKey(r),i=await Qi.aesGcm.decryptJson(r,t.fileMetadata),o=i.itemId,c=i.__v,{fileName:u,fileSize:l,fileType:d}=i,h=t.fileId,f=this.attributionFromTransaction(t);return this.validateUploadFile(o,c,f,s,"uploadFile"),this.applyUploadFile(o,f,c,r,a,u,h,l,d)}catch(e){return e}case"Rollback":return;default:return void console.warn("Unknown command: ".concat(r))}}attributionFromTransaction(e){if(this.attributionEnabled)return{timestamp:e.timestamp,userId:e.userId}}validateInsert(e){if(this.items[e])throw new or.ItemAlreadyExists}validateUpdate(e,t,s,n,r,a){this.validateUpdateOrDelete(e,t,s,n,a);const{createdBy:i}=this.itemsPlaintextMetadata[e];if(r||!1===r){if(!i)return;const e=i.userId,t=s.userId;if(e!==t&&t!==n)throw new or.WriteAccessParamNotAllowed}}validateUpdateOrDelete(e,t,s,n,r){if(!this.items[e])throw new or.ItemDoesNotExist;if(t<=this.getItemVersionNumber(e))throw new or.ItemUpdateConflict;this.validateAccessPermissions(e,s,n,r)}validateUploadFile(e,t,s,n,r){if(!this.items[e])throw new or.ItemDoesNotExist;if(t<=this.getFileVersionNumber(e))throw new or.FileUploadConflict;this.validateAccessPermissions(e,s,n,r)}validateAccessPermissions(e,t,s,n){const{createdBy:r,writeAccess:a}=this.itemsPlaintextMetadata[e];if(r&&t&&a){const e=r.userId,i=t.userId;let o=!1;const{onlyCreator:c,users:u}=a;if(i===s||i===e)o=!0;else if(!c&&u)for(const{userId:e}of u)if(o=i===e,o)break;if(!o)throw new or.TransactionUnauthorized(n)}}itemExists(e){return eo(this.items,e)}applyInsert(e,t,s,n,r,a){const i={seqNo:t};if("number"==typeof a&&(i.operationIndex=a),this.items[e]=Lo(Lo({},i),{},{record:s,__v:0}),this.itemsPlaintextMetadata[e]={createdBy:n,writeAccess:r},this.itemsIndex.insert(Lo(Lo({},i),{},{itemId:e})),r&&r.users)for(const{userId:e,username:t}of r.users)this.usernamesByUserId.set(e,t);return qo}applyUpdate(e,t,s,n,r){if(this.items[e].record=t,this.items[e].__v=s,this.itemsPlaintextMetadata[e].updatedBy=n,!1===r)delete this.itemsPlaintextMetadata[e].writeAccess;else if(r&&(this.itemsPlaintextMetadata[e].writeAccess=r,r.users))for(const{userId:e,username:t}of r.users)this.usernamesByUserId.set(e,t);return qo}applyUploadFile(e,t,s,n,r,a,i,o,c){const u=this.items[e].file;return u&&delete this.fileIds[u.fileId],this.items[e].file={fileName:a,fileId:i,fileSize:o,fileType:c,fileEncryptionKey:n,fileEncryptionKeyString:r,__v:s},this.itemsPlaintextMetadata[e].fileUploadedBy=t,this.fileIds[i]=e,qo}applyDelete(e){return this.itemsIndex.remove(this.items[e]),delete this.items[e],delete this.itemsPlaintextMetadata[e],qo}validateBatchTransaction(e,t,s,n){const r={};for(let a=0;a<e.length;a++){const i=e[a],{command:o,writeAccess:c}=i,u=t[a].id,l=t[a].__v;if(r[u])throw new or.OperationsConflict;switch(r[u]=!0,o){case"Insert":this.validateInsert(u);break;case"Update":this.validateUpdate(u,l,s,n,c,o);break;case"Delete":this.validateUpdateOrDelete(u,l,s,n,o)}}}applyBatchTransaction(e,t,s,n){for(let r=0;r<t.length;r++){const a=t[r],i=s[r].id,o=s[r].item,c=s[r].__v,u=a.writeAccess;switch(a.command){case"Insert":this.applyInsert(i,e,o,n,u,r);break;case"Update":this.applyUpdate(i,o,c,n,u);break;case"Delete":this.applyDelete(i,c)}}return qo}registerUnverifiedTransaction(){const e=new Jo(this.lastSeqNo),t=this.unverifiedTransactions.push(e);return e.setIndex(t-1),e}unregisterUnverifiedTransaction(e){delete this.unverifiedTransactions[e.getIndex()]}getItems(){const e=[];for(let t=0;t<this.itemsIndex.array.length;t++){const s=this.itemsIndex.array[t].itemId,n={itemId:s,item:this.items[s].record};if(this.items[s].file){const{fileId:e,fileName:t,fileSize:r}=this.items[s].file;n.fileId=e,n.fileName=t,n.fileSize=r}for(const e of["createdBy","updatedBy","fileUploadedBy"])if(this.itemsPlaintextMetadata[s][e]){const{timestamp:t,userId:r}=this.itemsPlaintextMetadata[s][e],a={timestamp:t},i=this.usernamesByUserId.get(r);null==i?a.userDeleted=!0:a.username=i,n[e]=a}if(this.itemsPlaintextMetadata[s].writeAccess){const{onlyCreator:e,users:t}=this.itemsPlaintextMetadata[s].writeAccess,r={};if(e&&(r.onlyCreator=e),t){r.users=[];for(const{userId:e}of t){const t=this.usernamesByUserId.get(e);t&&r.users.push({username:t})}}n.writeAccess=r}e.push(n)}return e}getItemVersionNumber(e){return this.items[e].__v}getFileVersionNumber(e){return this.items[e].file&&this.items[e].file.__v}async decryptShareTokenEncryptedDbKey(e,t){const s=await Qi.aesGcm.importKeyFromMaster(this.shareTokenHkdfKey,tt.decode(t));return await Qi.aesGcm.decryptString(s,e)}}const Wo=e=>t=>{try{e(t)}catch(e){console.error("There was an error in your changeHandler.\n\n",e)}},Qo=(e,t,s)=>{e.onChange=Wo(t);const n=e.receivedMessage;return e.receivedMessage=()=>{n(),s()},!!e.init&&(e.onChange(e.getItems()),e.receivedMessage(),!0)},Zo=e=>{const t=e.slice(0,36),s=Fr(t,!0);if(!s||36!==s.length)throw new or.ShareTokenInvalid;return s},Yo=async(e,t,s)=>{let n,r;try{n=(e=>{const t=tt.decode(e);return{shareTokenId:Zo(t),shareTokenSeed:t.slice(36)}})(e),r=await Qi.hkdf.importHkdfKey(n.shareTokenSeed)}catch(e){throw new or.ShareTokenInvalid}const{shareTokenId:a}=n,{databaseId:i,validationMessage:o,signedValidationMessage:c}=await po.authenticateShareToken(a,r);po.state.shareTokenIdToDbId[a]=i,await Xo(i,t,s,a,r,o,c)},Xo=async(e,t,s,n,r,a,i)=>{const o=po.state.databasesByDbId[e];if(o){if(Qo(o,t,s))return}else po.state.databasesByDbId[e]=new zo(t,s,n,r);const c={databaseId:e,validationMessage:a,signedValidationMessage:i};await po.request("OpenDatabaseByDatabaseId",c)},ec=async(e,t)=>{try{let s,n;const r=new Promise(((e,t)=>{s=e,n=setTimeout((()=>t(new Error("timeout"))),3e4)})),{dbNameHash:a,newDatabaseParams:i,databaseId:o,shareToken:c}=t;try{a?await(async(e,t,s,n)=>{const r=po.state.databases[e];if(r){if(Qo(r,s,n))return}else po.state.databases[e]=new zo(s,n);const a={dbNameHash:e,newDatabaseParams:t};await po.request("OpenDatabase",a)})(a,i,e,s):o?await Xo(o,e,s):c&&await Yo(c,e,s),await r}catch(e){if(clearTimeout(n),e.response&&e.response.data){const t=e.response.data;if("Database already creating"===t)throw new or.DatabaseAlreadyOpening;if("Database is owned by user"===t){if(o)throw new or.DatabaseIdNotAllowedForOwnDatabase;if(c)throw new or.ShareTokenNotAllowedForOwnDatabase}else if("Database key not found"===t||"Database not found"===t)throw new or.DatabaseNotFound;switch(t.name){case"SubscriptionNotFound":throw new or.SubscriptionNotFound;case"SubscriptionInactive":throw new or.SubscriptionInactive(t.subscriptionStatus);case"TrialExpired":throw new or.TrialExpired}}throw e}}catch(e){throw Go(e),e}},tc=e=>{if("server-side"===e&&!gr())throw new or.ServerSideEncryptionNotEnabledInClient},sc=e=>{if("object"!=typeof e)throw new or.ParamsMustBeObject;if(eo(e,"databaseName")){if((e=>{if("string"!=typeof e)throw new or.DatabaseNameMustBeString;if(0===e.length)throw new or.DatabaseNameCannotBeBlank;if(e.length>100)throw new or.DatabaseNameTooLong(100)})(e.databaseName),eo(e,"databaseId"))throw new or.DatabaseIdNotAllowed;if(eo(e,"shareToken"))throw new or.ShareTokenNotAllowed;if(!e.allowVerifiedUsersDatabase&&e.databaseName===_o)throw new or.DatabaseNameRestricted(_o)}else if(eo(e,"databaseId")){if((e=>{if("string"!=typeof e)throw new or.DatabaseIdMustBeString;if(0===e.length)throw new or.DatabaseIdCannotBeBlank;if(36!==e.length)throw new or.DatabaseIdInvalidLength(36)})(e.databaseId),eo(e,"shareToken"))throw new or.ShareTokenNotAllowed}else{if(!eo(e,"shareToken"))throw new or.DatabaseNameMissing;if("string"!=typeof e.shareToken)throw new or.ShareTokenInvalid}if(eo(e,"encryptionMode")&&!Ho[e.encryptionMode])throw new or.EncryptionModeNotValid(Ho);$o()},nc=async e=>{try{if(sc(e),!eo(e,"changeHandler"))throw new or.ChangeHandlerMissing;const{databaseName:t,databaseId:s,shareToken:n,changeHandler:r,encryptionMode:a=po.encryptionMode}=e;if("function"!=typeof r)throw new or.ChangeHandlerMustBeFunction;if(tc(a),t){const e="server-side"===a?t:po.state.dbNameToHash[t]||await Qi.hmac.signString(po.keys.hmacKey,t);"end-to-end"===a&&(po.state.dbNameToHash[t]=e);const s={dbNameHash:e,newDatabaseParams:await(async(e,t)=>{const s=Nr(),n=await Qi.aesGcm.generateKey(),r=await Qi.aesGcm.getKeyStringFromKey(n),[a,i]=await Promise.all([Qi.aesGcm.encryptString(po.keys.encryptionKey,r),Qi.aesGcm.encryptString(n,e)]),o={dbId:s,encryptedDbKey:a,encryptedDbName:i,attribution:!0};return"server-side"===t&&(o.plaintextDbKey=r),o.fingerprint=await Bc(),o})(t,a)};await ec(r,s)}else if(s){const e={databaseId:s};await ec(r,e)}else{const e={shareToken:n};await ec(r,e)}}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseAlreadyOpening":case"DatabaseNameMustBeString":case"DatabaseNameMissing":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"DatabaseIdNotAllowedForOwnDatabase":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"ShareTokenNotFound":case"ShareTokenNotAllowedForOwnDatabase":case"DatabaseNotFound":case"ChangeHandlerMissing":case"ChangeHandlerMustBeFunction":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"SubscriptionNotFound":case"SubscriptionInactive":case"TrialExpired":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},rc=(e,t,s,n="end-to-end")=>{tc(n);const r=s&&Zo(tt.decode(s)),a="server-side"===n?e:po.state.dbNameToHash[e],i=e?po.state.databases[a]:po.state.databasesByDbId[t||po.state.shareTokenIdToDbId[r]];if(!i||!i.init)throw new or.DatabaseNotOpen;return i},ac=async e=>{try{sc(e);const t=rc(e.databaseName,e.databaseId,e.shareToken,e.encryptionMode||po.encryptionMode),s="Insert",n=await ic(t,e);await lc(t,s,n)}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"ItemIdMustBeString":case"ItemIdCannotBeBlank":case"ItemIdTooLong":case"ItemMissing":case"ItemInvalid":case"ItemTooLarge":case"ItemAlreadyExists":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},ic=async(e,t)=>{if(!eo(t,"item"))throw new or.ItemMissing;const{item:s,itemId:n,writeAccess:r}=t;if(eo(t,"itemId")){if("string"!=typeof n)throw new or.ItemIdMustBeString;if(0===n.length)throw new or.ItemIdCannotBeBlank;if(n.length>jo)throw new or.ItemIdTooLong(jo)}const a=JSON.stringify(s);if(!a)throw new or.ItemInvalid;if(Xi(a)>10240)throw new or.ItemTooLarge(10);const i=n||Nr(),o={id:i,item:s};return{itemKey:await Qi.hmac.signString(po.keys.hmacKey,i),encryptedItem:await Qi.aesGcm.encryptJson(e.dbKey,o),writeAccess:r}},oc=async e=>{try{sc(e);const t=rc(e.databaseName,e.databaseId,e.shareToken,e.encryptionMode||po.encryptionMode),s="Update",n=await cc(t,e);await lc(t,s,n)}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"ItemIdMissing":case"ItemIdMustBeString":case"ItemIdCannotBeBlank":case"ItemIdTooLong":case"ItemMissing":case"ItemInvalid":case"ItemTooLarge":case"ItemDoesNotExist":case"ItemUpdateConflict":case"WriteAccessParamNotAllowed":case"TransactionUnauthorized":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},cc=async(e,t)=>{if(!eo(t,"item"))throw new or.ItemMissing;if(!eo(t,"itemId"))throw new or.ItemIdMissing;!t.writeAccess&&eo(t,"writeAccess")&&(t.writeAccess=!1);const{item:s,itemId:n,writeAccess:r}=t;if("string"!=typeof n)throw new or.ItemIdMustBeString;if(0===n.length)throw new or.ItemIdCannotBeBlank;if(n.length>jo)throw new or.ItemIdTooLong(jo);if(!e.itemExists(n))throw new or.ItemDoesNotExist;const a=JSON.stringify(s);if(!a)throw new or.ItemInvalid;if(Xi(a)>10240)throw new or.ItemTooLarge(10);const i={id:n,item:s,__v:e.getItemVersionNumber(n)+1};return{itemKey:await Qi.hmac.signString(po.keys.hmacKey,n),encryptedItem:await Qi.aesGcm.encryptJson(e.dbKey,i),writeAccess:r}},uc=async(e,t)=>{if(!eo(t,"itemId"))throw new or.ItemIdMissing;const{itemId:s}=t;if("string"!=typeof s)throw new or.ItemIdMustBeString;if(0===s.length)throw new or.ItemIdCannotBeBlank;if(s.length>jo)throw new or.ItemIdTooLong(jo);if(!e.itemExists(s))throw new or.ItemDoesNotExist;const n={id:s,__v:e.getItemVersionNumber(s)+1};return{itemKey:await Qi.hmac.signString(po.keys.hmacKey,s),encryptedItem:await Qi.aesGcm.encryptJson(e.dbKey,n)}},lc=async(e,t,s)=>{try{const n=e.registerUnverifiedTransaction(),r=Lo(Lo({},s),{},{dbId:e.dbId,dbNameHash:e.dbNameHash}),a=(await po.request(t,r)).data.sequenceNo;return await n.getResult(a),e.unregisterUnverifiedTransaction(n),a}catch(e){if(Go(e),e.response){if("DatabaseIsReadOnly"===e.response.data.name)throw new or.DatabaseIsReadOnly;if("UserNotFound"===e.response.data.message)throw new or.UserNotFound(e.response.data.username)}throw e}},dc=async(e,t,s,n,r,a,i,o)=>{const c=await(async e=>{const t=new FileReader;return new Promise(((s,n)=>{t.onload=e=>{e.target.error?n(e.target.error):s(e.target.result)},t.readAsArrayBuffer(e)}))})(t),[u,l]=await Qi.aesGcm.generateAndEncryptKeyEncryptionKey(r),d=await Qi.aesGcm.encrypt(u,c),h={dbId:s,chunkNumber:a,fileId:n,chunk:Fr(new Uint8Array(d)),chunkEncryptionKey:Fr(new Uint8Array(l))},f=(async(e,t,s,n)=>{await e,t.bytesTransferred+=n,s&&s(Lo({},t))})(po.request("UploadFileChunk",h),i,o,t.size);e.push(f),10===e.length&&(await Promise.all(e),e.length=0)},hc=async(e,t,s,n)=>{try{const r="GetChunk",a={dbId:e,fileId:t,chunkNumber:s},i=(await po.request(r,a)).data,o=new Uint8Array(new Uint16Array(Lr(i.chunk))).buffer,c=new Uint8Array(new Uint16Array(Lr(i.chunkEncryptionKey))).buffer,u=await Qi.aesGcm.decrypt(n,c),l=await Qi.aesGcm.getKeyFromRawKey(u);return await Qi.aesGcm.decrypt(l,o)}catch(e){throw Go(e),e}},fc=async(e,t,s)=>{const{username:n,senderUsername:r,verificationValues:a}=s,{sentSignature:i,receivedSignature:o,senderEcdsaPublicKey:c}=a,u=t[n]&&t[n].record.fingerprint,l=tt.decode(c),d=t[r]&&t[r].record.fingerprint||await Ac(l),h=await Qi.ecdsa.getPublicKeyFromRawPublicKey(l),f=await bc(e,u),p=await Qi.ecdsa.verifyString(h,i,f),m=await Qi.ecdsa.getPublicKeyFromRawPublicKey(tt.decode(a.recipientEcdsaPublicKey)),w=await bc(e,d),g=await Qi.ecdsa.verifyString(m,o,w);return p&&g},pc=async(e,t,s,n,r)=>{const{mySentSignature:a,myReceivedSignature:i}=r,o=await bc(e,t),c=await Qi.ecdsa.verifyString(n,i,o);if(!c)return c;const u=await bc(e,s),l=await Qi.ecdsa.getPublicKeyFromRawPublicKey(tt.decode(r.mySenderEcdsaPublicKey));return await Qi.ecdsa.verifyString(l,a,u)&&c},mc=async(e,t,s,n,r)=>{const{sentSignature:a,receivedSignature:i}=r,o=await bc(e,t),c=await Qi.ecdsa.verifyString(n,a,o);if(!c)return c;const u=await bc(e,s),l=await Qi.ecdsa.getPublicKeyFromRawPublicKey(tt.decode(r.recipientEcdsaPublicKey)),d=await Qi.ecdsa.verifyString(l,i,u);return c&&d},wc=async(e,t,s,n,r)=>{const a=await Qi.ecdsa.getPublicKeyFromPrivateKey(po.keys.ecdsaPrivateKey),i=await Bc();for(let o=0;o<t.length;o++){const c=t[o],{username:u,isOwner:l,senderUsername:d,verificationValues:h}=c;try{const n=s[u]&&s[u].record.fingerprint,f=h.isChild,p=r===u;if(n)if(f)t[o].verified=await mc(e,n,i,a,h);else if(p){const r=await pc(e,n,i,a,h);if(r&&d){const n=await fc(e,s,c);t[o].verified=n}else t[o].verified=r}else if(l)t[o].verified=l;else{const n=await fc(e,s,c);t[o].verified=n}}catch(e){}delete t[o].senderUsername,l||(h&&h.isChild?t[o].receivedFromUsername=n:d&&(t[o].receivedFromUsername=d)),delete t[o].verificationValues}return t},gc=async(e,t,s,n,r)=>{const{databaseId:a,databaseNameHash:i,isOwner:o,readOnly:c,resharingAllowed:u,senderUsername:l}=e;let d,h;if(e.encryptedDbKey||e.plaintextDbKey){const s=e.plaintextDbKey||await Qi.aesGcm.decryptString(t,e.encryptedDbKey);if(d=await Qi.aesGcm.getKeyFromKeyString(s),h=await Qi.aesGcm.decryptString(d,e.databaseName),o&&h===_o)return null}else{if(e.wrappedDbKey)return null;{let n;try{const{ephemeralPublicKey:t,signedEphemeralPublicKey:r,sharedEncryptedDbKey:a}=e;n=tt.decode(e.senderEcdsaPublicKey);const i=await Qi.ecdsa.getPublicKeyFromRawPublicKey(n);if(!await Qi.ecdsa.verify(i,tt.decode(r),tt.decode(t)))throw new or.ServiceUnavailable;const o=await Qi.ecdh.getPublicKeyFromRawPublicKey(tt.decode(t)),c=await Qi.ecdh.computeSharedKeyEncryptionKey(o,s),u=await Qi.aesGcm.decryptString(c,a);d=await Qi.aesGcm.getKeyFromKeyString(u),h=await Qi.aesGcm.decryptString(d,e.databaseName)}catch(e){return null}const r=await Ac(n),a=await vc(d,r),o=await Qi.aesGcm.getKeyStringFromKey(d),c="SaveDatabase",u={databaseNameHash:i,encryptedDbKey:await Qi.aesGcm.encryptString(t,o),receivedSignature:a};po.request(c,u)}}const f={databaseName:h,databaseId:a,isOwner:o,readOnly:c,resharingAllowed:u,encryptionMode:e.plaintextDbKey?"server-side":"end-to-end"},p=await(async(e,t,s,n,r,a)=>{const i=[],o="GetDatabaseUsers",c={databaseId:e,databaseNameHash:t};let u=await po.request(o,c);for(i.push(...await wc(s,u.data.users,n,r,a));u.data.nextPageTokenLessThanUserId||u.data.nextPageTokenMoreThanUserId;)c.nextPageTokenLessThanUserId=u.data.nextPageTokenLessThanUserId,c.nextPageTokenMoreThanUserId=u.data.nextPageTokenMoreThanUserId,u=await po.request(o,c),i.push(...await wc(s,u.data.users,n,r,a));return i})(a,i,d,n,r,l);return o||(e=>{for(let t=0;t<e.length;t++)if(e[t].isOwner)return!0;return!1})(p)?(f.users=p,!o&&l&&(f.receivedFromUsername=l),f):null},yc=async(e,t,s="end-to-end")=>{let n;tc(s);try{n=rc(e,t,null,s)}catch(r){const a="GetDatabases",i=e?{dbNameHash:"server-side"===s?e:await Qi.hmac.signString(po.keys.hmacKey,e)}:{databaseId:t},o=(await po.request(a,i)).data.databases;if(!o||!o.length)throw new or.DatabaseNotFound;n=o[0],n.dbNameHash=n.databaseNameHash,n.dbId=n.databaseId}return n},bc=async(e,t)=>{const s=await Qi.aesGcm.getRawKeyFromKey(e),n=await Qi.sha256.hash(s),r=await Qi.hmac.importKeyFromRawBits(n);return await Qi.hmac.signString(r,t)},vc=async(e,t)=>{const s=await bc(e,t);return await Qi.ecdsa.signString(po.keys.ecdsaPrivateKey,s)},Mc=async e=>{let t;return e.dbKey?t=await Qi.aesGcm.getKeyStringFromKey(e.dbKey):(t=e.plaintextDbKey||await Qi.aesGcm.decryptString(po.keys.encryptionKey,e.encryptedDbKey),e.dbKey=await Qi.aesGcm.getKeyFromKeyString(t)),t},Sc=async(e,t,s,n,r)=>{const{databaseName:a,databaseId:i}=e,o=e.username.toLowerCase();try{const[e,c,u]=await Promise.all([Br(o),n&&kc(),yc(a,i,r)]);if(!e.ecdhPublicKey||!e.ecdsaPublicKey)throw new or.UserUnableToReceiveDatabase;const l=tt.decode(e.ecdsaPublicKey),d=await Ac(l);n&&await(async(e,t,s)=>{let n,r;const a=Object.keys(s);for(let i=0;i<a.length;i++){const o=a[i],c=s[o].record.fingerprint;if(e===o&&t===c){n=c;break}c===t&&(r=!0)}if(!n&&r)throw new or.UserMustBeReverified;if(!n)throw new or.UserNotVerified})(o,d,c);const h=await Qi.ecdsa.getPublicKeyFromRawPublicKey(l),{signedEcdhPublicKey:f,ecdhPublicKey:p}=e;if(!await Qi.ecdsa.verify(h,tt.decode(f),tt.decode(p)))throw new or.ServiceUnavailable;const m=await Qi.ecdh.getPublicKeyFromRawPublicKey(tt.decode(e.ecdhPublicKey)),w=await Qi.ecdh.generateKeyPair(),g=await Qi.ecdh.getRawPublicKeyFromPublicKey(w.publicKey),y=await Qi.ecdsa.sign(po.keys.ecdsaPrivateKey,g),b=await Qi.ecdh.computeSharedKeyEncryptionKey(m,w.privateKey),v=await Mc(u),M=await Qi.aesGcm.encryptString(b,v),S="ShareDatabase",I={databaseId:u.dbId,databaseNameHash:u.dbNameHash,username:o,readOnly:t,resharingAllowed:s,sharedEncryptedDbKey:M,ephemeralPublicKey:tt.encode(g),signedEphemeralPublicKey:tt.encode(y),sentSignature:await vc(u.dbKey,d),recipientEcdsaPublicKey:e.ecdsaPublicKey};await po.request(S,I)}catch(e){if(Go(e),e.response&&e.response.data)switch(e.response.data.message){case"SharingWithSelfNotAllowed":throw new or.SharingWithSelfNotAllowed;case"DatabaseNotFound":throw new or.DatabaseNotFound;case"ResharingNotAllowed":throw new or.ResharingNotAllowed("Must have permission to reshare the database with another user");case"ResharingWithWriteAccessNotAllowed":throw new or.ResharingWithWriteAccessNotAllowed;case"UserNotFound":throw new or.UserNotFound;case"DatabaseAlreadyShared":return}throw e}},Ic=e=>{if("string"!=typeof e)throw new or.UsernameMustBeString;if(0===e.length)throw new or.UsernameCannotBeBlank},Ec=e=>{if(eo(e,"shareToken"))throw new or.ShareTokenNotAllowed;if(eo(e,"username")&&Ic(e.username),eo(e,"readOnly")&&"boolean"!=typeof e.readOnly)throw new or.ReadOnlyMustBeBoolean;if(eo(e,"resharingAllowed")&&"boolean"!=typeof e.resharingAllowed)throw new or.ResharingAllowedMustBeBoolean;if(eo(e,"requireVerified")&&"boolean"!=typeof e.requireVerified)throw new or.RequireVerifiedMustBeBoolean},Ac=async e=>{const t=await Qi.sha256.hash(e);return tt.encode(t)},Bc=async()=>{const e=await Qi.ecdsa.getPublicKeyFromPrivateKey(po.keys.ecdsaPrivateKey),t=await Qi.ecdsa.getRawPublicKeyFromPublicKey(e);return await Ac(t)},kc=async()=>{const e=_o;await nc({databaseName:e,changeHandler:()=>{},allowVerifiedUsersDatabase:!0,encryptionMode:"end-to-end"});const t=po.state.dbNameToHash[e];return po.state.databases[t].items};var Pc={openDatabase:nc,getDatabases:async e=>{try{void 0!==e&&sc(e),$o();const{encryptionKey:t,ecdhPrivateKey:s}=po.keys,n=po.session.username;if(e&&eo(e,"shareToken"))throw new or.ShareTokenNotAllowed;const r=e&&e.encryptionMode||po.encryptionMode;tc(r);try{const a=[],i="GetDatabases",o=e&&{databaseId:e.databaseId,dbNameHash:"server-side"===r?e.databaseName:e.databaseName&&await Qi.hmac.signString(po.keys.hmacKey,e.databaseName)};let[c,u]=await Promise.all([po.request(i,o),kc()]),l=await Promise.all(c.data.databases.map((e=>gc(e,t,s,u,n))));for(a.push(...l);c.data.nextPageToken;){const e={nextPageToken:c.data.nextPageToken};c=await po.request(i,e),l=await Promise.all(c.data.databases.map((e=>gc(e,t,s,u,n)))),a.push(...l)}return{databases:a.filter((e=>null!==e))}}catch(e){throw Go(e),e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"UserMustChangePassword":case"UserNotSignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},insertItem:ac,updateItem:oc,deleteItem:async e=>{try{sc(e);const t=rc(e.databaseName,e.databaseId,e.shareToken,e.encryptionMode||po.encryptionMode),s="Delete",n=await uc(t,e);await lc(t,s,n)}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"ItemIdMissing":case"ItemIdMustBeString":case"ItemIdCannotBeBlank":case"ItemIdTooLong":case"ItemDoesNotExist":case"ItemUpdateConflict":case"TransactionUnauthorized":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},putTransaction:async e=>{try{if(sc(e),!eo(e,"operations"))throw new or.OperationsMissing;const{databaseName:t,databaseId:s,shareToken:n,operations:r,encryptionMode:a=po.encryptionMode}=e;if(!Array.isArray(r))throw new or.OperationsMustBeArray;const i=rc(t,s,n,a),o="BatchTransaction",c=await Promise.all(r.map((e=>{const t=e.command;switch(t){case"Insert":return ic(i,e);case"Update":return cc(i,e);case"Delete":return uc(i,e);default:throw new or.CommandNotRecognized(t)}}))),u=await Promise.all(c),l={operations:r.map(((e,t)=>Lo({command:e.command},u[t])))};try{await lc(i,o,l)}catch(e){if(e.response&&"OperationsExceedLimit"===e.response.data.error)throw new or.OperationsExceedLimit(e.response.data.limit);throw e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"OperationsMissing":case"OperationsMustBeArray":case"OperationsConflict":case"OperationsExceedLimit":case"CommandNotRecognized":case"ItemIdMissing":case"ItemIdMustBeString":case"ItemIdCannotBeBlank":case"ItemIdTooLong":case"ItemMissing":case"ItemInvalid":case"ItemTooLarge":case"ItemAlreadyExists":case"ItemDoesNotExist":case"ItemUpdateConflict":case"WriteAccessParamNotAllowed":case"TransactionUnauthorized":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},uploadFile:async e=>{try{(e=>{if(sc(e),eo(e,"progressHandler")&&"function"!=typeof e.progressHandler)throw new or.ProgressHandlerMustBeFunction})(e);const t=rc(e.databaseName,e.databaseId,e.shareToken,e.encryptionMode||po.encryptionMode),{dbId:s}=t;try{const{itemKey:n,fileMetadata:r}=await(async(e,t)=>{if(!eo(e,"itemId"))throw new or.ItemIdMissing;if(!eo(e,"file"))throw new or.FileMissing;const{itemId:s,file:n}=e;if("string"!=typeof s)throw new or.ItemIdMustBeString;if(0===s.length)throw new or.ItemIdCannotBeBlank;if(s.length>jo)throw new or.ItemIdTooLong(jo);if(!t.itemExists(s))throw new or.ItemDoesNotExist;if(!(n instanceof File))throw new or.FileMustBeFile;if(0===n.size)throw new or.FileCannotBeEmpty;const r=await Qi.hmac.signString(po.keys.hmacKey,s),a=t.getFileVersionNumber(s);return{itemKey:r,fileMetadata:{itemId:s,__v:void 0===a?0:a+1,fileName:n.name,fileSize:n.size,fileType:n.type}}})(e,t),[a,i]=await Qi.aesGcm.generateAndEncryptKeyEncryptionKey(t.dbKey),o=await Qi.aesGcm.encryptJson(a,r),{data:{fileId:c}}=await po.request("GenerateFileId",{dbId:t.dbId}),u=e.file;let l=0,d=0,h=[];const f={bytesTransferred:0};for(;l<u.size;){const t=u.slice(l,l+Vo);await dc(h,t,s,c,a,d,f,e.progressHandler),d+=1,l+=Vo}await Promise.all(h),await(async(e,t,s,n,r)=>{const a={dbId:e.dbId,fileId:t,itemKey:s,fileMetadata:n,fileEncryptionKey:tt.encode(r)};await lc(e,"CompleteFileUpload",a)})(t,c,n,o,i)}catch(e){if(Go(e),e.response&&"DatabaseIsReadOnly"===e.response.data)throw new or.DatabaseIsReadOnly;throw e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"ItemIdMissing":case"ItemIdMustBeString":case"ItemIdCannotBeBlank":case"ItemIdTooLong":case"ItemDoesNotExist":case"TransactionUnauthorized":case"FileMustBeFile":case"FileCannotBeEmpty":case"FileMissing":case"FileUploadConflict":case"ProgressHandlerMustBeFunction":case"UserMustChangePassword":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},getFile:async e=>{try{(e=>{if(sc(e),!eo(e,"fileId"))throw new or.FileIdMissing;const{fileId:t,range:s}=e;if("string"!=typeof t)throw new or.FileIdMustBeString;if(0===t.length)throw new or.FileIdCannotBeBlank;if(t.length>jo)throw new or.FileIdTooLong(jo);if(eo(e,"range")){if("object"!=typeof s)throw new or.RangeMustBeObject;if(!eo(s,"start"))throw new or.RangeMissingStart;if(!eo(s,"end"))throw new or.RangeMissingEnd;const{start:e,end:t}=s;if("number"!=typeof e)throw new or.RangeStartMustBeNumber;if("number"!=typeof t)throw new or.RangeEndMustBeNumber;if(e<0)throw new or.RangeStartMustBeGreaterThanZero;if(t<=e)throw new or.RangeEndMustBeGreaterThanRangeStart}})(e);const t=rc(e.databaseName,e.databaseId,e.shareToken,e.encryptionMode||po.encryptionMode),{dbId:s}=t,{fileId:n,range:r}=e,a=t.fileIds[n],i=t.items[a];if(!i||!i.file)throw new or.FileNotFound;const{file:{fileName:o,fileSize:c,fileType:u,fileEncryptionKey:l}}=i;if(r&&r.end>c)throw new or.RangeEndMustBeLessThanFileSize;const d=r?await(async(e,t,s,n)=>{const{start:r,end:a}=n,i=[],o=Math.floor(r/Vo),c=Math.floor(a/Vo)-(a%Vo==0?1:0);let u=o;for(;u<=c;){let n=await hc(e,t,u,s);u===o&&u===c&&a%Vo?n=n.slice(r%Vo,a%Vo):u===o?n=n.slice(r%Vo):u===c&&a%Vo&&(n=n.slice(0,a%Vo)),i.push(n),u+=1}return i})(s,n,l,r):await(async(e,t,s,n)=>{const r=[];let a=0;const i=n<Vo?0:Math.floor(n/Vo)-(n%Vo==0?1:0);for(;a<=i;){const n=await hc(e,t,a,s);r.push(n),a+=1}return r})(s,n,l,c);return{file:new File(d,o,{type:u})}}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNotOpen":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"ShareTokenInvalid":case"DatabaseIsReadOnly":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"FileIdMissing":case"FileIdMustBeString":case"FileIdCannotBeBlank":case"FileIdTooLong":case"FileNotFound":case"RangeMustBeObject":case"RangeMissingStart":case"RangeMissingEnd":case"RangeStartMustBeNumber":case"RangeEndMustBeNumber":case"RangeStartMustBeGreaterThanZero":case"RangeEndMustBeGreaterThanRangeStart":case"RangeEndMustBeLessThanFileSize":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},shareDatabase:async e=>{try{sc(e),Ec(e);const t=!eo(e,"readOnly")||e.readOnly,s=!!eo(e,"resharingAllowed")&&e.resharingAllowed,n=!eo(e,"requireVerified")||e.requireVerified,r=e.encryptionMode||po.encryptionMode;tc(r);let a={};return eo(e,"username")?await Sc(e,t,s,n,r):a.shareToken=await(async(e,t,s)=>{try{const{databaseName:n,databaseId:r}=e;if(eo(e,"requireVerified"))throw new or.RequireVerifiedParamNotNecessary;if(eo(e,"resharingAllowed"))throw new or.ResharingAllowedParamNotAllowed("when retrieving a share token");const a=Qi.generateSeed(),i=await Qi.hkdf.importHkdfKey(a),o=Qi.hkdf.generateSalt(),c=await Qi.aesGcm.importKeyFromMaster(i,o),u=await yc(n,r,s),l=await Mc(u),d=await Qi.aesGcm.encryptString(c,l),{ecdsaPublicKey:h,encryptedEcdsaPrivateKey:f,ecdsaKeyEncryptionKeySalt:p}=await Qi.ecdsa.generateEcdsaKeyData(i),m="ShareDatabaseToken",w={databaseId:u.dbId,databaseNameHash:u.dbNameHash,readOnly:t,keyData:{shareTokenEncryptedDbKey:d,shareTokenEncryptionKeySalt:tt.encode(o),shareTokenPublicKey:h,shareTokenEncryptedEcdsaPrivateKey:f,shareTokenEcdsaKeyEncryptionKeySalt:p}},g=await po.request(m,w),{shareTokenId:y}=g.data,b=Lr(y,!0);return tt.encode(qr(b,a))}catch(e){if(Go(e),e.response&&e.response.data)switch(e.response.data.message){case"DatabaseNotFound":throw new or.DatabaseNotFound;case"ResharingNotAllowed":throw new or.ResharingNotAllowed("Only the owner can generate a share token")}throw e}})(e,t,r),a}catch(e){switch(e.name){case"ParamsMustBeObject":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"DatabaseNotFound":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"UsernameCannotBeBlank":case"UsernameMustBeString":case"ReadOnlyMustBeBoolean":case"ResharingAllowedMustBeBoolean":case"ResharingNotAllowed":case"ResharingWithWriteAccessNotAllowed":case"ResharingAllowedParamNotAllowed":case"RequireVerifiedMustBeBoolean":case"RequireVerifiedParamNotNecessary":case"SharingWithSelfNotAllowed":case"UserMustChangePassword":case"UserNotSignedIn":case"UserUnableToReceiveDatabase":case"UserNotFound":case"UserNotVerified":case"UserMustBeReverified":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},modifyDatabasePermissions:async e=>{try{if(sc(e),Ec(e),!eo(e,"username"))throw new or.UsernameMissing;if(eo(e,"revoke")){if("boolean"!=typeof e.revoke)throw new or.RevokeMustBeBoolean;if(e.revoke){if(eo(e,"readOnly"))throw new or.ReadOnlyParamNotAllowed;if(eo(e,"resharingAllowed"))throw new or.ResharingAllowedParamNotAllowed("when revoking access to a database")}}else if(!eo(e,"readOnly")&&!eo(e,"resharingAllowed"))throw new or.ParamsMissing;const{databaseName:t,databaseId:s,readOnly:n,resharingAllowed:r,revoke:a,encryptionMode:i=po.encryptionMode}=e,o=e.username.toLowerCase();try{const e=await yc(t,s,i),c="ModifyDatabasePermissions",u={databaseId:e.dbId,databaseNameHash:e.dbNameHash,username:o,readOnly:n,resharingAllowed:r,revoke:a};await po.request(c,u)}catch(e){if(Go(e),e.response&&e.response.data)switch(e.response.data.message){case"SharingWithSelfNotAllowed":throw new or.ModifyingOwnPermissionsNotAllowed;case"ModifyingOwnerPermissionsNotAllowed":throw new or.ModifyingOwnerPermissionsNotAllowed;case"ResharingNotAllowed":throw new or.ModifyingPermissionsNotAllowed;case"ResharingWithWriteAccessNotAllowed":throw new or.GrantingWriteAccessNotAllowed;case"DatabaseNotFound":throw new or.DatabaseNotFound;case"UserNotFound":throw new or.UserNotFound}throw e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"ParamsMissing":case"DatabaseNameMissing":case"DatabaseNameMustBeString":case"DatabaseNameCannotBeBlank":case"DatabaseNameTooLong":case"DatabaseNameRestricted":case"DatabaseIdMustBeString":case"DatabaseIdCannotBeBlank":case"DatabaseIdInvalidLength":case"DatabaseIdNotAllowed":case"ShareTokenNotAllowed":case"DatabaseNotFound":case"EncryptionModeNotValid":case"ServerSideEncryptionNotEnabledInClient":case"UsernameMissing":case"UsernameCannotBeBlank":case"UsernameMustBeString":case"ReadOnlyMustBeBoolean":case"ReadOnlyParamNotAllowed":case"ResharingAllowedMustBeBoolean":case"ResharingAllowedParamNotAllowed":case"RevokeMustBeBoolean":case"ModifyingOwnPermissionsNotAllowed":case"ModifyingOwnerPermissionsNotAllowed":case"ModifyingPermissionsNotAllowed":case"GrantingWriteAccessNotAllowed":case"UserMustChangePassword":case"UserNotSignedIn":case"UserNotFound":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},getVerificationMessage:async()=>{try{$o();const e=po.session.username,t=await Bc();return{verificationMessage:((e,t)=>btoa(JSON.stringify({username:e,fingerprint:t})))(e,t)}}catch(e){switch(e.name){case"UserMustChangePassword":case"UserNotSignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},verifyUser:async e=>{try{if("object"!=typeof e)throw new or.ParamsMustBeObject;if($o(),!eo(e,"verificationMessage"))throw new or.VerificationMessageMissing;const{verificationMessage:t}=e;if("string"!=typeof t)throw new or.VerificationMessageMustBeString;if(0===t.length)throw new or.VerificationMessageCannotBeBlank;const{username:s,fingerprint:n}=(e=>{try{const{username:t,fingerprint:s}=JSON.parse(atob(e));if(Ic(t),!s)throw new or.VerificationMessageInvalid;return{username:t,fingerprint:s}}catch(e){throw new or.VerificationMessageInvalid}})(t);if(s===po.session.username||n===await Bc())throw new or.VerifyingSelfNotAllowed;await kc();const r=_o,a=!0,i=s,o={fingerprint:n};try{await ac({databaseName:r,itemId:i,item:o,allowVerifiedUsersDatabase:a})}catch(e){if("ItemAlreadyExists"!==e.name)throw e;await oc({databaseName:r,itemId:i,item:o,allowVerifiedUsersDatabase:a})}}catch(e){switch(e.name){case"ParamsMustBeObject":case"VerificationMessageMissing":case"VerificationMessageMustBeString":case"VerificationMessageCannotBeBlank":case"VerificationMessageInvalid":case"VerifyingSelfNotAllowed":case"UserMustChangePassword":case"UserNotSignedIn":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}}};const xc=()=>{if(po.reconnecting)throw new or.Reconnecting;if(!po.keys.init&&po.changePassword)throw new or.UserMustChangePassword;if(!po.keys.init)throw new or.UserNotSignedIn},Uc=e=>{if(e.response){if(e.response.status===lt)throw new or.InternalServerError;if(e.response.status===ht)throw new or.Timeout}else if(e.message&&-1!==e.message.indexOf("timeout"))throw new or.Timeout},Nc=e=>{xc();const t=po.userData.stripeData;if(!t.stripeAccountId)throw new or.StripeAccountNotConnected;if("disabled"===t.paymentsMode)throw new or.PaymentsDisabled;if(!eo(window,"Stripe"))throw new or.StripeJsLibraryMissing;if("object"!=typeof e)throw new or.ParamsMustBeObject;if(!eo(e,"successUrl"))throw new or.SuccessUrlMissing;if("string"!=typeof e.successUrl)throw new or.SuccessUrlMustBeString;const s=Zi(e.successUrl);if("http"!==s&&"https"!==s){const e=!0;throw new or.SuccessUrlInvalid(e)}if(!eo(e,"cancelUrl"))throw new or.CancelUrlMissing;if("string"!=typeof e.cancelUrl)throw new or.CancelUrlMustBeString;const n=Zi(e.cancelUrl);if("http"!==n&&"https"!==n){const e=!0;throw new or.CancelUrlInvalid(e)}},Tc=()=>{xc();const e=po.userData.stripeData;if(!e.stripeAccountId)throw new or.StripeAccountNotConnected;if("disabled"===e.paymentsMode)throw new or.PaymentsDisabled;if("canceled"===e.subscriptionStatus)throw new or.SubscriptionAlreadyCanceled};var Dc={purchaseSubscription:async e=>{try{const t=po.userData.stripeData;if(!t.cancelSubscriptionAt&&t.subscriptionStatus&&"canceled"!==t.subscriptionStatus)throw new or.SubscriptionPlanAlreadyPurchased;Nc(e);try{const s="PurchaseSubscription",n=(await po.request(s,e)).data,r=wr("prod"===t.paymentsMode),a=await window.Stripe(r,{stripeAccount:t.stripeAccountId}).redirectToCheckout({sessionId:n});if(a.error)throw a.error}catch(e){if(Uc(e),e.response)switch(e.response.data){case"PriceIdOrPlanIdAllowed":throw new or.PriceIdOrPlanIdAllowed;case"PriceIdOrPlanIdMissing":throw new or.PriceIdOrPlanIdMissing;case"SubscriptionPlanAlreadyPurchased":throw new or.SubscriptionPlanAlreadyPurchased;case"SuccessUrlInvalid":throw new or.SuccessUrlInvalid;case"CancelUrlInvalid":throw new or.CancelUrlInvalid;default:if(e.response.data&&"StripeError"===e.response.data.name)throw new or.StripeError(e.response.data)}throw e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"SuccessUrlMissing":case"SuccessUrlMustBeString":case"SuccessUrlInvalid":case"CancelUrlMissing":case"CancelUrlMustBeString":case"CancelUrlInvalid":case"StripeError":case"StripeJsLibraryMissing":case"PriceIdOrPlanIdAllowed":case"PriceIdOrPlanIdMissing":case"SubscriptionPlanAlreadyPurchased":case"StripeAccountNotConnected":case"PaymentsDisabled":case"UserMustChangePassword":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},cancelSubscription:async()=>{try{Tc();try{const e="CancelSubscription",t=(await po.request(e)).data;return po.userData.stripeData.cancelSubscriptionAt=t,{cancelSubscriptionAt:t}}catch(e){if(Uc(e),e.response&&"SubscriptionNotFound"===e.response.data)throw new or.SubscriptionNotFound;throw e}}catch(e){switch(e.name){case"SubscriptionNotFound":case"StripeAccountNotConnected":case"PaymentsDisabled":case"SubscriptionAlreadyCanceled":case"UserMustChangePassword":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},resumeSubscription:async()=>{try{Tc();try{const e="ResumeSubscription";await po.request(e),delete po.userData.stripeData.cancelSubscriptionAt}catch(e){if(Uc(e),e.response&&"SubscriptionNotFound"===e.response.data)throw new or.SubscriptionNotFound;throw e}}catch(e){switch(e.name){case"SubscriptionNotFound":case"StripeAccountNotConnected":case"PaymentsDisabled":case"SubscriptionAlreadyCanceled":case"UserMustChangePassword":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}},updatePaymentMethod:async e=>{try{Nc(e);const t=po.userData.stripeData;if(!t.subscriptionStatus)throw new or.SubscriptionNotPurchased;try{const s="UpdatePaymentMethod",n=(await po.request(s,e)).data,r=wr("prod"===t.paymentsMode),a=await window.Stripe(r,{stripeAccount:t.stripeAccountId}).redirectToCheckout({sessionId:n});if(a.error)throw a.error}catch(e){if(Uc(e),e.response){if("SuccessUrlInvalid"===e.response.data)throw new or.SuccessUrlInvalid;if("CancelUrlInvalid"===e.response.data)throw new or.CancelUrlInvalid}throw e}}catch(e){switch(e.name){case"ParamsMustBeObject":case"SuccessUrlMissing":case"SuccessUrlMustBeString":case"SuccessUrlInvalid":case"CancelUrlMissing":case"CancelUrlMustBeString":case"CancelUrlInvalid":case"StripeJsLibraryMissing":case"SubscriptionNotPurchased":case"StripeAccountNotConnected":case"PaymentsDisabled":case"UserMustChangePassword":case"UserNotSignedIn":case"TooManyRequests":case"ServiceUnavailable":throw e;default:throw new or.UnknownServiceUnavailable(e)}}}},Kc={init:Ro.init,signUp:Ro.signUp,signIn:Ro.signIn,signOut:Ro.signOut,updateUser:Ro.updateUser,deleteUser:Ro.deleteUser,forgotPassword:Ro.forgotPassword,openDatabase:Pc.openDatabase,insertItem:Pc.insertItem,updateItem:Pc.updateItem,deleteItem:Pc.deleteItem,putTransaction:Pc.putTransaction,uploadFile:Pc.uploadFile,getFile:Pc.getFile,getDatabases:Pc.getDatabases,shareDatabase:Pc.shareDatabase,modifyDatabasePermissions:Pc.modifyDatabasePermissions,getVerificationMessage:Pc.getVerificationMessage,verifyUser:Pc.verifyUser,purchaseSubscription:Dc.purchaseSubscription,cancelSubscription:Dc.cancelSubscription,resumeSubscription:Dc.resumeSubscription,updatePaymentMethod:Dc.updatePaymentMethod};function Oc(e){let t;return{c(){t=A("Sign up!")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function Rc(e){let t;return{c(){t=A("Sign in")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function Cc(e){let t,s,n,r,a,i,o,c,u,l,d,h,f,p,m,w,g,y,b,E,A,k,N,T,D;function K(t){e[4](t)}let O={label:"Email",type:"email",autocomplete:"email",required:!0};function R(t){e[5](t)}void 0!==e[2]&&(O.value=e[2]),a=new _e({props:O}),H.push((()=>me(a,"value",K)));let C={label:"Username",type:"text",autocomplete:"username",required:!0};function F(t){e[6](t)}void 0!==e[0]&&(C.value=e[0]),c=new _e({props:C}),H.push((()=>me(c,"value",R)));let L={label:"Password",type:"password",autocomplete:"password",required:!0};return void 0!==e[1]&&(L.value=e[1]),d=new _e({props:L}),H.push((()=>me(d,"value",F))),p=new qe({props:{$$slots:{default:[Oc]},$$scope:{ctx:e}}}),A=new Ge({props:{href:"/signin",$$slots:{default:[Rc]},$$scope:{ctx:e}}}),{c(){t=I("div"),s=I("form"),n=I("h2"),n.textContent="Sign Up",r=B(),we(a.$$.fragment),o=B(),we(c.$$.fragment),l=B(),we(d.$$.fragment),f=B(),we(p.$$.fragment),m=B(),w=I("br"),g=B(),y=I("div"),b=I("p"),b.textContent="Already have an account?",E=B(),we(A.$$.fragment),U(n,"class","text-gray-900 text-lg font-medium title-font mb-5"),U(y,"class","flex justify-between"),U(s,"class","lg:w-2/6 md:w-1/2 bg-gray-100 rounded-lg p-8 flex flex-col w-full mt-10 md:mt-0"),U(t,"class","container flex flex-col h-screen items-center justify-center mx-auto w-screen")},m(i,u){M(i,t,u),v(t,s),v(s,n),v(s,r),ge(a,s,null),v(s,o),ge(c,s,null),v(s,l),ge(d,s,null),v(s,f),ge(p,s,null),v(s,m),v(s,w),v(s,g),v(s,y),v(y,b),v(y,E),ge(A,y,null),N=!0,T||(D=P(s,"submit",x(e[3])),T=!0)},p(e,[t]){const s={};!i&&4&t&&(i=!0,s.value=e[2],Y((()=>i=!1))),a.$set(s);const n={};!u&&1&t&&(u=!0,n.value=e[0],Y((()=>u=!1))),c.$set(n);const r={};!h&&2&t&&(h=!0,r.value=e[1],Y((()=>h=!1))),d.$set(r);const o={};512&t&&(o.$$scope={dirty:t,ctx:e}),p.$set(o);const l={};512&t&&(l.$$scope={dirty:t,ctx:e}),A.$set(l)},i(e){N||(ue(a.$$.fragment,e),ue(c.$$.fragment,e),ue(d.$$.fragment,e),ue(p.$$.fragment,e),ue(A.$$.fragment,e),k||Z((()=>{k=he(s,Je,{duration:0}),k.start()})),N=!0)},o(e){le(a.$$.fragment,e),le(c.$$.fragment,e),le(d.$$.fragment,e),le(p.$$.fragment,e),le(A.$$.fragment,e),N=!1},d(e){e&&S(t),ye(a),ye(c),ye(d),ye(p),ye(A),T=!1,D()}}}function Fc(e,t,s){let n,r,a,i,o;u(e,We,(e=>s(7,n=e))),u(e,ze,(e=>s(8,r=e)));return[a,i,o,async()=>{p(We,n=!0,n);try{p(ze,r=await Kc.signUp({username:a,password:i,email:o}),r)}catch(e){}p(We,n=!1,n)},function(e){o=e,s(2,o)},function(e){a=e,s(0,a)},function(e){i=e,s(1,i)}]}class Lc extends ve{constructor(e){super(),be(this,e,Fc,Cc,o,{})}}function qc(e){let t;return{c(){t=A("Sign In!")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function jc(e){let t;return{c(){t=A("Sign up")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function Vc(e){let t,s,n,r,a,i,o,c,u,l,d,h,f,p,m,w,g,y,b,E,A,k;function N(t){e[3](t)}let T={label:"Username",type:"text",autocomplete:"username",required:!0};function D(t){e[4](t)}void 0!==e[0]&&(T.value=e[0]),a=new _e({props:T}),H.push((()=>me(a,"value",N)));let K={label:"Password",type:"password",autocomplete:"current-password",required:!0};return void 0!==e[1]&&(K.value=e[1]),c=new _e({props:K}),H.push((()=>me(c,"value",D))),d=new qe({props:{$$slots:{default:[qc]},$$scope:{ctx:e}}}),y=new Ge({props:{href:"/signup",$$slots:{default:[jc]},$$scope:{ctx:e}}}),{c(){t=I("div"),s=I("form"),n=I("h2"),n.textContent="Sign In",r=B(),we(a.$$.fragment),o=B(),we(c.$$.fragment),l=B(),we(d.$$.fragment),h=B(),f=I("br"),p=B(),m=I("div"),w=I("p"),w.textContent="Need an account?",g=B(),we(y.$$.fragment),U(n,"class","text-gray-900 text-lg font-medium title-font mb-5"),U(m,"class","flex justify-between"),U(s,"class","lg:w-2/6 md:w-1/2 bg-gray-100 rounded-lg p-8 flex flex-col w-full mt-10 md:mt-0"),U(t,"class","container flex flex-col h-screen items-center justify-center mx-auto w-screen")},m(i,u){M(i,t,u),v(t,s),v(s,n),v(s,r),ge(a,s,null),v(s,o),ge(c,s,null),v(s,l),ge(d,s,null),v(s,h),v(s,f),v(s,p),v(s,m),v(m,w),v(m,g),ge(y,m,null),E=!0,A||(k=P(s,"submit",x(e[2])),A=!0)},p(e,[t]){const s={};!i&&1&t&&(i=!0,s.value=e[0],Y((()=>i=!1))),a.$set(s);const n={};!u&&2&t&&(u=!0,n.value=e[1],Y((()=>u=!1))),c.$set(n);const r={};128&t&&(r.$$scope={dirty:t,ctx:e}),d.$set(r);const o={};128&t&&(o.$$scope={dirty:t,ctx:e}),y.$set(o)},i(e){E||(ue(a.$$.fragment,e),ue(c.$$.fragment,e),ue(d.$$.fragment,e),ue(y.$$.fragment,e),b||Z((()=>{b=he(s,Je,{duration:0}),b.start()})),E=!0)},o(e){le(a.$$.fragment,e),le(c.$$.fragment,e),le(d.$$.fragment,e),le(y.$$.fragment,e),E=!1},d(e){e&&S(t),ye(a),ye(c),ye(d),ye(y),A=!1,k()}}}function _c(e,t,s){let n,r;u(e,We,(e=>s(5,n=e))),u(e,ze,(e=>s(6,r=e)));let{username:a=""}=t,{password:i=""}=t;return e.$$set=e=>{"username"in e&&s(0,a=e.username),"password"in e&&s(1,i=e.password)},[a,i,async()=>{p(We,n=!0,n);try{p(ze,r=await Kc.signIn({username:a,password:i}),r)}catch(e){}p(We,n=!1,n),r&&Te("/inbox")},function(e){a=e,s(0,a)},function(e){i=e,s(1,i)}]}class Hc extends ve{constructor(e){super(),be(this,e,_c,Vc,o,{username:0,password:1})}}class $c extends ve{constructor(e){super(),be(this,e,null,null,o,{})}}function Gc(t){let s,n,r,a,i,o,c,u,l,d,h,f,p,m,w,g,y,b,I,B,k,P,x,N,T,D,O,R,C,F,L,q,j,V,_,H,$,G,J,z,W,Q,Z;return{c(){s=E("svg"),n=E("metadata"),r=E("rdf:RDF"),a=E("cc:Work"),i=E("dc:format"),o=A("image/svg+xml"),c=E("dc:type"),u=E("dc:title"),l=E("defs"),d=E("sodipodi:namedview"),h=E("g"),f=E("path"),p=E("path"),m=E("path"),w=E("path"),g=E("path"),y=E("g"),b=E("path"),I=E("path"),B=E("path"),k=E("path"),P=E("path"),x=E("path"),N=E("path"),T=E("path"),D=E("path"),O=E("path"),R=E("path"),C=E("path"),F=E("path"),L=E("g"),q=E("path"),j=E("g"),V=E("path"),_=E("path"),H=E("path"),$=E("g"),G=E("path"),J=E("path"),z=E("path"),W=E("path"),Q=E("path"),Z=E("path"),U(c,"rdf:resource","http://purl.org/dc/dcmitype/StillImage"),U(a,"rdf:about",""),U(n,"id","metadata72"),U(l,"id","defs70"),U(d,"inkscape:current-layer","layer7"),U(d,"inkscape:window-maximized","0"),U(d,"inkscape:window-y","23"),U(d,"inkscape:window-x","0"),U(d,"inkscape:cy","115.79291"),U(d,"inkscape:cx","-38.065262"),U(d,"inkscape:zoom","2.9209448"),U(d,"showguides","false"),U(d,"showgrid","false"),U(d,"id","namedview68"),U(d,"inkscape:window-height","1395"),U(d,"inkscape:window-width","1907"),U(d,"inkscape:pageshadow","2"),U(d,"inkscape:pageopacity","0"),U(d,"guidetolerance","10"),U(d,"gridtolerance","10"),U(d,"objecttolerance","10"),U(d,"borderopacity","1"),U(d,"bordercolor","#666666"),U(d,"pagecolor","#ffffff"),K(f,"display","inline"),K(f,"fill","#8787de"),K(f,"stroke","#000000"),U(f,"id","path52"),U(f,"vector-effect","non-scaling-stroke"),U(f,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(f,"shaper:pathtype","exterior"),U(f,"shaper:cutdepth","0"),U(f,"fill","rgb(0,0,0)"),U(f,"d","m 10.692337,0.6587692 a 0.2916747,0.2916747 -50.881768 0 1 0.107651,0.2262946 0.291675,0.291675 0 0 1 -0.58335,0 0.2916747,0.2916747 -180 0 1 0.107651,-0.2262946 0.2916747,0.2916747 -129.11823 0 1 0.368048,0 z"),K(p,"display","inline"),K(p,"fill","#8787de"),K(p,"stroke","#000000"),U(p,"id","path50"),U(p,"vector-effect","non-scaling-stroke"),U(p,"shaper:pathtype","exterior"),U(p,"shaper:cutdepth","0"),U(p,"fill","rgb(0,0,0)"),U(p,"d","m 3.4207863,2.1805927 a 1.0933712,1.0933712 0 0 0 -1.339113,0 0.2916747,0.2916747 0 0 1 -0.107651,0.2262946 1.4593205,1.4593205 0 0 1 0.01962,-0.01116 1.4593205,1.4593205 0 0 1 0.579792,-0.1792772 1.4593205,1.4593205 0 0 1 0.520565,0.04678 1.4593205,1.4593205 0 0 1 0.342409,0.1436568 1.6464142,1.6464142 0 0 0 -0.01563,-0.2262946 z"),K(m,"display","inline"),K(m,"fill","#8787de"),K(m,"stroke","#000000"),U(m,"id","path20"),U(m,"vector-effect","non-scaling-stroke"),U(m,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(m,"shaper:pathtype","exterior"),U(m,"shaper:cutdepth","0"),U(m,"fill","rgb(0,0,0)"),U(m,"d","m 8.8618986,0.6587692 a 1.6464142,1.6464142 -180 0 0 0.015626,0.2262946 1.0933712,1.0933712 127.76167 0 0 1.3391134,0 0.2916747,0.2916747 -180 0 1 0.107651,-0.2262946 1.4593205,1.4593205 59.930397 0 1 -0.01962,0.0111599 A 1.4593205,1.4593205 60.816753 0 1 9.7248724,0.8492063 1.4593205,1.4593205 84.819046 0 1 9.2043076,0.802426 1.4593205,1.4593205 105.45109 0 1 8.8618986,0.6587692 Z"),U(w,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(w,"display","inline"),K(w,"fill","#000000"),K(w,"stroke","#000000"),U(w,"id","path18"),U(w,"vector-effect","non-scaling-stroke"),U(w,"shaper:pathtype","exterior"),U(w,"shaper:cutdepth","0"),U(w,"fill","rgb(0,0,0)"),U(w,"d","m 11.291753,-0.5015565 0.278688,0.3365162 0.105915,-0.3365162 0.398837,1.1603257 L 11.812318,0.1532352 11.570441,0.395276 11.291753,0.1532352 10.972084,0.395276 10.711961,0.1532352 10.508313,0.395276 10.304665,0.1532352 10.044541,0.395276 9.7248724,0.1532352 9.4461843,0.395276 9.2043076,0.1532352 8.9414321,0.6587692 9.34027,-0.5015565 l 0.1059143,0.3365162 0.2786881,-0.3365162 0.2255001,0.2162468 a 0.3291739,0.3291739 172.88265 0 0 0.5579405,0.1934251 0.3291739,0.3291739 134.64214 0 0 0.55794,-0.1934251 z"),U(g,"sodipodi:nodetypes","ccc"),U(g,"id","path137"),U(g,"d","M 2.3479382,3.350966 1.7833281,3.724555 1.2320577,3.350966 1.790985,3.7272651 Z"),K(g,"fill","#8787de"),K(g,"stroke","#000000"),K(g,"stroke-width","0.0264583px"),K(g,"stroke-linecap","butt"),K(g,"stroke-linejoin","miter"),K(g,"stroke-opacity","1"),K(h,"display","inline"),U(h,"inkscape:label","mouth_nose"),U(h,"id","layer7"),U(h,"inkscape:groupmode","layer"),U(b,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(b,"display","inline"),K(b,"fill","#ffffff"),K(b,"stroke","#000000"),U(b,"id","path48"),U(b,"vector-effect","non-scaling-stroke"),U(b,"shaper:pathtype","exterior"),U(b,"shaper:cutdepth","0"),U(b,"fill","rgb(0,0,0)"),U(b,"d","M 8.9414321,0.6587692 9.2043076,0.1532352 V 0.802426 A 1.4593205,1.4593205 105.45109 0 1 8.8618986,0.6587692 1.6464142,1.6464142 -180 0 1 9.34027,-0.5015565 Z"),U(I,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(I,"display","inline"),K(I,"fill","#ffffff"),K(I,"stroke","#000000"),U(I,"id","path36"),U(I,"vector-effect","non-scaling-stroke"),U(I,"shaper:pathtype","exterior"),U(I,"shaper:cutdepth","0"),U(I,"fill","rgb(0,0,0)"),U(I,"d","m 9.9503725,-0.2853097 a 0.3291739,0.3291739 172.88265 0 0 0.5579405,0.1934251 0.3291739,0.3291739 134.64214 0 0 0.55794,-0.1934251 l -0.09417,0.0903049 -0.260123,-0.3065517 -0.203648,0.3065517 -0.203648,-0.3065517 -0.260124,0.3065517 z"),K(B,"display","inline"),K(B,"fill","#ffffff"),K(B,"stroke","#000000"),U(B,"id","path46"),U(B,"vector-effect","non-scaling-stroke"),U(B,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(B,"shaper:pathtype","exterior"),U(B,"shaper:cutdepth","0"),U(B,"fill","rgb(0,0,0)"),U(B,"d","M 9.4461843,0.395276 9.7248724,0.1532352 V 0.8492063 A 1.4593205,1.4593205 84.819046 0 1 9.2043076,0.802426 V 0.1532352 Z"),U(k,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(k,"display","inline"),K(k,"fill","#ffffff"),K(k,"stroke","#000000"),U(k,"id","path30"),U(k,"vector-effect","non-scaling-stroke"),U(k,"shaper:pathtype","exterior"),U(k,"shaper:cutdepth","0"),U(k,"fill","rgb(0,0,0)"),U(k,"d","m 10.711961,0.1532352 v 0.505534 0.0111599 a 1.4593205,1.4593205 119.18325 0 1 -0.01962,-0.0111599 0.2916747,0.2916747 -50.881768 0 0 -0.368048,0 1.4593205,1.4593205 59.930397 0 1 -0.01962,0.0111599 V 0.6587692 0.1532352 l 0.203648,0.2420408 z"),U(P,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(P,"display","inline"),K(P,"fill","#ffffff"),K(P,"stroke","#000000"),U(P,"id","path10"),U(P,"vector-effect","non-scaling-stroke"),U(P,"shaper:pathtype","exterior"),U(P,"shaper:cutdepth","0"),U(P,"fill","rgb(0,0,0)"),U(P,"d","M 11.812318,0.1532352 V 0.802426 A 1.4593205,1.4593205 74.548906 0 1 11.291753,0.8492063 V 0.1532352 l 0.278688,0.2420408 z"),U(x,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(x,"display","inline"),K(x,"fill","#ffffff"),K(x,"stroke","#000000"),U(x,"id","path12"),U(x,"vector-effect","non-scaling-stroke"),U(x,"shaper:pathtype","exterior"),U(x,"shaper:cutdepth","0"),U(x,"fill","rgb(0,0,0)"),U(x,"d","M 10.972084,0.395276 11.291753,0.1532352 V 0.8492063 A 1.4593205,1.4593205 95.180954 0 1 10.711961,0.6699291 V 0.6587692 0.1532352 Z"),K(N,"display","inline"),K(N,"fill","#ffffff"),K(N,"stroke","#000000"),U(N,"id","path14"),U(N,"vector-effect","non-scaling-stroke"),U(N,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(N,"shaper:pathtype","exterior"),U(N,"shaper:cutdepth","0"),U(N,"fill","rgb(0,0,0)"),U(N,"d","m 10.044541,0.395276 0.260124,-0.2420408 v 0.505534 0.0111599 A 1.4593205,1.4593205 60.816753 0 1 9.7248724,0.8492063 V 0.1532352 Z"),K(T,"display","inline"),K(T,"fill","#ffffff"),K(T,"stroke","#000000"),U(T,"id","path24"),U(T,"vector-effect","non-scaling-stroke"),U(T,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(T,"shaper:pathtype","exterior"),U(T,"shaper:cutdepth","0"),U(T,"fill","rgb(0,0,0)"),U(T,"d","M 12.075193,0.6587692 11.676356,-0.5015565 A 1.6464142,1.6464142 -44.810104 0 1 12.154727,0.6587692 1.4593205,1.4593205 59.930397 0 1 11.812318,0.802426 V 0.1532352 Z"),K(D,"display","inline"),K(D,"fill","#ffffff"),K(D,"stroke","#000000"),U(D,"id","path32"),U(D,"vector-effect","non-scaling-stroke"),U(D,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(D,"shaper:pathtype","exterior"),U(D,"shaper:cutdepth","0"),U(D,"fill","rgb(0,0,0)"),U(D,"d","m 9.34027,-0.5015565 a 1.6464142,1.6464142 -135.1899 0 1 0.3846024,-0.2877423 v 0.2877423 l -0.2786881,0.3365162 z"),U(O,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(O,"display","inline"),K(O,"fill","#ffffff"),K(O,"stroke","#000000"),U(O,"id","path34"),U(O,"vector-effect","non-scaling-stroke"),U(O,"shaper:pathtype","exterior"),U(O,"shaper:cutdepth","0"),U(O,"fill","rgb(0,0,0)"),U(O,"d","m 9.7248724,-0.5015565 0.2255001,0.2162468 0.094169,0.0903049 0.260124,-0.3065517 v -0.4734451 a 1.6464142,1.6464142 -97.105221 0 0 -0.5798291,0.1857028 z"),U(R,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(R,"display","inline"),K(R,"fill","#ffffff"),K(R,"stroke","#000000"),U(R,"id","path38"),U(R,"vector-effect","non-scaling-stroke"),U(R,"shaper:pathtype","exterior"),U(R,"shaper:cutdepth","0"),U(R,"fill","rgb(0,0,0)"),U(R,"d","m 10.711961,-0.5015565 v -0.4734451 a 1.6464142,1.6464142 -82.894779 0 0 -0.407296,0 v 0.4734451 l 0.203648,0.3065517 z"),U(C,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(C,"display","inline"),K(C,"fill","#ffffff"),K(C,"stroke","#000000"),U(C,"id","path40"),U(C,"vector-effect","non-scaling-stroke"),U(C,"shaper:pathtype","exterior"),U(C,"shaper:cutdepth","0"),U(C,"fill","rgb(0,0,0)"),U(C,"d","m 11.676356,-0.5015565 -0.105915,0.3365162 -0.278688,-0.3365162 v -0.2877423 a 1.6464142,1.6464142 -61.585524 0 1 0.384603,0.2877423 z"),U(F,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(F,"display","inline"),K(F,"fill","#ffffff"),K(F,"stroke","#000000"),U(F,"id","path54"),U(F,"vector-effect","non-scaling-stroke"),U(F,"shaper:pathtype","exterior"),U(F,"shaper:cutdepth","0"),U(F,"fill","rgb(0,0,0)"),U(F,"d","m 11.291753,-0.5015565 v -0.2877423 a 1.6464142,1.6464142 -61.585524 0 0 -0.579792,-0.1857028 v 0.4734451 l 0.260123,0.3065517 0.09417,-0.0903049 z"),K(y,"display","inline"),U(y,"inkscape:label","teeth"),U(y,"id","layer6"),U(y,"inkscape:groupmode","layer"),U(q,"d","m 9.9503725,-0.2853097 a 0.3291739,0.3291739 172.88265 0 0 0.5579405,0.1934251 0.3291739,0.3291739 134.64214 0 0 0.55794,-0.1934251 l -0.09417,0.0903049 -0.260123,-0.3065517 -0.203648,0.3065517 -0.203648,-0.3065517 -0.260124,0.3065517 z"),U(q,"fill","rgb(0,0,0)"),U(q,"shaper:cutdepth","0"),U(q,"shaper:pathtype","exterior"),U(q,"vector-effect","non-scaling-stroke"),U(q,"id","path145"),K(q,"display","inline"),K(q,"fill","#8787de"),K(q,"stroke","#000000"),U(q,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(L,"inkscape:groupmode","layer"),U(L,"id","g169"),U(L,"inkscape:label","tongue"),K(L,"display","inline"),U(V,"sodipodi:nodetypes","cssssccscc"),U(V,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(V,"display","inline"),K(V,"fill","#000000"),K(V,"stroke","#000000"),U(V,"id","path22"),U(V,"vector-effect","non-scaling-stroke"),U(V,"shaper:pathtype","exterior"),U(V,"shaper:cutdepth","0"),U(V,"fill","rgb(0,0,0)"),U(V,"d","m 8.8775245,0.8850638 c 0.05582,0.402267 0.2583487,0.7697095 0.5686598,1.031705 0.086143,0.072731 0.1795295,0.1364212 0.2786881,0.1900684 0.4888166,0.2644616 1.0780646,0.2644616 1.5668806,0 0.09916,-0.053647 0.192545,-0.1173376 0.278688,-0.1900684 0.310311,-0.2619955 0.51284,-0.6294379 0.56866,-1.031705 -0.394161,0.3053201 -0.944952,0.3053201 -1.339113,0 0,0.2777336 -0.297516,0.3571232 -0.467605,0.2381687 -0.06808,-0.047613 -0.115745,-0.12700249 -0.115745,-0.2381687 -0.3941609,0.3053204 -0.9449526,0.3053204 -1.3391135,0 z"),K(_,"display","inline"),K(_,"fill","#000000"),K(_,"stroke","#000000"),U(_,"id","path26"),U(_,"vector-effect","non-scaling-stroke"),U(_,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(_,"shaper:pathtype","exterior"),U(_,"shaper:cutdepth","0"),U(_,"fill","rgb(0,0,0)"),U(_,"d","m 8.9845556,2.6800666 a 0.1987088,0.1987088 -70.131987 1 0 0.1087309,0.09514 L 9.7248724,2.1068372 A 1.6464142,1.6464142 118.41448 0 1 9.4461843,1.9167688 Z"),K(H,"display","inline"),K(H,"fill","#000000"),K(H,"stroke","#000000"),U(H,"id","path28"),U(H,"vector-effect","non-scaling-stroke"),U(H,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(H,"shaper:pathtype","exterior"),U(H,"shaper:cutdepth","0"),U(H,"fill","rgb(0,0,0)"),U(H,"d","m 11.923339,2.7752061 a 0.1987088,0.1987088 -152.50384 1 0 0.108731,-0.09514 L 11.570441,1.9167688 a 1.6464142,1.6464142 49.825613 0 1 -0.278688,0.1900684 z"),K(j,"display","inline"),U(j,"inkscape:label","head"),U(j,"id","layer4"),U(j,"inkscape:groupmode","layer"),U(G,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(G,"display","inline"),K(G,"fill","#ffffff"),K(G,"stroke","#000000"),U(G,"id","path64"),U(G,"vector-effect","non-scaling-stroke"),U(G,"stroke","rgb(0,0,0)"),U(G,"shaper:pathtype","interior"),U(G,"shaper:cutdepth","0"),U(G,"fill","rgb(255,255,255)"),U(G,"d","m 10.738145,1.4797843 a 0.2339394,0.2339394 0 1 1 0.467878,0 0.2339394,0.2339394 0 1 1 -0.467878,0 z"),U(J,"sodipodi:nodetypes","ssss"),K(J,"display","inline"),K(J,"fill","#ffffff"),K(J,"stroke","#000000"),U(J,"id","path62"),U(J,"vector-effect","non-scaling-stroke"),U(J,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(J,"stroke","rgb(0,0,0)"),U(J,"shaper:pathtype","interior"),U(J,"shaper:cutdepth","0"),U(J,"fill","rgb(255,255,255)"),U(J,"d","m 9.8106021,1.4797843 c 0,-0.3119191 0.4678789,-0.3119191 0.4678789,0 0,0.1356292 -0.08846,0.2122839 -0.188455,0.2299641 C 9.9600551,1.732729 9.8106021,1.6560743 9.8106021,1.4797843 Z"),K(z,"display","inline"),K(z,"fill","none"),K(z,"stroke","#000000"),U(z,"id","path58"),U(z,"vector-effect","non-scaling-stroke"),U(z,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(z,"shaper:pathtype","exterior"),U(z,"shaper:cutdepth","0"),U(z,"fill","rgb(0,0,0)"),U(z,"d","m 9.8106021,1.4797843 a 0.23393945,0.23393945 0 1 1 0.4678789,0 0.23393945,0.23393945 0 1 1 -0.4678789,0 z"),U(W,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(W,"display","inline"),K(W,"fill","none"),K(W,"stroke","#000000"),U(W,"id","path42"),U(W,"vector-effect","non-scaling-stroke"),U(W,"shaper:pathtype","exterior"),U(W,"shaper:cutdepth","0"),U(W,"fill","rgb(0,0,0)"),U(W,"d","m 10.738145,1.4797843 a 0.2339394,0.2339394 0 1 1 0.467878,0 0.2339394,0.2339394 0 1 1 -0.467878,0 z"),U(Q,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),K(Q,"display","inline"),K(Q,"fill","#000000"),K(Q,"stroke","#000000"),U(Q,"id","path60"),U(Q,"vector-effect","non-scaling-stroke"),U(Q,"shaper:pathtype","exterior"),U(Q,"shaper:cutdepth","0"),U(Q,"fill","rgb(0,0,0)"),U(Q,"d","m 9.9339536,1.364368 0.049932,0.0026 a 0.1072503,0.1072503 -177.01676 1 0 0.2142104,0 l 0.04993,-0.0026 a 0.1572503,0.1572503 -2.9834499 1 1 -0.3140746,0 z"),U(Z,"sodipodi:nodetypes","ccccscc"),K(Z,"display","inline"),K(Z,"fill","#000000"),K(Z,"stroke","#000000"),U(Z,"id","path44"),U(Z,"vector-effect","non-scaling-stroke"),U(Z,"transform","matrix(1,0,0,-1,-8.7183147,3.0656565)"),U(Z,"shaper:pathtype","exterior"),U(Z,"shaper:cutdepth","0"),U(Z,"fill","rgb(0,0,0)"),U(Z,"d","m 10.768598,1.364368 0.04993,0.0026 c -0.0078,0.1504414 0.222049,0.1504414 0.21421,0 l 0.04993,-0.0026 c 0.0012,0.022721 -0.0013,0.043102 -0.0068,0.061143 -0.04746,0.1571007 -0.317611,0.1367198 -0.307295,-0.061143 z"),K($,"display","inline"),U($,"inkscape:label","eye"),U($,"id","layer5"),U($,"inkscape:groupmode","layer"),U(s,"xmlns:shaper","http://www.shapertools.com/namespaces/shaper"),U(s,"xmlns:dc","http://purl.org/dc/elements/1.1/"),U(s,"xmlns:cc","http://creativecommons.org/ns#"),U(s,"xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),U(s,"xmlns:svg","http://www.w3.org/2000/svg"),U(s,"xmlns","http://www.w3.org/2000/svg"),U(s,"xmlns:sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"),U(s,"xmlns:inkscape","http://www.inkscape.org/namespaces/inkscape"),U(s,"inkscape:export-ydpi","96"),U(s,"inkscape:export-xdpi","96"),U(s,"inkscape:export-filename","/Users/tatsuro.homma/gdrive/Fab/FabAcademy2020/week16/Baikinman.png"),U(s,"inkscape:version","1.0 (4035a4f, 2020-05-01)"),U(s,"sodipodi:docname","Baikinman.svg"),U(s,"id","svg66"),U(s,"y","0cm"),U(s,"xml:space","preserve"),U(s,"x","0cm"),U(s,"width","3.5799961cm"),U(s,"viewBox","0 0 3.5799961 4.0533016"),U(s,"version","1.1"),U(s,"shaper:fusionaddin","version:1.5.0"),U(s,"height","4.0533016cm"),U(s,"enable-background","new 0 0 3.5799961 4.0533016")},m(e,t){M(e,s,t),v(s,n),v(n,r),v(r,a),v(a,i),v(i,o),v(a,c),v(a,u),v(s,l),v(s,d),v(s,h),v(h,f),v(h,p),v(h,m),v(h,w),v(h,g),v(s,y),v(y,b),v(y,I),v(y,B),v(y,k),v(y,P),v(y,x),v(y,N),v(y,T),v(y,D),v(y,O),v(y,R),v(y,C),v(y,F),v(s,L),v(L,q),v(s,j),v(j,V),v(j,_),v(j,H),v(s,$),v($,G),v($,J),v($,z),v($,W),v($,Q),v($,Z)},p:e,i:e,o:e,d(e){e&&S(s)}}}class Jc extends ve{constructor(e){super(),be(this,e,null,Gc,o,{})}}function zc(e,t,s){const n=e.slice();return n[5]=t[s],n}function Wc(e){let t;return{c(){t=A("Inbox")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function Qc(e){let t;return{c(){t=A("Logout")},m(e,s){M(e,t,s)},d(e){e&&S(t)}}}function Zc(e){let t,s,n,r,a,i,o,c,u,l,d,h,f,p,m,w;return{c(){t=I("div"),s=I("div"),n=I("img"),i=B(),o=I("div"),c=I("h2"),u=I("a"),l=A(" Image Source"),h=B(),f=I("h1"),f.textContent="Inbox Image",p=B(),m=I("p"),m.textContent="Lorem ipsum dolor sit amet consectetur adipisicing elit.",w=B(),U(n,"id",r=e[5].id),U(n,"alt","gallery"),U(n,"class","absolute inset-0 w-full h-full object-contain object-center"),n.src!==(a=e[5].src)&&U(n,"src",a),U(u,"href",d=e[5].link),U(u,"target","_blank"),U(c,"class","tracking-widest text-sm title-font font-medium text-blue-500 mb-1"),U(f,"class","title-font text-lg font-medium text-gray-900 mb-3"),U(m,"class","leading-relaxed"),U(o,"class","px-8 py-10 relative z-10 w-full border-4 border-gray-200 bg-white opacity-0 hover:opacity-100"),U(s,"class","flex relative"),U(t,"class","lg:w-1/3 sm:w-1/2 p-4")},m(e,r){M(e,t,r),v(t,s),v(s,n),v(s,i),v(s,o),v(o,c),v(c,u),v(u,l),v(o,h),v(o,f),v(o,p),v(o,m),v(t,w)},p(e,t){1&t&&r!==(r=e[5].id)&&U(n,"id",r),1&t&&n.src!==(a=e[5].src)&&U(n,"src",a),1&t&&d!==(d=e[5].link)&&U(u,"href",d)},d(e){e&&S(t)}}}function Yc(e){let t,s,n,r,a,i,o,c,u,l,d,h,f,p,m,w,g,y,b,E,k,P,x,N,D=e[1]?.username+"";a=new Jc({}),f=new Ge({props:{href:"/inbox",$$slots:{default:[Wc]},$$scope:{ctx:e}}}),g=new qe({props:{$$slots:{default:[Qc]},$$scope:{ctx:e}}}),g.$on("click",e[2]);let K=e[0],O=[];for(let t=0;t<K.length;t+=1)O[t]=Zc(zc(e,K,t));return{c(){t=I("div"),s=I("header"),n=I("div"),r=I("div"),we(a.$$.fragment),i=B(),o=I("span"),c=A("Welcome, "),u=A(D),l=B(),d=I("nav"),h=I("div"),we(f.$$.fragment),p=B(),m=I("div"),m.innerHTML='<a href="luis-image-search-extension.zip">Download Extension</a>',w=B(),we(g.$$.fragment),y=B(),b=I("section"),E=I("div"),k=I("div"),k.innerHTML='<h1 class="sm:text-3xl text-2xl font-medium title-font mb-4 text-gray-900"> Inbox</h1> \n        <p class="lg:w-2/3 mx-auto leading-relaxed text-base">This is your inbox.<br/>\n          From here you can manage all of the photos that you have recently added\n          to your account.<br/>\n          Hover the images below for options.</p>',P=B(),x=I("div");for(let e=0;e<O.length;e+=1)O[e].c();U(o,"class","ml-3 text-xl"),U(r,"class","flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0"),U(h,"class","mr-5 hover:text-gray-900"),U(m,"class","mr-5 hover:text-gray-900"),U(d,"class","md:mr-auto md:ml-4 md:py-1 md:pl-4 md:border-l md:border-gray-400\tflex flex-wrap items-center text-base justify-center"),U(n,"class","container mx-auto flex flex-wrap p-5 flex-col md:flex-row items-center"),U(s,"class","text-gray-600 body-font"),U(k,"class","flex flex-col text-center w-full mb-20"),U(x,"class","flex flex-wrap -m-4"),U(E,"class","container px-5 py-24 mx-auto"),U(b,"class","text-gray-600 body-font"),U(t,"class","container flex flex-col h-screen mx-auto w-screen")},m(e,S){M(e,t,S),v(t,s),v(s,n),v(n,r),ge(a,r,null),v(r,i),v(r,o),v(o,c),v(o,u),v(n,l),v(n,d),v(d,h),ge(f,h,null),v(d,p),v(d,m),v(n,w),ge(g,n,null),v(t,y),v(t,b),v(b,E),v(E,k),v(E,P),v(E,x);for(let e=0;e<O.length;e+=1)O[e].m(x,null);N=!0},p(e,[t]){(!N||2&t)&&D!==(D=e[1]?.username+"")&&T(u,D);const s={};256&t&&(s.$$scope={dirty:t,ctx:e}),f.$set(s);const n={};if(256&t&&(n.$$scope={dirty:t,ctx:e}),g.$set(n),1&t){let s;for(K=e[0],s=0;s<K.length;s+=1){const n=zc(e,K,s);O[s]?O[s].p(n,t):(O[s]=Zc(n),O[s].c(),O[s].m(x,null))}for(;s<O.length;s+=1)O[s].d(1);O.length=K.length}},i(e){N||(ue(a.$$.fragment,e),ue(f.$$.fragment,e),ue(g.$$.fragment,e),N=!0)},o(e){le(a.$$.fragment,e),le(f.$$.fragment,e),le(g.$$.fragment,e),N=!1},d(e){e&&S(t),ye(a),ye(f),ye(g),function(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}(O,e)}}}const Xc="inbox";function eu(e,t,s){let n,r,a;u(e,Qe,(e=>s(3,n=e))),u(e,ze,(e=>s(1,r=e))),u(e,We,(e=>s(4,a=e)));let i=[];Kc.openDatabase({databaseName:Xc,changeHandler:async e=>{s(0,i=await Promise.all(e.map(((e,t)=>new Promise((async r=>{const a=`image-${e.itemId}`;let o=e.item.srcUrl;if(!o&&e.fileId)try{const r=await Kc.getFile({databaseName:Xc,fileId:e.fileId}),c=new FileReader,u=document.querySelector(`#${a}`);o=n.PLACEHOLDER_IMAGE_SRC,c.addEventListener("load",(()=>{const e=setInterval((()=>{i[t]&&(s(0,i[t].src=c.result,i),clearInterval(e)),u&&(u.src=o,clearInterval(e))}),300)}),!1),c.addEventListener("error",(()=>{i[t]&&s(0,i[t].src=n.PLACEHOLDER_IMAGE_SRC,i),u&&(u.src=n.PLACEHOLDER_IMAGE_SRC)})),c.readAsDataURL(r.file)}catch(e){}else if(!o&&!e.fileId){const e=document.querySelector(`#${a}`),r=setInterval((()=>{i[t]&&(s(0,i[t].src=n.PLACEHOLDER_IMAGE_SRC,i),clearInterval(r)),e&&(e.src=n.PLACEHOLDER_IMAGE_SRC,clearInterval(r))}),300)}r({id:a,src:o,link:e.item.pageUrl})}))))))}});return[i,r,async()=>{try{await Kc.signOut(),p(ze,r=null,r),Te("/signin")}catch(e){}p(We,a=!1,a)}]}class tu extends ve{constructor(e){super(),be(this,e,eu,Yc,o,{})}}function su(e){let t,s;return t=new Ce({props:{routes:{"/":Se({asyncComponent:e[2]}),"/signin":Hc,"/signup":Lc,"/forgotpassword":$c,"/inbox":Se({component:tu,conditions:e[3]})}}}),t.$on("conditionsFailed",e[4]),{c(){we(t.$$.fragment)},m(e,n){ge(t,e,n),s=!0},p(e,s){const n={};1&s&&(n.routes={"/":Se({asyncComponent:e[2]}),"/signin":Hc,"/signup":Lc,"/forgotpassword":$c,"/inbox":Se({component:tu,conditions:e[3]})}),t.$set(n)},i(e){s||(ue(t.$$.fragment,e),s=!0)},o(e){le(t.$$.fragment,e),s=!1},d(e){ye(t,e)}}}function nu(t){let s;return{c(){s=I("div"),s.innerHTML="<h1>Loading...</h1>",U(s,"class","container flex flex-col h-screen items-center justify-center mx-auto w-screen")},m(e,t){M(e,s,t)},p:e,i:e,o:e,d(e){e&&S(s)}}}function ru(e){let t,s,n,r,a,i;t=new Me({});const o=[nu,su],c=[];function u(e,t){return e[1]?0:1}return n=u(e),r=c[n]=o[n](e),{c(){we(t.$$.fragment),s=B(),r.c(),a=k()},m(e,r){ge(t,e,r),M(e,s,r),c[n].m(e,r),M(e,a,r),i=!0},p(e,[t]){let s=n;n=u(e),n===s?c[n].p(e,t):(oe(),le(c[s],1,1,(()=>{c[s]=null})),ce(),r=c[n],r?r.p(e,t):(r=c[n]=o[n](e),r.c()),ue(r,1),r.m(a.parentNode,a))},i(e){i||(ue(t.$$.fragment,e),ue(r),i=!0)},o(e){le(t.$$.fragment,e),le(r),i=!1},d(e){ye(t,e),e&&S(s),c[n].d(e),e&&S(a)}}}function au(e,t,s){let n,r;u(e,ze,(e=>s(0,n=e))),u(e,We,(e=>s(1,r=e))),p(ze,n=null,n),p(We,r=!0,r);(async()=>{p(ze,n=await(async()=>{try{return(await Kc.init({appId:"18487b61-530b-4f90-9dee-53151ecc6dc1",allowServerSideEncryption:!0})).user||null}catch(e){return null}})(),n),p(We,r=!1,r)})();return[n,r,()=>n?tu:Hc,()=>n,()=>{n||Te("/signin")}]}return new class extends ve{constructor(e){super(),be(this,e,au,ru,o,{})}}({target:document.body,props:{}})}();
